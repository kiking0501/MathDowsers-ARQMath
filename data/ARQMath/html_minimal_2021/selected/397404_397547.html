<!DOCTYPE html>

<html>
<head>
<title>Integral of rational functions.</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> Integral of rational functions. </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="397404">
<p>I want to evaluate this integral:</p> <blockquote> <p><span class="math-container" id="4210330" visual_id="6635381"><math alttext="\int{\frac{ax+b}{(x^{2}+2px+q)^{n}}}dx" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mfrac><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>x</mi></mrow><mo>+</mo><mi>b</mi></mrow><msup><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mi>x</mi></mrow><mo>+</mo><mi>q</mi></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup></mfrac><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>x</mi></mrow></mrow></mrow></semantics></math></span></p> </blockquote> <p>The book only says to integrate by parts <span class="math-container" id="4210331" visual_id="6635382"><math alttext="\int{\dfrac{1}{(x^{2}+2px+q)^{n-1}}dx}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mfrac><mn>1</mn><msup><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mi>x</mi></mrow><mo>+</mo><mi>q</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msup></mfrac><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>x</mi></mrow></mrow></mrow></semantics></math></span>, for simplicity if <span class="math-container" id="4210332" visual_id="352"><math alttext="n=2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn></mrow></semantics></math></span> I get: <span class="math-container" id="4210333" visual_id="6635383"><math alttext="\int{\dfrac{1}{(x^{2}+2px+q)}dx}=\dfrac{x}{x^{2}+2px+q}+\int{\dfrac{2x^{2}+2px% }{(x^{2}+2px+q)^{2}}}dx" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mfrac><mn>1</mn><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mi>x</mi></mrow><mo>+</mo><mi>q</mi></mrow><mo stretchy="false">)</mo></mrow></mfrac><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>x</mi></mrow></mrow></mrow><mo>=</mo><mrow><mfrac><mi>x</mi><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mi>x</mi></mrow><mo>+</mo><mi>q</mi></mrow></mfrac><mo>+</mo><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mfrac><mrow><mrow><mn>2</mn><mo>⁢</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mi>x</mi></mrow></mrow><msup><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mi>x</mi></mrow><mo>+</mo><mi>q</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mfrac><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>x</mi></mrow></mrow></mrow></mrow></mrow></semantics></math></span>.</p> <p>Now I don't know what to do.</p>
</div>
<hr/>
<div id="tags">
<span> calculus </span><span> integration </span><span> indefinite-integrals </span><span> partial-fractions </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="397547" id="answer">
<p><em>General description</em>. A partial fraction of the form <span class="math-container" id="4210334" visual_id="6635384"><math alttext="\dfrac{Bx+C}{\left[\left(x-r\right)^{2}+s^{2}\right]^{n}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mrow><mi>B</mi><mo>⁢</mo><mi>x</mi></mrow><mo>+</mo><mi>C</mi></mrow><msup><mrow><mo>[</mo><mrow><msup><mrow><mo>(</mo><mrow><mi>x</mi><mo>-</mo><mi>r</mi></mrow><mo>)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mi>s</mi><mn>2</mn></msup></mrow><mo>]</mo></mrow><mi>n</mi></msup></mfrac></semantics></math></span> is integrable by substitution, using the change of variables <span class="math-container" id="4210335" visual_id="6635385"><math alttext="x=r+st" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mrow><mi>r</mi><mo>+</mo><mrow><mi>s</mi><mo>⁢</mo><mi>t</mi></mrow></mrow></mrow></semantics></math></span>. With this method an integral of the form</p> <p><span class="math-container" id="4210336" visual_id="6635386"><math alttext="\displaystyle\int\frac{Bx+C}{\left[\left(x-r\right)^{2}+s^{2}\right]^{n}}dx" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mfrac><mrow><mrow><mi>B</mi><mo>⁢</mo><mi>x</mi></mrow><mo>+</mo><mi>C</mi></mrow><msup><mrow><mo>[</mo><mrow><msup><mrow><mo>(</mo><mrow><mi>x</mi><mo>-</mo><mi>r</mi></mrow><mo>)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mi>s</mi><mn>2</mn></msup></mrow><mo>]</mo></mrow><mi>n</mi></msup></mfrac><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>x</mi></mrow></mrow></mrow></semantics></math></span></p> <p>is transformed into an integral of the form </p> <p><span class="math-container" id="4210337" visual_id="6635387"><math alttext="\displaystyle\int\frac{Dt+E}{(t^{2}+1)^{n}}dt=D\int\frac{t}{(t^{2}+1)^{n}}dt+E% \int\frac{1}{(t^{2}+1)^{n}}dt." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mfrac><mrow><mrow><mi>D</mi><mo>⁢</mo><mi>t</mi></mrow><mo>+</mo><mi>E</mi></mrow><msup><mrow><mo stretchy="false">(</mo><mrow><msup><mi>t</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup></mfrac><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>t</mi></mrow></mrow></mrow><mo>=</mo><mrow><mrow><mi>D</mi><mo>⁢</mo><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mfrac><mi>t</mi><msup><mrow><mo stretchy="false">(</mo><mrow><msup><mi>t</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup></mfrac><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>t</mi></mrow></mrow></mrow></mrow><mo>+</mo><mrow><mi>E</mi><mo>⁢</mo><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mfrac><mn>1</mn><msup><mrow><mo stretchy="false">(</mo><mrow><msup><mi>t</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mi>n</mi></msup></mfrac><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>t</mi></mrow></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>The first integral is a table integral. The second one satisfies a <em>recurrence</em> relation. </p> <p><em>Application to the given integral</em>. Rewrite the integrand as <span class="math-container" id="4210338" visual_id="6635388"><math alttext="\dfrac{ax+b}{\left[(x+p)^{2}+q-p^{2}\right]^{n}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>x</mi></mrow><mo>+</mo><mi>b</mi></mrow><msup><mrow><mo>[</mo><mrow><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>x</mi><mo>+</mo><mi>p</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup><mo>+</mo><mi>q</mi></mrow><mo>-</mo><msup><mi>p</mi><mn>2</mn></msup></mrow><mo>]</mo></mrow><mi>n</mi></msup></mfrac></semantics></math></span> and make the substitution  <span class="math-container" id="4210339" visual_id="6635389"><math alttext="\begin{equation*}x=-p+\sqrt{q-p^{2}}\,t.\end{equation*}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext>(3)Equation 33=x+-p⁢-qp2t.</mtext></semantics></math></span> Then  <span class="math-container" id="4210340" visual_id="177255"><math alttext="\@@eqnarray\displaystyle I&amp;\displaystyle=&amp;\displaystyle\int\frac{ax+b}{(x^{2}+% 2px+q)^{n}}dx=\int\frac{ax+b}{\left[(x+p)^{2}+q-p^{2}\right]^{n}}dx,\\ &amp;&amp;\\ \\ \displaystyle M&amp;\displaystyle=&amp;\displaystyle a\sqrt{q-p^{2}},\quad N=b-ap,% \quad K=\frac{\sqrt{q-p^{2}}}{\left(q-p^{2}\right)^{n}}\\ \\ &amp;&amp;\\ \displaystyle I&amp;\displaystyle=&amp;\displaystyle K\int\frac{M}{(t^{2}+1)^{n}}t+% \frac{N}{(t^{2}+1)^{n}}dt,\\ &amp;\displaystyle=&amp;\displaystyle KM\int\frac{1}{(t^{2}+1)^{n}}tdt+KN\int\frac{1}{% (t^{2}+1)^{n}}dt\\ &amp;\displaystyle=&amp;\displaystyle-\frac{KM}{2(n-1)}\frac{1}{(t^{2}+1)^{n-1}}+KN% \int\frac{1}{(t^{2}+1)^{n}}dt." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext class="ltx_eqn_eqnarray">(5)Equation 55</mtext></semantics></math></span> The last integral can be split into two, the latter being integrable by parts which generates the <em>recursive relation</em> <span class="math-container" id="4210341" visual_id="9201"><math alttext="(6)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>6</mn><mo stretchy="false">)</mo></mrow></semantics></math></span> bellow. For <span class="math-container" id="4210342" visual_id="10021"><math alttext="n\neq 1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>≠</mo><mn>1</mn></mrow></semantics></math></span>, we have: <span class="math-container" id="4210343" visual_id="8367997"><math alttext="\@@eqnarray\displaystyle I_{n}&amp;\displaystyle=&amp;\displaystyle\int\frac{1}{(t^{2}% +1)^{n}}dt=\int\frac{1+t^{2}-t^{2}}{(t^{2}+1)^{n}}dt\\ &amp;\displaystyle=&amp;\displaystyle\int\frac{1}{(t^{2}+1)^{n-1}}dt-\int\frac{t^{2}}{% (t^{2}+1)^{n}}dt\\ &amp;\displaystyle=&amp;\displaystyle\int\frac{1}{(t^{2}+1)^{n-1}}dt+\frac{t}{2(n-1)% \left(t^{2}+1\right)^{n-1}}\\ &amp;\displaystyle\qquad-&amp;\displaystyle\frac{1}{2(n-1)}\int\frac{1}{\left(t^{2}+1% \right)^{n-1}}\,dt\\ &amp;\displaystyle=&amp;\displaystyle\frac{t}{2(n-1)\left(t^{2}+1\right)^{n-1}}+\frac{% 2n-3}{2(n-1)}\int\frac{1}{\left(t^{2}+1\right)^{n-1}}\,dt\\ &amp;\displaystyle=&amp;\displaystyle\frac{t}{2(n-1)\left(t^{2}+1\right)^{n-1}}+\frac{% 2n-3}{2(n-1)}I_{n-1}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext class="ltx_eqn_eqnarray">(6)Equation 66</mtext></semantics></math></span></p> <p>For <span class="math-container" id="4210344" visual_id="1115"><math alttext="n=1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow></semantics></math></span> <span class="math-container" id="4210345" visual_id="6635390"><math alttext="I_{1}=\int\frac{1}{t^{2}+1}dt=\arctan t+\text{Constant}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>I</mi><mn>1</mn></msub><mo>=</mo><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mfrac><mn>1</mn><mrow><msup><mi>t</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn></mrow></mfrac><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>t</mi></mrow></mrow></mrow><mo>=</mo><mrow><mrow><mi>arctan</mi><mo>⁡</mo><mi>t</mi></mrow><mo>+</mo><mtext>Constant</mtext></mrow></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>ADDED. For the particular case <span class="math-container" id="4210346" visual_id="352"><math alttext="n=2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn></mrow></semantics></math></span>, we get from <span class="math-container" id="4210347" visual_id="2965370"><math alttext="(6),(7)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="false">(</mo><mn>6</mn><mo stretchy="false">)</mo></mrow><mo>,</mo><mrow><mo stretchy="false">(</mo><mn>7</mn><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> <span class="math-container" id="4210348" visual_id="6635391"><math alttext="\mathrm{a}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">a</mi></semantics></math></span></p> <p>and from <span class="math-container" id="4210349" visual_id="9198"><math alttext="(5)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>5</mn><mo stretchy="false">)</mo></mrow></semantics></math></span></p> <p><span class="math-container" id="4210350" visual_id="6635392"><math alttext="\mathrm{a}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">a</mi></semantics></math></span></p> <p>Setting <span class="math-container" id="4210351" visual_id="17102"><math alttext="a=0,b=1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow><mo>,</mo><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow></mrow></semantics></math></span> in <span class="math-container" id="4210352" visual_id="1431910"><math alttext="(5\mathrm{a})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mrow><mn>5</mn><mo>⁢</mo><mi mathvariant="normal">a</mi></mrow><mo stretchy="false">)</mo></mrow></semantics></math></span> we evaluate your last integral for <span class="math-container" id="4210353" visual_id="6635393"><math alttext="q&gt;p^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>&gt;</mo><msup><mi>p</mi><mn>2</mn></msup></mrow></semantics></math></span>: </p> <p><span class="math-container" id="4210354" visual_id="6635394"><math alttext="\boxed{\@@eqnarray\displaystyle\int\frac{1}{(x^{2}+2px+q)^{2}}dx&amp;\displaystyle% =&amp;\displaystyle\frac{1}{2\left(q-p^{2}\right)}\frac{x+p}{x^{2}+2px+q}\\ &amp;\displaystyle+&amp;\displaystyle\frac{1}{2\left(q-p^{2}\right)^{3/2}}\arctan\frac% {x+p}{\sqrt{q-p^{2}}}+\text{Constant}.}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext class="ltx_eqn_eqnarray">Constant∫1(x2+2px+q)2dx=12(q-p2)x+px2+2px+q+12(q-p2)3/2arctanx+pq-p2+Constant.</mtext></semantics></math></span> <span class="math-container" id="4210355" visual_id="6635395"><math alttext="\mathrm{b}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">b</mi></semantics></math></span></p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
