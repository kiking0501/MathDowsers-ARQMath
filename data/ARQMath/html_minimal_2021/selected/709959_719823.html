<!DOCTYPE html>

<html>
<head>
<title>How to derive the Dirichlet-multinomial?</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> How to derive the Dirichlet-multinomial? </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="709959">
<h2>Common knowledge</h2> <p>The multinomial:</p> <p><span class="math-container" id="7096891" visual_id="696049"><math alttext="p(z|\theta)=\frac{n!}{\prod_{i}z_{i}!}\prod_{i}\theta_{i}^{z_{i}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mi>n</mi><mo>!</mo></mrow><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub></mstyle><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>!</mo></mrow></mrow></mfrac><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><msubsup><mi>θ</mi><mi>i</mi><msub><mi>z</mi><mi>i</mi></msub></msubsup></mrow></mrow></mrow></semantics></math></span></p> <p>And the Dirichlet:</p> <p><span class="math-container" id="7096892" visual_id="696050"><math alttext="p(\theta|\alpha)=\frac{1}{B(\alpha)}\prod_{i}\theta_{i}^{\alpha_{i}-1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>θ</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><msubsup><mi>θ</mi><mi>i</mi><mrow><msub><mi>α</mi><mi>i</mi></msub><mo>-</mo><mn>1</mn></mrow></msubsup></mrow></mrow></mrow></semantics></math></span></p> <p>with <span class="math-container" id="7096893" visual_id="696051"><math alttext="B(\alpha)=\frac{\prod_{i}\Gamma(\alpha_{i})}{\Gamma(\sum_{i}\alpha_{i})}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mfrac><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub></mstyle><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>α</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub></mstyle><msub><mi>α</mi><mi>i</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow></semantics></math></span>, the multivariate <a href="https://en.wikipedia.org/wiki/Beta_function" rel="nofollow">Beta function</a>.  Let us neglect for the moment the factors that do not depend on <span class="math-container" id="7096894" visual_id="26529"><math alttext="\theta_{i}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>i</mi></msub></semantics></math></span>:</p> <p><span class="math-container" id="7096895" visual_id="696052"><math alttext="p(z|\theta)\propto\prod_{i}\theta_{i}^{z_{i}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>∝</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><msubsup><mi>θ</mi><mi>i</mi><msub><mi>z</mi><mi>i</mi></msub></msubsup></mrow></mrow></semantics></math></span></p> <p><span class="math-container" id="7096896" visual_id="696053"><math alttext="p(\theta|\alpha)\propto\prod_{i}\theta_{i}^{\alpha_{i}-1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>θ</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>∝</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><msubsup><mi>θ</mi><mi>i</mi><mrow><msub><mi>α</mi><mi>i</mi></msub><mo>-</mo><mn>1</mn></mrow></msubsup></mrow></mrow></semantics></math></span></p> <p>The product:</p> <p><span class="math-container" id="7096897" visual_id="696054"><math alttext="p(z|\theta)p(\theta|\alpha)\propto\prod_{i}\theta_{i}^{z_{i}+\alpha_{i}-1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>θ</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>∝</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><msubsup><mi>θ</mi><mi>i</mi><mrow><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>+</mo><msub><mi>α</mi><mi>i</mi></msub></mrow><mo>-</mo><mn>1</mn></mrow></msubsup></mrow></mrow></semantics></math></span></p> <p>And because we know it is a Dirichlet distribution, it isn't surprising that the constant is a Beta function again:</p> <p><span class="math-container" id="7096898" visual_id="696055"><math alttext="p(z|\theta)p(\theta|\alpha)=\frac{1}{B(z+\alpha)}\prod_{i}\theta_{i}^{z_{i}+% \alpha_{i}-1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>θ</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo>+</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><msubsup><mi>θ</mi><mi>i</mi><mrow><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>+</mo><msub><mi>α</mi><mi>i</mi></msub></mrow><mo>-</mo><mn>1</mn></mrow></msubsup></mrow></mrow></mrow></semantics></math></span></p> <h2>Derive the normalization constant</h2> <p>But how do we derive this factor <span class="math-container" id="7096899" visual_id="696056"><math alttext="\frac{1}{B(z+\alpha)}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo>+</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></semantics></math></span>?</p> <h2>Attempt</h2> <p>The multinomial can be written using <span class="math-container" id="7096900" visual_id="378008"><math alttext="\Gamma(x+1)=x!" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>x</mi><mo>!</mo></mrow></mrow></semantics></math></span> and <span class="math-container" id="7096901" visual_id="696057"><math alttext="n=\sum_{i}z_{i}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub><msub><mi>z</mi><mi>i</mi></msub></mrow></mrow></semantics></math></span> (from the definition of the multinomial) as:</p> <p><span class="math-container" id="7096902" visual_id="696058"><math alttext="p(z|\theta)=\frac{n!}{\prod_{i}z_{i}!}\prod_{i}\theta_{i}^{z_{i}}=\frac{\Gamma% (\sum_{i}z_{i}+1)}{\prod_{i}\Gamma(z_{i}+1)}\prod_{i}\theta_{i}^{z_{i}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mi>n</mi><mo>!</mo></mrow><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub></mstyle><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>!</mo></mrow></mrow></mfrac><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><msubsup><mi>θ</mi><mi>i</mi><msub><mi>z</mi><mi>i</mi></msub></msubsup></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub></mstyle><msub><mi>z</mi><mi>i</mi></msub></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub></mstyle><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mfrac><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><msubsup><mi>θ</mi><mi>i</mi><msub><mi>z</mi><mi>i</mi></msub></msubsup></mrow></mrow></mrow></semantics></math></span></p> <p>Now, if we use <span class="math-container" id="7096903" visual_id="155507"><math alttext="\Gamma(1+x)=x\Gamma(x)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>+</mo><mi>x</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>x</mi><mo>⁢</mo><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> we can write it as:</p> <p><span class="math-container" id="7096904" visual_id="696059"><math alttext="p(z|\theta)=\frac{\sum_{i}z_{i}\Gamma(\sum_{i}z_{i})}{\prod_{i}z_{i}\prod_{i}% \Gamma(z_{i})}\prod_{i}\theta_{i}^{z_{i}}=\frac{\sum_{i}z_{i}}{\prod_{i}z_{i}}% \frac{1}{B(z)}\prod_{i}\theta_{i}^{z_{i}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub></mstyle><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>⁢</mo><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub></mstyle><msub><mi>z</mi><mi>i</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub></mstyle><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>⁢</mo><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub></mstyle><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow></mfrac><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><msubsup><mi>θ</mi><mi>i</mi><msub><mi>z</mi><mi>i</mi></msub></msubsup></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub></mstyle><msub><mi>z</mi><mi>i</mi></msub></mrow><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub></mstyle><msub><mi>z</mi><mi>i</mi></msub></mrow></mfrac><mo>⁢</mo><mfrac><mn>1</mn><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><msubsup><mi>θ</mi><mi>i</mi><msub><mi>z</mi><mi>i</mi></msub></msubsup></mrow></mrow></mrow></semantics></math></span></p> <p>The product with the Dirichlet distribution:</p> <p><span class="math-container" id="7096905" visual_id="696060"><math alttext="p(z|\theta)p(\theta|\alpha)=\frac{\sum_{i}z_{i}}{\prod_{i}z_{i}}\frac{1}{B(z)}% \frac{1}{B(\alpha)}\prod_{i}\theta_{i}^{z_{i}+\alpha_{i}-1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>θ</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub></mstyle><msub><mi>z</mi><mi>i</mi></msub></mrow><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub></mstyle><msub><mi>z</mi><mi>i</mi></msub></mrow></mfrac><mo>⁢</mo><mfrac><mn>1</mn><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>⁢</mo><mfrac><mn>1</mn><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><msubsup><mi>θ</mi><mi>i</mi><mrow><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>+</mo><msub><mi>α</mi><mi>i</mi></msub></mrow><mo>-</mo><mn>1</mn></mrow></msubsup></mrow></mrow></mrow></semantics></math></span></p> <p>I don't even need to go on here. This doesn't look very symmetric, so I did something wrong here, but what?</p>
</div>
<hr/>
<div id="tags">
<span> probability-distributions </span><span> gamma-function </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="719823" id="answer">
<p>There is confusion in the literature. There are at least two takes.</p> <p><strong>Categorical distribution</strong></p> <p>Often, the Dirichlet-multinomial is actually not a compound Dirichlet and a multinomial, but a compound Dirichlet and <strong>categorical</strong> distribution:</p> <p><span class="math-container" id="7096906" visual_id="696061"><math alttext="p(z|\theta)=\prod_{i}\theta_{i}^{z_{i}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><msubsup><mi>θ</mi><mi>i</mi><msub><mi>z</mi><mi>i</mi></msub></msubsup></mrow></mrow></semantics></math></span></p> <p>This means that this is about only one categorical variable, not a set. The notation of above would for dice assign the vector <span class="math-container" id="7096907" visual_id="696062"><math alttext="[1,0,0,0,0,0]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></semantics></math></span> to the face with one pip, <span class="math-container" id="7096908" visual_id="696063"><math alttext="[0,1,0,0,0,0]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></semantics></math></span> to the face with two pips, etc. Naturally, this means that <span class="math-container" id="7096909" visual_id="696064"><math alttext="\sum_{i}z_{i}=1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub><msub><mi>z</mi><mi>i</mi></msub></mrow><mo>=</mo><mn>1</mn></mrow></semantics></math></span>.</p> <p>This gets rid off the <span class="math-container" id="7096910" visual_id="696065"><math alttext="\frac{n!}{\prod_{i}z_{i}!}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>n</mi><mo>!</mo></mrow><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub></mstyle><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>!</mo></mrow></mrow></mfrac></semantics></math></span> factor and leads to the much shorter: </p> <p><span class="math-container" id="7096911" visual_id="696066"><math alttext="p(z|\theta)p(\theta|\alpha)=\frac{1}{B(\alpha)}\prod_{i}\theta_{i}^{z_{i}+% \alpha_{i}-1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>θ</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><msubsup><mi>θ</mi><mi>i</mi><mrow><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>+</mo><msub><mi>α</mi><mi>i</mi></msub></mrow><mo>-</mo><mn>1</mn></mrow></msubsup></mrow></mrow></mrow></semantics></math></span></p> <p>To subsequently derive at the Dirichlet-multinomial, you'll have to integrate over:  <span class="math-container" id="7096912" visual_id="696067"><math alttext="\int p(z|\theta)p(\theta|\alpha)d\theta=\frac{1}{B(\alpha)}\int\prod_{i}\theta% _{i}^{z_{i}+\alpha_{i}-1}d\theta" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>θ</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>θ</mi></mrow></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>⁢</mo><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><mrow><msubsup><mi>θ</mi><mi>i</mi><mrow><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>+</mo><msub><mi>α</mi><mi>i</mi></msub></mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo>⁢</mo><mi>d</mi><mo>⁢</mo><mi>θ</mi></mrow></mrow></mrow></mrow></mrow></semantics></math></span></p> <p>Now, the Dirichlet didn't come from nowhere... The factor <span class="math-container" id="7096913" visual_id="530919"><math alttext="B(\alpha)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> is a normalization factor:</p> <p><span class="math-container" id="7096914" visual_id="696068"><math alttext="p(\theta|\alpha)=\frac{1}{B(\alpha)}\prod_{i}\theta_{i}^{\alpha_{i}-1}=\frac{% \prod_{i}\theta_{i}^{\alpha_{i}-1}}{\int_{\Delta^{n}}\prod_{i}\theta_{i}^{% \alpha_{i}-1}d\theta}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>θ</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><msubsup><mi>θ</mi><mi>i</mi><mrow><msub><mi>α</mi><mi>i</mi></msub><mo>-</mo><mn>1</mn></mrow></msubsup></mrow></mrow><mo>=</mo><mfrac><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub></mstyle><msubsup><mi>θ</mi><mi>i</mi><mrow><msub><mi>α</mi><mi>i</mi></msub><mo>-</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∫</mo><msup><mi mathvariant="normal">Δ</mi><mi>n</mi></msup></msub></mstyle><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub></mstyle><mrow><msubsup><mi>θ</mi><mi>i</mi><mrow><msub><mi>α</mi><mi>i</mi></msub><mo>-</mo><mn>1</mn></mrow></msubsup><mo>⁢</mo><mi>d</mi><mo>⁢</mo><mi>θ</mi></mrow></mrow></mrow></mfrac></mrow></semantics></math></span></p> <p>with <span class="math-container" id="7096915" visual_id="696069"><math alttext="\int_{\Delta^{n}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo largeop="true" symmetric="true">∫</mo><msup><mi mathvariant="normal">Δ</mi><mi>n</mi></msup></msub></semantics></math></span> corresponding to the condition <span class="math-container" id="7096916" visual_id="696070"><math alttext="\sum_{i}\theta_{i}=1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub><msub><mi>θ</mi><mi>i</mi></msub></mrow><mo>=</mo><mn>1</mn></mrow></semantics></math></span>. (Feel free to improve my notation.)</p> <p>In other words, the multivariate Beta function is actually this integral directly from the definition:</p> <p><span class="math-container" id="7096917" visual_id="696071"><math alttext="\int_{\Delta^{n}}\prod_{i}\theta_{i}^{\alpha_{i}-1}d\theta=B(\alpha)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mo largeop="true" symmetric="true">∫</mo><msup><mi mathvariant="normal">Δ</mi><mi>n</mi></msup></msub><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><mrow><msubsup><mi>θ</mi><mi>i</mi><mrow><msub><mi>α</mi><mi>i</mi></msub><mo>-</mo><mn>1</mn></mrow></msubsup><mo>⁢</mo><mi>d</mi><mo>⁢</mo><mi>θ</mi></mrow></mrow></mrow><mo>=</mo><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span></p> <p>And hence the integral:</p> <p><span class="math-container" id="7096918" visual_id="696072"><math alttext="\int\prod_{i}\theta_{i}^{z_{i}+\alpha_{i}-1}d\theta=B(\alpha+z)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><mrow><msubsup><mi>θ</mi><mi>i</mi><mrow><mrow><msub><mi>z</mi><mi>i</mi></msub><mo>+</mo><msub><mi>α</mi><mi>i</mi></msub></mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo>⁢</mo><mi>d</mi><mo>⁢</mo><mi>θ</mi></mrow></mrow></mrow><mo>=</mo><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>α</mi><mo>+</mo><mi>z</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span></p> <p>Hence: <span class="math-container" id="7096919" visual_id="696073"><math alttext="\int p(z|\theta)p(\theta|\alpha)d\theta=\frac{B(\alpha+z)}{B(\alpha)}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>θ</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>θ</mi></mrow></mrow></mrow><mo>=</mo><mfrac><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>α</mi><mo>+</mo><mi>z</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>α</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow></semantics></math></span></p> <p>Or to end up with something similar looking to the <a href="https://en.wikipedia.org/wiki/Dirichlet-multinomial_distribution" rel="noreferrer">Wikipedia</a> definition:</p> <p><span class="math-container" id="7096920" visual_id="696074"><math alttext="\int p(z|\theta)p(\theta|\alpha)d\theta=\frac{\prod_{i}\Gamma(\alpha_{i}+z_{i}% )}{\Gamma(\sum_{i}(\alpha_{i}+z_{i}))}\frac{\Gamma(\sum_{i}\alpha_{i})}{\prod_% {i}\Gamma(\alpha_{i})}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>θ</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>θ</mi></mrow></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub></mstyle><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>α</mi><mi>i</mi></msub><mo>+</mo><msub><mi>z</mi><mi>i</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub></mstyle><mrow><mo stretchy="false">(</mo><mrow><msub><mi>α</mi><mi>i</mi></msub><mo>+</mo><msub><mi>z</mi><mi>i</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub></mstyle><msub><mi>α</mi><mi>i</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub></mstyle><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>α</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></semantics></math></span></p> <p>Collecting terms:</p> <p><span class="math-container" id="7096921" visual_id="696075"><math alttext="\int p(z|\theta)p(\theta|\alpha)d\theta=\frac{\Gamma(\sum_{i}\alpha_{i})}{% \Gamma(\sum_{i}\alpha_{i}+\sum_{i}z_{i})}\prod_{i}\frac{\Gamma(\alpha_{i}+z_{i% })}{\Gamma(\alpha_{i})}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>θ</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>θ</mi></mrow></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub></mstyle><msub><mi>α</mi><mi>i</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub></mstyle><msub><mi>α</mi><mi>i</mi></msub></mrow><mo>+</mo><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub></mstyle><msub><mi>z</mi><mi>i</mi></msub></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>i</mi></msub><mfrac><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>α</mi><mi>i</mi></msub><mo>+</mo><msub><mi>z</mi><mi>i</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>α</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow></semantics></math></span></p> <p>Note, however that we run <span class="math-container" id="7096922" visual_id="158"><math alttext="i" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi></semantics></math></span> here over the entries in our categorical variable <span class="math-container" id="7096923" visual_id="44"><math alttext="z" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi></semantics></math></span> represented as a vector! This is very different from the Wikipedia definition! </p> <p><strong>Multinomial distribution</strong></p> <p>In case of an actual multinomial distribution, counts of <span class="math-container" id="7096924" visual_id="44"><math alttext="z" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi></semantics></math></span> - let's write them <span class="math-container" id="7096925" visual_id="521998"><math alttext="n(z)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> - are actually the topic of consideration, not <span class="math-container" id="7096926" visual_id="44"><math alttext="z" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi></semantics></math></span> itself. </p> <p><span class="math-container" id="7096927" visual_id="696076"><math alttext="p(z|\theta)=\frac{(\sum_{k}n(z_{k}))!}{\prod_{k}(n(z_{k})!)}\prod_{k}\theta_{k% }^{n(z_{k})}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>k</mi></msub></mstyle><mrow><mi>n</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>!</mo></mrow><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>k</mi></msub></mstyle><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>⁢</mo><mrow><mrow><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mo>!</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>k</mi></msub><msubsup><mi>θ</mi><mi>k</mi><mrow><mi>n</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow></msubsup></mrow></mrow></mrow></semantics></math></span></p> <p>We now run over <span class="math-container" id="7096928" visual_id="83"><math alttext="k" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi></semantics></math></span> unique variables, not over a vectorized categorical variable.</p> <p>Of course, we can now again multiply with a Dirichlet distribution and the derivation is along the lines as described before. The result:</p> <p><span class="math-container" id="7096929" visual_id="696077"><math alttext="\int p(z|\theta)p(\theta|\alpha)d\theta=\frac{(\sum_{k}n(z_{k}))!}{\prod_{k}(n% (z_{k})!)}\frac{\Gamma(\sum_{k}\alpha_{k})}{\Gamma(\sum_{k}\alpha_{k}+\sum_{k}% n(z_{k}))}\prod_{k}\frac{\Gamma(\alpha_{k}+n(z_{k}))}{\Gamma(\alpha_{k})}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>θ</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>θ</mi></mrow></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>k</mi></msub></mstyle><mrow><mi>n</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>!</mo></mrow><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∏</mo><mi>k</mi></msub></mstyle><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>⁢</mo><mrow><mrow><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mo>!</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>k</mi></msub></mstyle><msub><mi>α</mi><mi>k</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>k</mi></msub></mstyle><msub><mi>α</mi><mi>k</mi></msub></mrow><mo>+</mo><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>k</mi></msub></mstyle><mrow><mi>n</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>k</mi></msub><mfrac><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>α</mi><mi>k</mi></msub><mo>+</mo><mrow><mi>n</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>α</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow></semantics></math></span></p> <p>The term <span class="math-container" id="7096930" visual_id="696078"><math alttext="\sum_{k}n(z_{k})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mi>k</mi></msub><mrow><mi>n</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>z</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> can be simplified to <span class="math-container" id="7096931" visual_id="320"><math alttext="N" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi></semantics></math></span>. This is the actual Dirichlet-multinomial. It's not pretty, but this is what it is.</p> <p><strong>N categorical distributions</strong></p> <p>The third option, and this is meant at the Wikipedia page is the distribution of a <strong>sequence</strong> of categorical variables. Recall that the multinomial assigns probabilities to the <strong>number</strong> of extract balls (in an experiment getting n balls out of a bag with k ball types). A sequence of categorical variables assigns a probability to a <strong>sequence</strong> and has a form without the normalization factor: </p> <p><span class="math-container" id="7096932" visual_id="696079"><math alttext="p(z|\theta)=\prod_{k}\theta_{k}^{z_{k}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>k</mi></msub><msubsup><mi>θ</mi><mi>k</mi><msub><mi>z</mi><mi>k</mi></msub></msubsup></mrow></mrow></semantics></math></span></p> <p>Here <span class="math-container" id="7096933" visual_id="83"><math alttext="k" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi></semantics></math></span> runs over the categories. We can now follow the derivation as with the single categorical variable.</p> <p><span class="math-container" id="7096934" visual_id="696080"><math alttext="\int p(z|\theta)p(\theta|\alpha)d\theta=\frac{\Gamma(\sum_{k}\alpha_{k})}{% \Gamma(\sum_{k}\alpha_{k}+\sum_{k}n(z_{i}=k))}\prod_{k}\frac{\Gamma(\alpha_{k}% +n(z_{i}=k))}{\Gamma(\alpha_{k})}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo largeop="true" symmetric="true">∫</mo><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>θ</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>θ</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mo><mi>α</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>θ</mi></mrow></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>k</mi></msub></mstyle><msub><mi>α</mi><mi>k</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mi mathvariant="normal">Γ</mi><mrow><mo stretchy="false">(</mo><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>k</mi></msub></mstyle><msub><mi>α</mi><mi>k</mi></msub><mo>+</mo><mstyle displaystyle="false"><msub><mo largeop="true" symmetric="true">∑</mo><mi>k</mi></msub></mstyle><mi>n</mi><mrow><mo stretchy="false">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∏</mo><mi>k</mi></msub><mfrac><mrow><mi mathvariant="normal">Γ</mi><mrow><mo stretchy="false">(</mo><msub><mi>α</mi><mi>k</mi></msub><mo>+</mo><mi>n</mi><mrow><mo stretchy="false">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>α</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow></semantics></math></span></p> <p>Note for example that we have <span class="math-container" id="7096935" visual_id="6193"><math alttext="\alpha_{k}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>k</mi></msub></semantics></math></span>; the parameter <span class="math-container" id="7096936" visual_id="93"><math alttext="\alpha" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi></semantics></math></span> is now considered the same for each cluster <span class="math-container" id="7096937" visual_id="83"><math alttext="k" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi></semantics></math></span>.</p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
<tr><td post_id="1698475"> Integrating a Multinomial distribution over a Dirichlet distribution </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
