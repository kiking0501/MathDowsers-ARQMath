<!DOCTYPE html>

<html>
<head>
<title>Derivative of Quadratic Form</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> Derivative of Quadratic Form </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="189434">
<p>For the Quadratic Form <span class="math-container" id="2198871" visual_id="5998424"><math alttext="X^{T}AX;X\in\mathbb{R}^{n},A\in\mathbb{R}^{n\times n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mrow><msup><mi>X</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>X</mi></mrow><mo>;</mo><mi>X</mi></mrow><mo>∈</mo><msup><mi>ℝ</mi><mi>n</mi></msup></mrow><mo>,</mo><mrow><mi>A</mi><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow></msup></mrow></mrow></semantics></math></span> (which simplifies to <span class="math-container" id="2198872" visual_id="965489"><math alttext="\mathbb{Z}_{6}\to\mathbb{Z}_{6}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ℤ</mi><mn>6</mn></msub><mo>→</mo><msub><mi>ℤ</mi><mn>6</mn></msub></mrow></semantics></math></span>), I tried to take the derivative wrt. X (<span class="math-container" id="2198873" visual_id="5998425"><math alttext="\Delta_{X}X^{T}AX" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>X</mi></msub><mo>⁢</mo><msup><mi>X</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>X</mi></mrow></semantics></math></span>) and ended up with the following:</p> <p>The <span class="math-container" id="2198874" visual_id="27073"><math alttext="k^{th}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>k</mi><mrow><mi>t</mi><mo>⁢</mo><mi>h</mi></mrow></msup></semantics></math></span> element of the derivative represented as</p> <p><span class="math-container" id="2198875" visual_id="5998426"><math alttext="\Delta_{X_{k}}X^{T}AX=[\Sigma_{i=1}^{n}(A_{ik}x_{k}+A_{ki})x_{i}]+A_{kk}x_{k}(% 1-x_{k})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi mathvariant="normal">Δ</mi><msub><mi>X</mi><mi>k</mi></msub></msub><mo>⁢</mo><msup><mi>X</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>X</mi></mrow><mo>=</mo><mrow><mrow><mo stretchy="false">[</mo><mrow><msubsup><mi mathvariant="normal">Σ</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><msub><mi>A</mi><mrow><mi>i</mi><mo>⁢</mo><mi>k</mi></mrow></msub><mo>⁢</mo><msub><mi>x</mi><mi>k</mi></msub></mrow><mo>+</mo><msub><mi>A</mi><mrow><mi>k</mi><mo>⁢</mo><mi>i</mi></mrow></msub></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msub><mi>x</mi><mi>i</mi></msub></mrow><mo stretchy="false">]</mo></mrow><mo>+</mo><mrow><msub><mi>A</mi><mrow><mi>k</mi><mo>⁢</mo><mi>k</mi></mrow></msub><mo>⁢</mo><msub><mi>x</mi><mi>k</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>x</mi><mi>k</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></semantics></math></span></p> <p>Does this result look right? Is there an alternative form?</p> <p>I'm trying to get to the <span class="math-container" id="2198876" visual_id="129638"><math alttext="\mu_{0}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mn>0</mn></msub></semantics></math></span> of Gaussian Discriminant Analysis by maximizing the log likelihood and I need to take the derivative of a Quadratic form. Either the result I mentioned above is wrong (shouldn't be because I went over my arithmetic several times) or the form I arrived at above is not the terribly useful to my problem (because I'm unable to proceed).</p> <p>I can give more details about the problem or the steps I put down to arrive at the above result, but I didn't want to clutter to start off. Please let me know if more details are necessary.</p> <p>Any link to related material is also much appreciated.</p>
</div>
<hr/>
<div id="tags">
<span> matrices </span><span> multivariable-calculus </span><span> derivatives </span><span> matrix-calculus </span><span> quadratic-forms </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="189436" id="answer">
<p>Let <span class="math-container" id="2198877" visual_id="2063524"><math alttext="Q(x)=x^{T}Ax" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>Q</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow></mrow></semantics></math></span>. Then expanding <span class="math-container" id="2198878" visual_id="5998427"><math alttext="Q(x+h)-Q(x)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>Q</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>x</mi><mo>+</mo><mi>h</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>-</mo><mrow><mi>Q</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> and dropping the higher order term, we get <span class="math-container" id="2198879" visual_id="5998428"><math alttext="DQ(x)(h)=x^{T}Ah+h^{T}Ax=x^{T}Ah+x^{T}A^{T}h=x^{T}(A+A^{T})h" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>D</mi><mo>⁢</mo><mi>Q</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>h</mi></mrow><mo>+</mo><mrow><msup><mi>h</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow></mrow><mo>=</mo><mrow><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>h</mi></mrow><mo>+</mo><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><msup><mi>A</mi><mi>T</mi></msup><mo>⁢</mo><mi>h</mi></mrow></mrow><mo>=</mo><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>A</mi><mo>+</mo><msup><mi>A</mi><mi>T</mi></msup></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi>h</mi></mrow></mrow></semantics></math></span>, or more typically, <span class="math-container" id="2198880" visual_id="5998429"><math alttext="\frac{\partial Q(x)}{\partial x}=x^{T}(A+A^{T})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>Q</mi></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>x</mi></mrow></mfrac><mo>=</mo><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>A</mi><mo>+</mo><msup><mi>A</mi><mi>T</mi></msup></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>.</p> <p>Notice that the derivative with respect to a <strong>column</strong> vector is a <strong>row</strong> vector!</p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
<tr><td comment_id="1401389"> Could you comment on the difference expansion, please? </td></tr><tr><td comment_id="1401411"> What do you mean? Just compute <span class="math-container" id="2198881" visual_id="5998427"><math alttext="Q(x+h)-Q(x)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>Q</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>x</mi><mo>+</mo><mi>h</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>-</mo><mrow><mi>Q</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> explicitly. The only term missing above is <span class="math-container" id="2198882" visual_id="5998430"><math alttext="h^{T}Ah" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>h</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>h</mi></mrow></semantics></math></span>, and we have <span class="math-container" id="2198883" visual_id="5998431"><math alttext="|h^{T}Ah|\leq\|A\|\|h\|^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="false">|</mo><mrow><msup><mi>h</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>h</mi></mrow><mo stretchy="false">|</mo></mrow><mo>≤</mo><mrow><mrow><mo>∥</mo><mi>A</mi><mo>∥</mo></mrow><mo>⁢</mo><msup><mrow><mo>∥</mo><mi>h</mi><mo>∥</mo></mrow><mn>2</mn></msup></mrow></mrow></semantics></math></span>, so the term is <span class="math-container" id="2198884" visual_id="5998432"><math alttext="O(\|h\|^{2})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo>∥</mo><mi>h</mi><mo>∥</mo></mrow><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>. </td></tr><tr><td comment_id="1401982"> Can't see how <span class="math-container" id="2198887" visual_id="5998433"><math alttext="(x+h)^{T}A(x+h)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>x</mi><mo>+</mo><mi>h</mi></mrow><mo stretchy="false">)</mo></mrow><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>x</mi><mo>+</mo><mi>h</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> would be obvious; I was hoping avoid opening the matrix. Any hint? </td></tr><tr><td comment_id="1402043"> I still don't understand what you are asking. Computing the derivative is much like computing the derivative of <span class="math-container" id="2198886" visual_id="5211"><math alttext="x\mapsto x^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>↦</mo><msup><mi>x</mi><mn>2</mn></msup></mrow></semantics></math></span> from first principles. I don't understand what you mean by 'opening the matrix'. </td></tr><tr><td comment_id="1402635"> I don't see how I can expand <span class="math-container" id="2198887" visual_id="5998433"><math alttext="(x+h)^{T}A(x+h)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>x</mi><mo>+</mo><mi>h</mi></mrow><mo stretchy="false">)</mo></mrow><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>x</mi><mo>+</mo><mi>h</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> so trivially. I mean literally, why <span class="math-container" id="2198888" visual_id="5998434"><math alttext="(x+h)^{T}A(x+h)=x^{T}Ax+h^{T}Ax+x^{T}Ah+h^{T}Ah" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>x</mi><mo>+</mo><mi>h</mi></mrow><mo stretchy="false">)</mo></mrow><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>x</mi><mo>+</mo><mi>h</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow><mo>+</mo><mrow><msup><mi>h</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow><mo>+</mo><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>h</mi></mrow><mo>+</mo><mrow><msup><mi>h</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>h</mi></mrow></mrow></mrow></semantics></math></span> and how can you see that so quickly.  It just looks a messy summation for me. </td></tr><tr><td comment_id="1403283"> There is no need to explicitly compute the sums. Matrix multiplication is associative and distributive, so we can treat them like 'numbers' in this regard. We have <span class="math-container" id="2198889" visual_id="908"><math alttext="A(x+h)=Ax+Ah" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>x</mi><mo>+</mo><mi>h</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow><mo>+</mo><mrow><mi>A</mi><mo>⁢</mo><mi>h</mi></mrow></mrow></mrow></semantics></math></span>,  <span class="math-container" id="2198890" visual_id="5998435"><math alttext="(x+h)^{T}A=(x^{T}+h^{T})A=x^{T}A+h^{T}A" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>x</mi><mo>+</mo><mi>h</mi></mrow><mo stretchy="false">)</mo></mrow><mi>T</mi></msup><mo>⁢</mo><mi>A</mi></mrow><mo>=</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>+</mo><msup><mi>h</mi><mi>T</mi></msup></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi>A</mi></mrow><mo>=</mo><mrow><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi></mrow><mo>+</mo><mrow><msup><mi>h</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi></mrow></mrow></mrow></semantics></math></span>, etc. </td></tr><tr><td comment_id="3789923"> How did you get <span class="math-container" id="2198891" visual_id="5998436"><math alttext="x^{T}A^{T}h" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><msup><mi>A</mi><mi>T</mi></msup><mo>⁢</mo><mi>h</mi></mrow></semantics></math></span> from <span class="math-container" id="2198892" visual_id="2715472"><math alttext="h^{T}Ax" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>h</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow></semantics></math></span>? </td></tr><tr><td comment_id="3790235"> In general, <span class="math-container" id="2198893" visual_id="46942"><math alttext="(AB)^{T}=B^{T}A^{T}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>A</mi><mo>⁢</mo><mi>B</mi></mrow><mo stretchy="false">)</mo></mrow><mi>T</mi></msup><mo>=</mo><mrow><msup><mi>B</mi><mi>T</mi></msup><mo>⁢</mo><msup><mi>A</mi><mi>T</mi></msup></mrow></mrow></semantics></math></span>. </td></tr><tr><td comment_id="3790236"> And for a scalar <span class="math-container" id="2198894" visual_id="5998437"><math alttext="x^{T}=x" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>=</mo><mi>x</mi></mrow></semantics></math></span>. </td></tr><tr><td comment_id="3799064"> @copper.hat: thanks! </td></tr><tr><td comment_id="4041614"> "the derivative with respect to a column vector is a row vector!"  --this is of course assuming you're using [numerator layout](https://en.wikipedia.org/wiki/Matrix_calculus#Layout_conventions) </td></tr><tr><td comment_id="4041619"> @YiboYang: I think the above notation is fairly standard, I believe. </td></tr><tr><td comment_id="5012315"> @copper.hat, thank you for your answers all of math stack exchange - I have used many of them.  Now, I am wondering, how can you say that <span class="math-container" id="2198895" visual_id="5998438"><math alttext="|h^{T}Ah|\leq||A||||h||^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="false">|</mo><mrow><msup><mi>h</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>h</mi></mrow><mo stretchy="false">|</mo></mrow><mo>≤</mo><mrow><mrow><mo fence="true">||</mo><mi>A</mi><mo fence="true">||</mo></mrow><mo>⁢</mo><msup><mrow><mo fence="true">||</mo><mi>h</mi><mo fence="true">||</mo></mrow><mn>2</mn></msup></mrow></mrow></semantics></math></span> ?  Is it somehow related to Cauchy Schwarz?  I tried to derive it from Cauchy Schwarz but was unable to, because the L2-norm of a matrix is the largest singular value, and this threw me off a bit.  Thanks again for your answers on stackexchange.            Furthermore, how is the fact the it is of order <span class="math-container" id="2198899" visual_id="936015"><math alttext="|h|^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="false">|</mo><mi>h</mi><mo stretchy="false">|</mo></mrow><mn>2</mn></msup></semantics></math></span> enough to justify removing it? </td></tr><tr><td comment_id="5012329"> @Sother: Cauchy Schwarz gives <span class="math-container" id="2198897" visual_id="5998439"><math alttext="|\langle h,Ah\rangle|\leq\|h\|\|Ah\|" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="false">|</mo><mrow><mo stretchy="false">⟨</mo><mi>h</mi><mo>,</mo><mrow><mi>A</mi><mo>⁢</mo><mi>h</mi></mrow><mo stretchy="false">⟩</mo></mrow><mo stretchy="false">|</mo></mrow><mo>≤</mo><mrow><mrow><mo>∥</mo><mi>h</mi><mo>∥</mo></mrow><mo>⁢</mo><mrow><mo>∥</mo><mrow><mi>A</mi><mo>⁢</mo><mi>h</mi></mrow><mo>∥</mo></mrow></mrow></mrow></semantics></math></span> and (if we use the Euclidean norm) we have <span class="math-container" id="2198898" visual_id="3825177"><math alttext="\|Ah\|\leq\|A\|\|h\|" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo>∥</mo><mrow><mi>A</mi><mo>⁢</mo><mi>h</mi></mrow><mo>∥</mo></mrow><mo>≤</mo><mrow><mrow><mo>∥</mo><mi>A</mi><mo>∥</mo></mrow><mo>⁢</mo><mrow><mo>∥</mo><mi>h</mi><mo>∥</mo></mrow></mrow></mrow></semantics></math></span>. </td></tr><tr><td comment_id="5014009"> Thanks.  also, I do not know if you saw my additional question - I editted it later.   how is the fact the it is of order <span class="math-container" id="2198899" visual_id="936015"><math alttext="|h|^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="false">|</mo><mi>h</mi><mo stretchy="false">|</mo></mrow><mn>2</mn></msup></semantics></math></span> enough to justify removing it? </td></tr><tr><td comment_id="5014066"> Also, what you are referring to when you say <span class="math-container" id="2198900" visual_id="3825178"><math alttext="||Ah||\leq||A||\,||h||" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">||</mo><mrow><mi>A</mi><mo>⁢</mo><mi>h</mi></mrow><mo fence="true">||</mo></mrow><mo>≤</mo><mrow><mrow><mo fence="true">||</mo><mi>A</mi><mo fence="true">||</mo></mrow><mo>⁢</mo><mrow><mo fence="true">||</mo><mi>h</mi><mo fence="true">||</mo></mrow></mrow></mrow></semantics></math></span>, you actually do not need it to be the Euclidea norm.  *Holder's Inequality* allows that property to hold true for **any** norm!  I just did not know that you could mix matrices and vectors when using Cauchy Schwarz, such as we have done here with matrix <span class="math-container" id="2198901" visual_id="188"><math alttext="A" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi></semantics></math></span> and vector <span class="math-container" id="2198902" visual_id="702"><math alttext="h" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi></semantics></math></span>. </td></tr><tr><td comment_id="5014239"> @Sother: The expression <span class="math-container" id="2198903" visual_id="784387"><math alttext="\|Ax\|\leq\|A\|\|x\|" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo>∥</mo><mrow><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow><mo>∥</mo></mrow><mo>≤</mo><mrow><mrow><mo>∥</mo><mi>A</mi><mo>∥</mo></mrow><mo>⁢</mo><mrow><mo>∥</mo><mi>x</mi><mo>∥</mo></mrow></mrow></mrow></semantics></math></span> works for induced norms. However, it is irrelevant here in that it is always the case that <span class="math-container" id="2198904" visual_id="5998440"><math alttext="\|Ax\|\leq K\|x\|" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo>∥</mo><mrow><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow><mo>∥</mo></mrow><mo>≤</mo><mrow><mi>K</mi><mo>⁢</mo><mrow><mo>∥</mo><mi>x</mi><mo>∥</mo></mrow></mrow></mrow></semantics></math></span> for some <span class="math-container" id="2198906" visual_id="719"><math alttext="K" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi></semantics></math></span>. </td></tr><tr><td comment_id="5015225"> What is <span class="math-container" id="2198906" visual_id="719"><math alttext="K" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi></semantics></math></span> ?  Is it a member of the set of real numbers?  What set is it a member of? </td></tr><tr><td comment_id="5015252"> It is a real constant. If the norm is induced it would be the norm of A. </td></tr><tr><td comment_id="5030292"> I just learned a new trick when your independent variable is in more than two places within your formula: introduce a new (fake) parameter which will then disappear:  <span class="math-container" id="2198919" visual_id="4735880"><math alttext="\frac{\partial}{\partial x}y^{T}Ax=\frac{\partial y}{\partial x}[Ax]^{T}+y^{T}A" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mfrac><mo>∂</mo><mrow><mo>∂</mo><mo>⁡</mo><mi>x</mi></mrow></mfrac><mo>⁢</mo><msup><mi>y</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow><mo>=</mo><mrow><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>y</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>x</mi></mrow></mfrac><mo>⁢</mo><msup><mrow><mo stretchy="false">[</mo><mrow><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow><mo stretchy="false">]</mo></mrow><mi>T</mi></msup></mrow><mo>+</mo><mrow><msup><mi>y</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi></mrow></mrow></mrow></semantics></math></span> The transpose was to make the vector a row vector. Nothing deep there!  Now, if <span class="math-container" id="2198920" visual_id="4360"><math alttext="y=x" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow></semantics></math></span> then  <span class="math-container" id="2198921" visual_id="4735881"><math alttext="\frac{d}{dx}x^{T}Ax=x^{T}A^{T}+x^{T}A=x^{T}(A+A^{T})\ ." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mo>⁢</mo><mi>x</mi></mrow></mfrac><mo>⁢</mo><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow><mo>=</mo><mrow><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><msup><mi>A</mi><mi>T</mi></msup></mrow><mo>+</mo><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi></mrow></mrow><mo>=</mo><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>A</mi><mo>+</mo><msup><mi>A</mi><mi>T</mi></msup></mrow><mo rspace="7.5pt" stretchy="false">)</mo></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span> </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
<tr><td post_id="2435096"> Find the partial derivatives of <span class="math-container" id="22549760" visual_id="25377"><math alttext="x^{T}Ax" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>T</mi></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow></semantics></math></span> </td></tr>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
<tr><td post_id="2805737"> Derivative of chi-squared function w.r.t. parameter vector </td></tr><tr><td post_id="222894"> How to take the gradient of the quadratic form? </td></tr><tr><td post_id="2283230"> Partial derivative of <span class="math-container" id="21094729" visual_id="1805"><math alttext="f(x)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> with respect to <span class="math-container" id="21094730" visual_id="273"><math alttext="x_{1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub></semantics></math></span> </td></tr><tr><td post_id="2422310"> Differentiation of a quadratic form </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
