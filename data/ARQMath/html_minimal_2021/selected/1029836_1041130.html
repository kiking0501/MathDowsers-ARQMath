<!DOCTYPE html>

<html>
<head>
<title>Covariance of $Z'Vb$ given that the rows of V are i.i.d.</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> Covariance of <span class="math-container" id="9779225" visual_id="9125279"><math alttext="Z^{\prime}Vb" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Z</mi><mo>′</mo></msup><mo>⁢</mo><mi>V</mi><mo>⁢</mo><mi>b</mi></mrow></semantics></math></span> given that the rows of V are i.i.d. </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="1029836">
<p>Suppose that we have the following entities <span class="math-container" id="9779226" visual_id="9125280"><math alttext="\underbrace{Z}_{n\times k},\quad\underbrace{V}_{n\times L},\quad\underbrace{b}% _{L\times 1}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><munder><munder accentunder="true"><mi>Z</mi><mo movablelimits="false">⏟</mo></munder><mrow><mi>n</mi><mo>×</mo><mi>k</mi></mrow></munder><mo rspace="12.5pt">,</mo><munder><munder accentunder="true"><mi>V</mi><mo movablelimits="false">⏟</mo></munder><mrow><mi>n</mi><mo>×</mo><mi>L</mi></mrow></munder><mo rspace="12.5pt">,</mo><munder><munder accentunder="true"><mi>b</mi><mo movablelimits="false">⏟</mo></munder><mrow><mi>L</mi><mo>×</mo><mn>1</mn></mrow></munder></mrow><mo>.</mo></mrow></semantics></math></span> <span class="math-container" id="9779227" visual_id="388"><math alttext="Z" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi></semantics></math></span> and <span class="math-container" id="9779228" visual_id="368"><math alttext="b" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi></semantics></math></span> are nonstochastic whereas we assume that the rows of <span class="math-container" id="9779229" visual_id="25"><math alttext="V" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi></semantics></math></span> are i.i.d. with each having mean <span class="math-container" id="9779230" visual_id="92"><math alttext="0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn></semantics></math></span> and covariance matrix <span class="math-container" id="9779231" visual_id="1233"><math alttext="\Omega" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">Ω</mi></semantics></math></span> (dimension: <span class="math-container" id="9779232" visual_id="307937"><math alttext="L\times L" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>×</mo><mi>L</mi></mrow></semantics></math></span>). I'm trying to justify that the following <span class="math-container" id="9779233" visual_id="211630"><math alttext="k\times 1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>×</mo><mn>1</mn></mrow></semantics></math></span> vector <span class="math-container" id="9779234" visual_id="9125281"><math alttext="S=Z^{\prime}Vb" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mrow><msup><mi>Z</mi><mo>′</mo></msup><mo>⁢</mo><mi>V</mi><mo>⁢</mo><mi>b</mi></mrow></mrow></semantics></math></span> has covariance matrix  <span class="math-container" id="9779235" visual_id="9125282"><math alttext="Z^{\prime}Zb^{\prime}\Omega b" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Z</mi><mo>′</mo></msup><mo>⁢</mo><mi>Z</mi><mo>⁢</mo><msup><mi>b</mi><mo>′</mo></msup><mo>⁢</mo><mi mathvariant="normal">Ω</mi><mo>⁢</mo><mi>b</mi></mrow></semantics></math></span> which has dimension <span class="math-container" id="9779236" visual_id="10337"><math alttext="k\times k" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>×</mo><mi>k</mi></mrow></semantics></math></span> because the 5 quantities above have dimensions <span class="math-container" id="9779237" visual_id="9125283"><math alttext="Z^{\prime}:k\times n;\quad Z:n\times k;\quad b^{\prime}:1\times L;\quad\Omega:% L\times L;\quad b:L\times 1." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msup><mi>Z</mi><mo>′</mo></msup><mo>:</mo><mrow><mrow><mi>k</mi><mo>×</mo><mi>n</mi></mrow><mo rspace="12.5pt">;</mo><mi>Z</mi></mrow><mo>:</mo><mrow><mrow><mi>n</mi><mo>×</mo><mi>k</mi></mrow><mo rspace="12.5pt">;</mo><msup><mi>b</mi><mo>′</mo></msup></mrow><mo>:</mo><mrow><mrow><mn>1</mn><mo>×</mo><mi>L</mi></mrow><mo rspace="12.5pt">;</mo><mi mathvariant="normal">Ω</mi></mrow><mo>:</mo><mrow><mrow><mi>L</mi><mo>×</mo><mi>L</mi></mrow><mo rspace="12.5pt">;</mo><mi>b</mi></mrow><mo>:</mo><mrow><mi>L</mi><mo>×</mo><mn>1</mn></mrow></mrow><mo>.</mo></mrow></semantics></math></span> It's clear that <span class="math-container" id="9779238" visual_id="403"><math alttext="S" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi></semantics></math></span> has zero mean so the covariance matrix is just <span class="math-container" id="9779239" visual_id="9125284"><math alttext="E(SS^{\prime})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>S</mi><mo>⁢</mo><msup><mi>S</mi><mo>′</mo></msup></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>. I tried expanding <span class="math-container" id="9779240" visual_id="2549054"><math alttext="SS^{\prime}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>⁢</mo><msup><mi>S</mi><mo>′</mo></msup></mrow></semantics></math></span> but I couldn't simplify things to produce the expression above. Can someone lend a hand please?</p> <p><strong>Edit</strong>: The above result is claimed in passing on page 1030 in <a href="http://onlinelibrary.wiley.com/doi/10.1111/1468-0262.00438/abstract" rel="nofollow">Moreira (2003)</a>. Full article is accessible <a href="http://www.fgv.br/professor/mjmoreira/papers/CLR.pdf" rel="nofollow">here</a>.</p>
</div>
<hr/>
<div id="tags">
<span> probability </span><span> matrices </span><span> probability-theory </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
<tr><td comment_id="2114379"> I think that Ω has dimension <span class="math-container" id="9779241" visual_id="189"><math alttext="n\times n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow></semantics></math></span> and not <span class="math-container" id="9779242" visual_id="307937"><math alttext="L\times L" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>×</mo><mi>L</mi></mrow></semantics></math></span>. </td></tr><tr><td comment_id="2114425"> It's <span class="math-container" id="9779243" visual_id="307937"><math alttext="L\times L" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>×</mo><mi>L</mi></mrow></semantics></math></span> because it's the covariance matrix of any row of <span class="math-container" id="9779277" visual_id="25"><math alttext="V" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi></semantics></math></span> (each row is of dimension <span class="math-container" id="9779245" visual_id="7540453"><math alttext="1\times L" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><mi>L</mi></mrow></semantics></math></span>.) </td></tr><tr><td comment_id="2119841"> Of course, I thought for a moment that <span class="math-container" id="9779249" visual_id="1233"><math alttext="Ω" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">Ω</mi></semantics></math></span> was the covariance matrix of the whole random matrix <span class="math-container" id="9779277" visual_id="25"><math alttext="V" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi></semantics></math></span>. Do you know that this result holds and you want a proof, or are you unsure of whether it holds or not? </td></tr><tr><td comment_id="2119858"> @Stef: Hi Stef, the result should be true because it's part of a very popular and relatively recent article in Econometrica. Please see my edit above. If you have a proof, please help me! Thank you. :) </td></tr><tr><td comment_id="2121185"> Sorry to bother you once again. I cannot figure out the dimension of <span class="math-container" id="9779248" visual_id="9125282"><math alttext="Z^{\prime}Zb^{\prime}Ωb" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Z</mi><mo>′</mo></msup><mo>⁢</mo><mi>Z</mi><mo>⁢</mo><msup><mi>b</mi><mo>′</mo></msup><mo>⁢</mo><mi mathvariant="normal">Ω</mi><mo>⁢</mo><mi>b</mi></mrow></semantics></math></span>. Moreover if <span class="math-container" id="9779249" visual_id="1233"><math alttext="Ω" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">Ω</mi></semantics></math></span> is the covariance matrix of a row (and not a column as usual) vector then it is given by <span class="math-container" id="9779250" visual_id="9125285"><math alttext="E[V_{i}^{\prime}V_{i}]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><msubsup><mi>V</mi><mi>i</mi><mo>′</mo></msubsup><mo>⁢</mo><msub><mi>V</mi><mi>i</mi></msub></mrow><mo stretchy="false">]</mo></mrow></mrow></semantics></math></span> and not <span class="math-container" id="9779251" visual_id="9125286"><math alttext="E[V_{i}V_{i}^{\prime}]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><msub><mi>V</mi><mi>i</mi></msub><mo>⁢</mo><msubsup><mi>V</mi><mi>i</mi><mo>′</mo></msubsup></mrow><mo stretchy="false">]</mo></mrow></mrow></semantics></math></span> as usual (where <span class="math-container" id="9779252" visual_id="1201"><math alttext="V_{i}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mi>i</mi></msub></semantics></math></span> denotes the <span class="math-container" id="9779253" visual_id="158"><math alttext="i" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi></semantics></math></span>-th row of matrix <span class="math-container" id="9779277" visual_id="25"><math alttext="V" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi></semantics></math></span>). </td></tr><tr><td comment_id="2121226"> @Stef Please see my edit. </td></tr><tr><td comment_id="2121245"> Ok, I stop bothering you,  my comments are quite silly. </td></tr><tr><td comment_id="2121249"> @Stef No worries! Thanks for paying any attention to this question. </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="1041130" id="answer">
<p>I'd bet that there is a simpler way, but I couldn't simplify it. Some slight changes in notation; and to aid readability, I write in lowercase bold the (column) vectors, in uppercase the matrices.</p> <p>Let <span class="math-container" id="9779255" visual_id="9125287"><math alttext="\underbrace{V}_{n\times\ell}=\begin{pmatrix}{{\bf v}_{1}^{t}\hfil\\ {\bf v}_{2}^{t}\\ \cdots\\ {\bf v}_{n}^{t}\\ \end{pmatrix}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><munder accentunder="true"><mi>V</mi><mo movablelimits="false">⏟</mo></munder><mrow><mi>n</mi><mo>×</mo><mi mathvariant="normal">ℓ</mi></mrow></munder><mo>=</mo><mrow><mo>(</mo><mi></mi><mo>)</mo></mrow></mrow></semantics></math></span> where <span class="math-container" id="9779256" visual_id="1355195"><math alttext="{\bf v_{i}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐯</mi><mi>𝐢</mi></msub></semantics></math></span> (transposed rows of <span class="math-container" id="9779257" visual_id="25"><math alttext="V" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi></semantics></math></span>) are random iid vectors of length <span class="math-container" id="9779258" visual_id="4329"><math alttext="\ell" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">ℓ</mi></semantics></math></span>, with <span class="math-container" id="9779259" visual_id="9125288"><math alttext="E({\bf v_{i}})=0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐯</mi><mi>𝐢</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></semantics></math></span> , <span class="math-container" id="9779260" visual_id="9125289"><math alttext="E({\bf v_{i}}{\bf v_{i}}^{t})=\Omega" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>𝐯</mi><mi>𝐢</mi></msub><mo>⁢</mo><mmultiscripts><mi>𝐯</mi><mi>𝐢</mi><none></none><none></none><mi>t</mi></mmultiscripts></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mi mathvariant="normal">Ω</mi></mrow></semantics></math></span>, <span class="math-container" id="9779261" visual_id="9125290"><math alttext="E({\bf v_{i}}{\bf v_{j}}^{t})=0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>𝐯</mi><mi>𝐢</mi></msub><mo>⁢</mo><mmultiscripts><mi>𝐯</mi><mi>𝐣</mi><none></none><none></none><mi>t</mi></mmultiscripts></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></semantics></math></span> (<span class="math-container" id="9779262" visual_id="4679"><math alttext="i\neq j" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>≠</mo><mi>j</mi></mrow></semantics></math></span>).</p> <p>Regarding the columns <span class="math-container" id="9779263" visual_id="1565955"><math alttext="{\bf u_{i}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐮</mi><mi>𝐢</mi></msub></semantics></math></span>, they also have zero mean, but they are not iid. Let the covariance be <span class="math-container" id="9779264" visual_id="9125291"><math alttext="T^{(i,j)}=E({\bf u_{i}}{\bf u_{j}}^{t})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>𝐮</mi><mi>𝐢</mi></msub><mo>⁢</mo><mmultiscripts><mi>𝐮</mi><mi>𝐣</mi><none></none><none></none><mi>t</mi></mmultiscripts></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> ; then it can be checked that <span class="math-container" id="9779265" visual_id="9125292"><math alttext="T^{(i,j)}=\Omega_{i,j}I_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mrow><msub><mi mathvariant="normal">Ω</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>⁢</mo><msub><mi>I</mi><mi>n</mi></msub></mrow></mrow></semantics></math></span> (To clarify: in the above <span class="math-container" id="9779266" visual_id="4095"><math alttext="I_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>n</mi></msub></semantics></math></span> is the <span class="math-container" id="9779267" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span> identity matrix; <span class="math-container" id="9779268" visual_id="8694579"><math alttext="T^{(i,j)}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>T</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msup></semantics></math></span> is -for each <span class="math-container" id="9779269" visual_id="564"><math alttext="(i,j)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></semantics></math></span> pair- a matrix; <span class="math-container" id="9779270" visual_id="980798"><math alttext="\Omega_{i,j}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi mathvariant="normal">Ω</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub></semantics></math></span> is a scalar, an element of the matrix <span class="math-container" id="9779271" visual_id="1233"><math alttext="\Omega" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">Ω</mi></semantics></math></span>)</p> <p>Let <span class="math-container" id="9779272" visual_id="9125293"><math alttext="\underbrace{\bf a}_{(n\times 1)}=\underbrace{V}_{n\times\ell}\,\,\underbrace{{% \bf b}}_{\ell\times 1}=\sum_{i=1}^{\ell}{\bf u}_{i}\,b_{i}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><munder accentunder="true"><mi>𝐚</mi><mo movablelimits="false">⏟</mo></munder><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>×</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></munder><mo>=</mo><mrow><mpadded width="+3.3pt"><munder><munder accentunder="true"><mi>V</mi><mo movablelimits="false">⏟</mo></munder><mrow><mi>n</mi><mo>×</mo><mi mathvariant="normal">ℓ</mi></mrow></munder></mpadded><mo>⁢</mo><munder><munder accentunder="true"><mi>𝐛</mi><mo movablelimits="false">⏟</mo></munder><mrow><mi mathvariant="normal">ℓ</mi><mo>×</mo><mn>1</mn></mrow></munder></mrow><mo>=</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant="normal">ℓ</mi></msubsup><mrow><mpadded width="+1.7pt"><msub><mi>𝐮</mi><mi>i</mi></msub></mpadded><mo>⁢</mo><msub><mi>b</mi><mi>i</mi></msub></mrow></mrow></mrow></semantics></math></span></p> <p>Then <span class="math-container" id="9779273" visual_id="9125294"><math alttext="E({\bf a})={\bf 0}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐚</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>𝟎</mn></mrow></semantics></math></span> and <span class="math-container" id="9779274" visual_id="9125295"><math alttext="E({\bf a}\,{\bf a}^{t})=\sum_{i,j}T^{(i,j)}b_{i}b_{j}=\left(\sum_{i,j}\Omega_{% i,j}b_{i}b_{j}\right)I_{n}={\bf b}^{t}\,\Omega\,{\bf b}I_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mpadded width="+1.7pt"><mi>𝐚</mi></mpadded><mo>⁢</mo><msup><mi>𝐚</mi><mi>t</mi></msup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mrow><msup><mi>T</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msup><mo>⁢</mo><msub><mi>b</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>b</mi><mi>j</mi></msub></mrow></mrow><mo>=</mo><mrow><mrow><mo>(</mo><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mrow><msub><mi mathvariant="normal">Ω</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>⁢</mo><msub><mi>b</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>b</mi><mi>j</mi></msub></mrow></mrow><mo>)</mo></mrow><mo>⁢</mo><msub><mi>I</mi><mi>n</mi></msub></mrow><mo>=</mo><mrow><mpadded width="+1.7pt"><msup><mi>𝐛</mi><mi>t</mi></msup></mpadded><mo>⁢</mo><mpadded width="+1.7pt"><mi mathvariant="normal">Ω</mi></mpadded><mo>⁢</mo><mi>𝐛</mi><mo>⁢</mo><msub><mi>I</mi><mi>n</mi></msub></mrow></mrow></semantics></math></span> </p> <p>Now, let <span class="math-container" id="9779275" visual_id="9125296"><math alttext="\underbrace{{\bf s}}_{k\times 1}=QV{\bf b}=\underbrace{Q}_{k\times n}\,\,% \underbrace{{\bf a}}_{n\times 1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><munder accentunder="true"><mi>𝐬</mi><mo movablelimits="false">⏟</mo></munder><mrow><mi>k</mi><mo>×</mo><mn>1</mn></mrow></munder><mo>=</mo><mrow><mi>Q</mi><mo>⁢</mo><mi>V</mi><mo>⁢</mo><mi>𝐛</mi></mrow><mo>=</mo><mrow><mpadded width="+3.3pt"><munder><munder accentunder="true"><mi>Q</mi><mo movablelimits="false">⏟</mo></munder><mrow><mi>k</mi><mo>×</mo><mi>n</mi></mrow></munder></mpadded><mo>⁢</mo><munder><munder accentunder="true"><mi>𝐚</mi><mo movablelimits="false">⏟</mo></munder><mrow><mi>n</mi><mo>×</mo><mn>1</mn></mrow></munder></mrow></mrow></semantics></math></span>. </p> <p>Then <span class="math-container" id="9779276" visual_id="9125297"><math alttext="E({\bf s}{\bf s}^{t})=QE({\bf a}{\bf a}^{t})Q^{t}=QQ^{t}{\bf b}^{t}\Omega\,{% \bf b}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐬𝐬</mi><mi>t</mi></msup><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>Q</mi><mo>⁢</mo><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>𝐚𝐚</mi><mi>t</mi></msup><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msup><mi>Q</mi><mi>t</mi></msup></mrow><mo>=</mo><mrow><mi>Q</mi><mo>⁢</mo><msup><mi>Q</mi><mi>t</mi></msup><mo>⁢</mo><msup><mi>𝐛</mi><mi>t</mi></msup><mo>⁢</mo><mpadded width="+1.7pt"><mi mathvariant="normal">Ω</mi></mpadded><mo>⁢</mo><mi>𝐛</mi></mrow></mrow></semantics></math></span></p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
<tr><td comment_id="2121410"> Oh wow, thank you for an elegant solution. Using the columns of <span class="math-container" id="9779277" visual_id="25"><math alttext="V" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi></semantics></math></span> was very neat. Thank you for your time! I struggled with this for days. </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
