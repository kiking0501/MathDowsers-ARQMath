<!DOCTYPE html>

<html>
<head>
<title>asymptotics of the square indicator sum for subsequences of digits</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> asymptotics of the square indicator sum for subsequences of digits </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="253554">
<p>Introduce the function <span class="math-container" id="2816410" visual_id="6519"><math alttext="g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> defined for positive integer arguments <span class="math-container" id="2816411" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span> as the count of squares of positive integers among the numbers that can be formed by taking some subsequence of the digits of the binary representation of <span class="math-container" id="2816412" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span> and interpreting this subsequence as a binary number. All subsequences contribute.</p> <p>For example, <span class="math-container" id="2816413" visual_id="3556746"><math alttext="5=(101)_{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>=</mo><msub><mrow><mo stretchy="false">(</mo><mn>101</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub></mrow></semantics></math></span> and the subsequences of digits are <span class="math-container" id="2816414" visual_id="3556747"><math alttext="(1)_{2}=1,(0)_{2}=0,(1)_{2}=1,(10)_{2}=2,(11)_{2}=3,(01)_{1}=1,(101)_{2}=5" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>1</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>1</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>2</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>11</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>3</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>01</mn><mo stretchy="false">)</mo></mrow><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><mo>,</mo><mrow><msub><mrow><mo stretchy="false">(</mo><mn>101</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>5</mn></mrow></mrow></mrow></mrow></mrow></mrow></mrow></semantics></math></span> and this includes the square "one" three times, so <span class="math-container" id="2816415" visual_id="3556748"><math alttext="g(5)=3." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>5</mn><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>3</mn></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>When <span class="math-container" id="2816416" visual_id="3556749"><math alttext="n=9=(1001)_{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>9</mn><mo>=</mo><msub><mrow><mo stretchy="false">(</mo><mn>1001</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub></mrow></semantics></math></span>, we obtain the following subsequences: <span class="math-container" id="2816417" visual_id="3556750"><math alttext="(1)_{2}=1,(0)_{2}=0,(0)_{2}=0,(1)_{2}=1,(10)_{2}=2,(10)_{2}=2,(11)_{2}=3,(00)_% {2}=0,(01)_{2}=1,(01)_{2}=1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>1</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>1</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>2</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>2</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>11</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>3</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>00</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>01</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>1</mn></mrow><mo>,</mo><mrow><msub><mrow><mo stretchy="false">(</mo><mn>01</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>1</mn></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow></semantics></math></span> and <span class="math-container" id="2816418" visual_id="3556751"><math alttext="(100)_{2}=4,(101)_{2}=5,(101)_{2}=5,(001)_{2}=1,(1001)_{2}=9" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>100</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>4</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>101</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>5</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>101</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>5</mn></mrow><mo>,</mo><mrow><mrow><msub><mrow><mo stretchy="false">(</mo><mn>001</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>1</mn></mrow><mo>,</mo><mrow><msub><mrow><mo stretchy="false">(</mo><mn>1001</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></msub><mo>=</mo><mn>9</mn></mrow></mrow></mrow></mrow></mrow></semantics></math></span> and this includes seven squares, so <span class="math-container" id="2816419" visual_id="3556752"><math alttext="g(9)=7." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>9</mn><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>7</mn></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>The behavior of <span class="math-container" id="2816420" visual_id="6519"><math alttext="g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> is highly erratic, ranging from linear for <span class="math-container" id="2816421" visual_id="84087"><math alttext="n=2^{k}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><msup><mn>2</mn><mi>k</mi></msup></mrow></semantics></math></span> to logarithmic for <span class="math-container" id="2816422" visual_id="3556753"><math alttext="n=2^{k}-1," class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>n</mi><mo>=</mo><mrow><msup><mn>2</mn><mi>k</mi></msup><mo>-</mo><mn>1</mn></mrow></mrow><mo>,</mo></mrow></semantics></math></span> which motivates us to ask the following question. <strong>What is the first term of the asymptotic expansion of the average order of <span class="math-container" id="2816423" visual_id="6519"><math alttext="g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>?</strong> I.e. find the asymptotics of <span class="math-container" id="2816424" visual_id="3556754"><math alttext="\frac{1}{n}\sum_{k=1}^{n}g(k)." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><mo>⁢</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>It might be useful to establish and prove closed form expressions for special values of <span class="math-container" id="2816425" visual_id="6519"><math alttext="g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>, e.g. we have <span class="math-container" id="2816426" visual_id="3556755"><math alttext="g(2^{k})=2^{k-1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mn>2</mn><mi>k</mi></msup><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><msup><mn>2</mn><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></semantics></math></span> and <span class="math-container" id="2816427" visual_id="3556756"><math alttext="g(2^{k}-1)=k" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mn>2</mn><mi>k</mi></msup><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mi>k</mi></mrow></semantics></math></span> as pointed out earlier (prove these). Here are the first few terms of <span class="math-container" id="2816428" visual_id="3556757"><math alttext="g(n):" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>:</mo><mi></mi></mrow></semantics></math></span> <span class="math-container" id="2816429" visual_id="3556758"><math alttext="1,1,2,2,3,2,3,4,7,4,5,4,4,3,4,8,15,9,12,8,9,6,7,8,11" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>15</mn><mo>,</mo><mn>9</mn><mo>,</mo><mn>12</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>9</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>11</mn></mrow></semantics></math></span></p> <p>This problem is not suited to numeric experimentation because <span class="math-container" id="2816430" visual_id="6519"><math alttext="g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> fluctuates so rapidly. For those who want to try anyway here is some C code. (I was going to memoize this the same way I memoized the Maple routine, but never got around to it. This is why the code looks as it does.) <img alt="C Code for the square indicator sum over binary digit subsequences" src="https://i.stack.imgur.com/r3u9s.png"/></p> <pre>  #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;math.h&gt; #include &lt;readline/readline.h&gt;  unsigned long long isqrt(unsigned long long n) {   if(!n) return 0;    unsigned long long a = 1, b = n, mid;    do {     mid = (a+b)/2;     if(mid*mid&gt;n){       b = mid;     }     else{       a = mid;     }   } while(b-a&gt;1);    return a; }  unsigned long long g(unsigned long long n) {   int bits[256], len = 0;   while(n&gt;0){     bits[len++] = n%2;     n &gt;&gt;= 1;   }    unsigned long long res = 0, ind;   for(ind=0; ind&lt;(1&lt;&lt;len); ind++){     unsigned long long varind = ind;     int subseq[256], srcpos=0, pos=0;     while(varind&gt;0){       if(varind%2){         subseq[pos++] = bits[srcpos];       }       srcpos++;       varind &gt;&gt;= 1;     }      unsigned long long val = 0;     int seqpos = 0;     while(seqpos&lt;pos){       val += (1&lt;&lt;seqpos)*subseq[seqpos];       seqpos++;     }      unsigned long long cs = isqrt(val);     if(val&gt;0 &amp;&amp; cs*cs == val){       res++;     }   }    return res; }  unsigned long long gavg(unsigned long long max) {   unsigned long long res = 0, n;    for(n=1; n&lt;=max; n++){     res += g(n);   }    return res; }  int main(int argc, char *argv) {   unsigned long long max;   char *line;    while((line = readline("&gt; ")) != NULL){     if(sscanf(line, "%llu", &amp;max)==1){       unsigned long gsum = gavg(max);        long double asympt = (long double)gsum;       asympt = asympt/(long double)max;        printf("%llu %lle\n", gsum, asympt);     }     free(line);   }    exit(0); } </pre> <p>This is the Maple code, which is noticeably slower.<img alt="Maple Code for the square indicator sum" src="https://i.stack.imgur.com/8wEXm.png"/></p> <pre>  g := proc(n)         option remember;         local dlist, ind, flind, sseq, len, sel, val, r, res;          dlist := convert(n, base, 2);         len := nops(dlist);          res := 0;         for ind from 0 to 2^len-1 do             sel := convert(ind, base, 2);              sseq := [];             for flind to nops(sel) do                 if sel[flind] = 1 then                    sseq := [op(sseq), dlist[flind]];                 fi;             od;              val := add(sseq[k]*2^(k-1), k=1..nops(sseq));              r := floor(sqrt(val));             if val&gt;0 and r*r = val then                res := res+1;             fi;         od;          res; end;  avg := n -&gt; add(g(k), k=1..n); </pre>
</div>
<hr/>
<div id="tags">
<span> number-theory </span><span> recreational-mathematics </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
<tr><td comment_id="556331"> Have you checked the oeis? </td></tr><tr><td comment_id="556336"> Yes I checked the OEIS for <span class="math-container" id="2816530" visual_id="6519"><math alttext="g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> and several non-trivial subsequences, with no luck yet. Back in a couple of hours. </td></tr><tr><td comment_id="557067"> why have you posted a picture of source code..... </td></tr><tr><td comment_id="557122"> Sorry about that, I tried pasting the code as text but I could not get the formatting to look right! I do understand that this inhibits cut and paste. I will readily supply the code if anyone is interested. Better yet, once I master how to post C code and preserve the formatting I will of course use that. I wonder if one can attach a code file the same way as one attaches a picture? </td></tr><tr><td comment_id="557177"> Then again it probably isn't good manners to post too much code to a math website, you want to keep it simple and useful. </td></tr><tr><td comment_id="559919"> @MarkoRiedel code is posted here, especially when it is directly relevant to the problem. Not only would code as text be preferable, it is more portable (others can run it and verify), it can be indexed by search algorithms, and it is has a lifetime longer than the image hosting site. </td></tr><tr><td comment_id="560221"> @Hooked thanks for clarifying. In the meantime I discovered the function sgml-quote that Emacs offers in sgml-mode. I applied it to my code and it quoted all the HTML special characters. I pasted the result into the message, which looks correct now. </td></tr><tr><td comment_id="560233"> To all: I made a mistake in my bounty comment, and now it won't let me fix the comment. Of course <span class="math-container" id="2816503" visual_id="56575"><math alttext="q(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> should be such that <span class="math-container" id="2816433" visual_id="3556759"><math alttext="\frac{1}{n}\sum_{k=1}^{n}g(k)\in\theta(q(n))" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><mo>⁢</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>∈</mo><mrow><mi>θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>q</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>, the case for <span class="math-container" id="2816434" visual_id="3556760"><math alttext="O(q(n))" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>q</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> is easy. </td></tr><tr><td comment_id="560286"> If there is an average order of magnitude, it would have to be about <span class="math-container" id="2816435" visual_id="3556761"><math alttext="n^{0.27155\ldots}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>n</mi><mrow><mn>0.27155</mn><mo>⁢</mo><mi mathvariant="normal">…</mi></mrow></msup></semantics></math></span>, since that is the average value when summed up to powers of <span class="math-container" id="2816501" visual_id="358"><math alttext="2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn></semantics></math></span>.  Here the exponent is equal to  <span class="math-container" id="2816437" visual_id="3556762"><math alttext="\log_{2}(1+\sqrt{2})-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>log</mi><mn>2</mn></msub><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>+</mo><msqrt><mn>2</mn></msqrt></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>-</mo><mn>1</mn></mrow></semantics></math></span>.  I suppose this implies <span class="math-container" id="2816438" visual_id="3556763"><math alttext="\Theta(n^{0.27155})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mn>0.27155</mn></msup><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>, but it would be nice to know if there is a multiplicative constant. </td></tr><tr><td comment_id="560514"> @ErickWong I am not quite sure where you are getting your numeric results. Under the hypothesis that <span class="math-container" id="2816439" visual_id="3556764"><math alttext="q(n)=n^{b}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>q</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><msup><mi>n</mi><mi>b</mi></msup></mrow></semantics></math></span>, with <span class="math-container" id="2816454" visual_id="368"><math alttext="b" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi></semantics></math></span> some constant and up to <span class="math-container" id="2816441" visual_id="425263"><math alttext="2^{14}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>2</mn><mn>14</mn></msup></semantics></math></span>, I get a total sum of <span class="math-container" id="2816442" visual_id="3556765"><math alttext="15220639" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>15220639</mn></semantics></math></span> with <span class="math-container" id="2816443" visual_id="3556766"><math alttext="b\sim 7.042518e-01" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>∼</mo><mrow><mrow><mn>7.042518</mn><mo>⁢</mo><mi>e</mi></mrow><mo>-</mo><mn>01</mn></mrow></mrow></semantics></math></span>. for <span class="math-container" id="2816444" visual_id="169595"><math alttext="2^{15}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>2</mn><mn>15</mn></msup></semantics></math></span>, I get <span class="math-container" id="2816445" visual_id="3556767"><math alttext="52842848" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>52842848</mn></semantics></math></span> and <span class="math-container" id="2816446" visual_id="3556768"><math alttext="b\sim 7.103470e-01" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>∼</mo><mrow><mrow><mn>7.103470</mn><mo>⁢</mo><mi>e</mi></mrow><mo>-</mo><mn>01</mn></mrow></mrow></semantics></math></span> and for <span class="math-container" id="2816447" visual_id="169597"><math alttext="2^{17}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>2</mn><mn>17</mn></msup></semantics></math></span>, I get <span class="math-container" id="2816448" visual_id="3556769"><math alttext="632292251" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>632292251</mn></semantics></math></span> and <span class="math-container" id="2816449" visual_id="3556770"><math alttext="b\sim 7.197657e-01" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>∼</mo><mrow><mrow><mn>7.197657</mn><mo>⁢</mo><mi>e</mi></mrow><mo>-</mo><mn>01</mn></mrow></mrow></semantics></math></span>. Maybe your implementation is different from mine? Should we compare them? I mentioned earlier <span class="math-container" id="2816530" visual_id="6519"><math alttext="g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> fluctuates so much that even for large values the average does not readily converge. Comparing the values of the sum can help ensure that the implementations match. </td></tr><tr><td comment_id="560694"> For what it's worth when <span class="math-container" id="2816451" visual_id="3556771"><math alttext="max=2^{18}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>m</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>x</mi></mrow><mo>=</mo><msup><mn>2</mn><mn>18</mn></msup></mrow></semantics></math></span> I get a total sum of <span class="math-container" id="2816452" visual_id="3556772"><math alttext="2180840462" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2180840462</mn></semantics></math></span> and a hypothetical exponent <span class="math-container" id="2816453" visual_id="3556773"><math alttext="b\sim 7.234576e-01" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>∼</mo><mrow><mrow><mn>7.234576</mn><mo>⁢</mo><mi>e</mi></mrow><mo>-</mo><mn>01</mn></mrow></mrow></semantics></math></span>. Maybe you can use the sum value to check your implementation, but it does not look like your hypothesis holds. The timing on this shows that the computation that we would need for a few more significant digits of <span class="math-container" id="2816454" visual_id="368"><math alttext="b" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi></semantics></math></span> assuming this is the right model, is definitely out of reach. It looks more promising to instead investigate relations between <span class="math-container" id="2816530" visual_id="6519"><math alttext="g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> for different <span class="math-container" id="2816515" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span> to speed up the computation that way. </td></tr><tr><td comment_id="560728"> @MarkoRiedel Ah, after going over it more carefully I see I had a misplaced factor of <span class="math-container" id="2816501" visual_id="358"><math alttext="2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn></semantics></math></span>.  The exponent should be <span class="math-container" id="2816458" visual_id="3556774"><math alttext="\log_{2}(1+\sqrt{2})-\tfrac{1}{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>log</mi><mn>2</mn></msub><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>+</mo><msqrt><mn>2</mn></msqrt></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></semantics></math></span>, which is about <span class="math-container" id="2816459" visual_id="3556775"><math alttext="0.77155" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.77155</mn></semantics></math></span>.  Glad to see the value of computational verification. </td></tr><tr><td comment_id="560762"> @ErickWong That sounds very promising, I hope you post some of your calculations. I will award the bounty to a solution that includes the multiplicative constant. </td></tr><tr><td comment_id="560772"> @MarkoRiedel I suspect it is possible to compute exact values of <span class="math-container" id="2816464" visual_id="790602"><math alttext="\sum g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo largeop="true" symmetric="true">∑</mo><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> quite efficiently by partitioning <span class="math-container" id="2816461" visual_id="39528"><math alttext="[1,n]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo></mrow></semantics></math></span> into dyadic blocks.  Each block might be calculated by a more elaborate form of my answer: the idea is it's nicer to work with sums over ranges of <span class="math-container" id="2816515" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span> where the first <span class="math-container" id="2816463" visual_id="180"><math alttext="r" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi></semantics></math></span> bits are frozen and the remaining bits are independent.  This is a fairly common trick seen in algorithmic programming contests. </td></tr><tr><td comment_id="560778"> @ErickWong I would prefer seeing a solution and then comment on that so that stackexchange.com won't complain about this turning into a chat. I do have some relevant ideas myself. Publishing yours might enable another reader to help clinch it where the constant is concerned. I suspect if you were to post C code for an efficient computation of <span class="math-container" id="2816464" visual_id="790602"><math alttext="\sum g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo largeop="true" symmetric="true">∑</mo><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> that would really deepen a reader's understanding of the problem and possibly even enable the computation of additional terms in the asymptotic expansion. Thanks! Back tomorrow. </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="255921" id="answer">
<p>This is an answer to the (corrected) bounty question, but I would still like to know if there is an asymptotic formula for the average value of <span class="math-container" id="2816465" visual_id="6524"><math alttext="g(k)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> or whether it fluctuates between multiples of <span class="math-container" id="2816466" visual_id="133845"><math alttext="n^{b}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>n</mi><mi>b</mi></msup></semantics></math></span>.</p> <p>Let <span class="math-container" id="2816467" visual_id="164750"><math alttext="n=2^{m}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><msup><mn>2</mn><mi>m</mi></msup></mrow></semantics></math></span> be a power of two, and let <span class="math-container" id="2816468" visual_id="11695"><math alttext="F(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> be the number of squares found as subsequences of all binary strings of length <span class="math-container" id="2816469" visual_id="20"><math alttext="m" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi></semantics></math></span>, and let <span class="math-container" id="2816470" visual_id="58531"><math alttext="G(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> be the exact value of <span class="math-container" id="2816471" visual_id="3556776"><math alttext="\sum_{k=0}^{n-1}g(k)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msubsup><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>.  (It is convenient to start counting at <span class="math-container" id="2816472" visual_id="92"><math alttext="0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn></semantics></math></span> rather than <span class="math-container" id="2816473" visual_id="342"><math alttext="1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn></semantics></math></span> but it does not affect the asymptotics.)</p> <p>It is certainly not true that <span class="math-container" id="2816474" visual_id="1674694"><math alttext="F(n)=G(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>F</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>G</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>, but it is a useful approximation in two ways.  On one hand, <span class="math-container" id="2816475" visual_id="3556777"><math alttext="F(n)\geq G(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>F</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≥</mo><mrow><mi>G</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>, because every binary string of length <span class="math-container" id="2816476" visual_id="20"><math alttext="m" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi></semantics></math></span> corresponds to some integer in <span class="math-container" id="2816477" visual_id="446945"><math alttext="[0,2^{m}-1]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mrow><msup><mn>2</mn><mi>m</mi></msup><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">]</mo></mrow></semantics></math></span> but it has strictly more subsequences because of zero-padding.  On the other hand, <span class="math-container" id="2816478" visual_id="3556778"><math alttext="F(n)\leq\sum_{k=n}^{2n-1}g(k)=G(2n)-G(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>F</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≤</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>k</mi><mo>=</mo><mi>n</mi></mrow><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mrow><mi>G</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>-</mo><mrow><mi>G</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></semantics></math></span>, because adding a leading <span class="math-container" id="2816479" visual_id="342"><math alttext="1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn></semantics></math></span> to each binary string of length <span class="math-container" id="2816480" visual_id="20"><math alttext="m" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi></semantics></math></span> yields a legitimate binary integer in <span class="math-container" id="2816481" visual_id="3556779"><math alttext="[2^{m},2^{m+1}-1]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msup><mn>2</mn><mi>m</mi></msup><mo>,</mo><mrow><msup><mn>2</mn><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">]</mo></mrow></semantics></math></span>.</p> <p>The benefit of this simplified model is that it is very easy to estimate <span class="math-container" id="2816482" visual_id="11695"><math alttext="F(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>.  For each length <span class="math-container" id="2816483" visual_id="3556780"><math alttext="1\leq\ell\leq m" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi mathvariant="normal">ℓ</mi><mo>≤</mo><mi>m</mi></mrow></semantics></math></span>, there are <span class="math-container" id="2816484" visual_id="3556781"><math alttext="m\choose\ell" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>(</mo><mfrac linethickness="0pt"><mi>m</mi><mi mathvariant="normal">ℓ</mi></mfrac><mo>)</mo></mrow></semantics></math></span> subsequences of length <span class="math-container" id="2816485" visual_id="4329"><math alttext="\ell" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">ℓ</mi></semantics></math></span> within any <span class="math-container" id="2816486" visual_id="20"><math alttext="m" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi></semantics></math></span>-bit string.  For each choice there will be about <span class="math-container" id="2816487" visual_id="3556782"><math alttext="\sqrt{2^{\ell}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><msup><mn>2</mn><mi mathvariant="normal">ℓ</mi></msup></msqrt></semantics></math></span> (more precisely, <span class="math-container" id="2816488" visual_id="3556783"><math alttext="\lfloor\sqrt{2^{\ell}-1}\rfloor+1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="false">⌊</mo><msqrt><mrow><msup><mn>2</mn><mi mathvariant="normal">ℓ</mi></msup><mo>-</mo><mn>1</mn></mrow></msqrt><mo stretchy="false">⌋</mo></mrow><mo>+</mo><mn>1</mn></mrow></semantics></math></span>) ways to choose a perfect square to fill in that subsequence.  Then there are <span class="math-container" id="2816489" visual_id="3556784"><math alttext="2^{m-\ell}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>2</mn><mrow><mi>m</mi><mo>-</mo><mi mathvariant="normal">ℓ</mi></mrow></msup></semantics></math></span> ways to fill in the remaining bits.  Therefore</p> <p><span class="math-container" id="2816490" visual_id="3556785"><math alttext="F(n)\approx\sum_{\ell=1}^{m}{m\choose\ell}(\sqrt{2})^{\ell}2^{m-\ell}=(\sqrt{2% }+2)^{m}-2^{m}," class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mi>F</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≈</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi mathvariant="normal">ℓ</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mrow><mrow><mo>(</mo><mfrac linethickness="0pt"><mi>m</mi><mi mathvariant="normal">ℓ</mi></mfrac><mo>)</mo></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msqrt><mn>2</mn></msqrt><mo stretchy="false">)</mo></mrow><mi mathvariant="normal">ℓ</mi></msup><mo>⁢</mo><msup><mn>2</mn><mrow><mi>m</mi><mo>-</mo><mi mathvariant="normal">ℓ</mi></mrow></msup></mrow></mrow><mo>=</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><msqrt><mn>2</mn></msqrt><mo>+</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow><mi>m</mi></msup><mo>-</mo><msup><mn>2</mn><mi>m</mi></msup></mrow></mrow><mo>,</mo></mrow></semantics></math></span> by the binomial formula.  Thus <span class="math-container" id="2816491" visual_id="3556786"><math alttext="F(n)\sim n^{c}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>F</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>∼</mo><msup><mi>n</mi><mi>c</mi></msup></mrow></semantics></math></span> where <span class="math-container" id="2816492" visual_id="3556787"><math alttext="c=\log_{2}(2+\sqrt{2})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><mrow><msub><mi>log</mi><mn>2</mn></msub><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo>+</mo><msqrt><mn>2</mn></msqrt></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>, and <span class="math-container" id="2816493" visual_id="3556788"><math alttext="\tfrac{1}{n}F(n)\sim n^{b}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><mo>⁢</mo><mi>F</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>∼</mo><msup><mi>n</mi><mi>b</mi></msup></mrow></semantics></math></span> where <span class="math-container" id="2816494" visual_id="3556789"><math alttext="b=c-1=0.77155\ldots" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mrow><mi>c</mi><mo>-</mo><mn>1</mn></mrow><mo>=</mo><mrow><mn>0.77155</mn><mo>⁢</mo><mi mathvariant="normal">…</mi></mrow></mrow></semantics></math></span>.</p> <p>Recall that <span class="math-container" id="2816495" visual_id="3556790"><math alttext="G(n)\leq F(n)\leq G(2n)-G(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>G</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≤</mo><mrow><mi>F</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≤</mo><mrow><mrow><mi>G</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>-</mo><mrow><mi>G</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></semantics></math></span>.  Since <span class="math-container" id="2816496" visual_id="3556786"><math alttext="F(n)\sim n^{c}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>F</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>∼</mo><msup><mi>n</mi><mi>c</mi></msup></mrow></semantics></math></span>, the left inequality easily gives <span class="math-container" id="2816497" visual_id="3556791"><math alttext="G(n)=O(n^{c})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>G</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mi>c</mi></msup><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>, while the right inequality yields <span class="math-container" id="2816498" visual_id="3556792"><math alttext="G(n)\geq G(n)-G(n/2)\geq F(n/2)=\Omega(n^{c})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>G</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≥</mo><mrow><mrow><mi>G</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>-</mo><mrow><mi>G</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>/</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>≥</mo><mrow><mi>F</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>/</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi mathvariant="normal">Ω</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mi>c</mi></msup><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>.  Therefore <span class="math-container" id="2816499" visual_id="3556793"><math alttext="G(n)=\Theta(n^{c})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>G</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mi>c</mi></msup><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> when <span class="math-container" id="2816500" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span> is a power of <span class="math-container" id="2816501" visual_id="358"><math alttext="2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn></semantics></math></span>, and since it is monotonically increasing, this growth rate can be seen to extend to all <span class="math-container" id="2816502" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span>.  The desired function <span class="math-container" id="2816503" visual_id="56575"><math alttext="q(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> is thus <span class="math-container" id="2816504" visual_id="133845"><math alttext="n^{b}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>n</mi><mi>b</mi></msup></semantics></math></span>.</p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
<tr><td comment_id="565037"> I have studied this response in detail and it appears to be sound, so I will likely award it the bounty. Could you clarify two more things -- when you say "it has more subsequences because of zero padding" do you mean that the squares being counted by <span class="math-container" id="2816505" visual_id="11695"><math alttext="F(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> include subsequences that start with zero padding on the left, none of which would contribute to <span class="math-container" id="2816530" visual_id="6519"><math alttext="g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>? For the upper bound you consider integers of <span class="math-container" id="2816507" visual_id="11766"><math alttext="m+1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></semantics></math></span> bits starting with <span class="math-container" id="2816508" visual_id="119896"><math alttext="2^{m}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>2</mn><mi>m</mi></msup></semantics></math></span>. This time there is no loss due to zero padding because of the <span class="math-container" id="2816509" visual_id="342"><math alttext="1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn></semantics></math></span> on the left? And subsequences including the leftmost bit make it an upper bound? </td></tr><tr><td comment_id="565055"> @MarkoRiedel That's exactly right. </td></tr><tr><td comment_id="565066"> I will award the bounty. I do not think that we have an asymptotic expansion, it looks like it keeps on fluctuating around <span class="math-container" id="2816510" visual_id="3556794"><math alttext="n^{b}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mi>b</mi></msup><mo>.</mo></mrow></semantics></math></span> As I noted in my original post there are some simple identities for <span class="math-container" id="2816530" visual_id="6519"><math alttext="g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> for certain values of <span class="math-container" id="2816515" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span>, like <span class="math-container" id="2816513" visual_id="3556795"><math alttext="n=2^{k}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>n</mi><mo>=</mo><msup><mn>2</mn><mi>k</mi></msup></mrow><mo>.</mo></mrow></semantics></math></span> I wonder if it would be interesting to establish more of these and perhaps gain some insight into the sequence that way. I suspect this can be done algorithmically. </td></tr><tr><td comment_id="565216"> Essentially the problem is how to compute <span class="math-container" id="2816530" visual_id="6519"><math alttext="g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> for <span class="math-container" id="2816515" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span> odd. There are efficient recurrences when <span class="math-container" id="2816516" visual_id="3556796"><math alttext="n=q2^{k}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mrow><mi>q</mi><mo>⁢</mo><msup><mn>2</mn><mi>k</mi></msup></mrow></mrow></semantics></math></span>, <span class="math-container" id="2816526" visual_id="625"><math alttext="q" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi></semantics></math></span> odd. Let <span class="math-container" id="2816518" visual_id="3556797"><math alttext="g_{0}(n)=g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>g</mi><mn>0</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> and let <span class="math-container" id="2816519" visual_id="1554273"><math alttext="g_{1}(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> be like <span class="math-container" id="2816530" visual_id="6519"><math alttext="g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> except that it counts numbers of the form <span class="math-container" id="2816521" visual_id="1758569"><math alttext="2m^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>⁢</mo><msup><mi>m</mi><mn>2</mn></msup></mrow></semantics></math></span> instead of squares. Then we have <span class="math-container" id="2816522" visual_id="3556798"><math alttext="g_{0}(q2^{k})=g_{0}(q)\sum_{r\geq 0}\binom{k}{2r}+g_{1}(q)\sum_{r\geq 0}\binom% {k}{2r+1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>g</mi><mn>0</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>q</mi><mo>⁢</mo><msup><mn>2</mn><mi>k</mi></msup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>g</mi><mn>0</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mrow><mi>r</mi><mo>≥</mo><mn>0</mn></mrow></msub><mrow><mo>(</mo><mfrac linethickness="0pt"><mi>k</mi><mrow><mn>2</mn><mo>⁢</mo><mi>r</mi></mrow></mfrac><mo>)</mo></mrow></mrow></mrow><mo>+</mo><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mrow><mi>r</mi><mo>≥</mo><mn>0</mn></mrow></msub><mrow><mo>(</mo><mfrac linethickness="0pt"><mi>k</mi><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>r</mi></mrow><mo>+</mo><mn>1</mn></mrow></mfrac><mo>)</mo></mrow></mrow></mrow></mrow></mrow></semantics></math></span> and <span class="math-container" id="2816523" visual_id="3556799"><math alttext="g_{1}(q2^{k})=g_{0}(q)\sum_{r\geq 0}\binom{k}{2r+1}+g_{1}(q)\sum_{r\geq 0}% \binom{k}{2r}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>q</mi><mo>⁢</mo><msup><mn>2</mn><mi>k</mi></msup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>g</mi><mn>0</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mrow><mi>r</mi><mo>≥</mo><mn>0</mn></mrow></msub><mrow><mo>(</mo><mfrac linethickness="0pt"><mi>k</mi><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>r</mi></mrow><mo>+</mo><mn>1</mn></mrow></mfrac><mo>)</mo></mrow></mrow></mrow><mo>+</mo><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mrow><mi>r</mi><mo>≥</mo><mn>0</mn></mrow></msub><mrow><mo>(</mo><mfrac linethickness="0pt"><mi>k</mi><mrow><mn>2</mn><mo>⁢</mo><mi>r</mi></mrow></mfrac><mo>)</mo></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span> <span class="math-container" id="5820015">A</span>s pointed out these are very efficient, but there does not appear anything of the sort for odd values. </td></tr><tr><td comment_id="567043"> It is worth noting that the above recurrence holds for bases other than two that are not squares. When the base (call it <span class="math-container" id="2816527" visual_id="302"><math alttext="d" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi></semantics></math></span>) is a square, like four, the recurrence becomes <span class="math-container" id="2816525" visual_id="3556800"><math alttext="g(qd^{k})=g(q)2^{k}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>q</mi><mo>⁢</mo><msup><mi>d</mi><mi>k</mi></msup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msup><mn>2</mn><mi>k</mi></msup></mrow></mrow></semantics></math></span> (with <span class="math-container" id="2816526" visual_id="625"><math alttext="q" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi></semantics></math></span> not a multiple of <span class="math-container" id="2816527" visual_id="302"><math alttext="d" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi></semantics></math></span>). It seems there are many interesting properties here that can be investigated. </td></tr><tr><td comment_id="568955"> The above recurrence actually simplifies to <span class="math-container" id="2816528" visual_id="3556801"><math alttext="g_{0}(q2^{k})=g_{0}(q)2^{k-1}+g_{1}(q)2^{k-1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>g</mi><mn>0</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>q</mi><mo>⁢</mo><msup><mn>2</mn><mi>k</mi></msup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>g</mi><mn>0</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msup><mn>2</mn><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo>+</mo><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msup><mn>2</mn><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mrow></mrow></semantics></math></span> and  <span class="math-container" id="2816529" visual_id="3556802"><math alttext="g_{1}(q2^{k})=g_{0}(q)2^{k-1}+g_{1}(q)2^{k-1}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>q</mi><mo>⁢</mo><msup><mn>2</mn><mi>k</mi></msup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mi>g</mi><mn>0</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msup><mn>2</mn><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo>+</mo><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msup><mn>2</mn><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span> </td></tr><tr><td comment_id="569438"> @MarkoRiedel I will think about a good way to calculate <span class="math-container" id="2816530" visual_id="6519"><math alttext="g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> when I get a chance.  My current impression is that it could be much faster to compute <span class="math-container" id="2816531" visual_id="3556803"><math alttext="\sum_{k=1}^{n}g(k)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> than it is to find <span class="math-container" id="2816532" visual_id="3556804"><math alttext="g(1),\ldots,g(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>. </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
