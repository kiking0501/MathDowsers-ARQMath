<!DOCTYPE html>

<html>
<head>
<title>modulo of series summation</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> modulo of series summation </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="209591">
<p>I have trouble with computing modulo.<br/> First, I have a summation of series like this: <span class="math-container" id="2393686" visual_id="5178767"><math alttext="1+3^{2}+3^{4}+\cdots+3^{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>+</mo><msup><mn>3</mn><mn>2</mn></msup><mo>+</mo><msup><mn>3</mn><mn>4</mn></msup><mo>+</mo><mi mathvariant="normal">⋯</mi><mo>+</mo><msup><mn>3</mn><mi>n</mi></msup></mrow></semantics></math></span> And this is the formula which can be used to compute the series: <span class="math-container" id="2393687" visual_id="5178768"><math alttext="S=\frac{1-3^{n+2}}{1-3^{2}}=\frac{3^{n+2}-1}{8}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mfrac><mrow><mn>1</mn><mo>-</mo><msup><mn>3</mn><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow></msup></mrow><mrow><mn>1</mn><mo>-</mo><msup><mn>3</mn><mn>2</mn></msup></mrow></mfrac><mo>=</mo><mfrac><mrow><msup><mn>3</mn><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow></msup><mo>-</mo><mn>1</mn></mrow><mn>8</mn></mfrac></mrow></semantics></math></span> Then I want to compute <span class="math-container" id="2393688" visual_id="5178769"><math alttext="S\mod 1000000007" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo lspace="2.5pt" rspace="2.5pt">mod</mo><mn>1000000007</mn></mrow></semantics></math></span>. But if <span class="math-container" id="2393689" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span> is a large number, it's really hard for me to compute it. The only thing I know is <span class="math-container" id="2393690" visual_id="5178770"><math alttext="3^{n+2}-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>3</mn><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow></msup><mo>-</mo><mn>1</mn></mrow></semantics></math></span> divisible by 8 (n is an even number). Could anyone give me some good hint to solve this problem?</p> <p><strong>Update</strong><br/> My intention is computing <span class="math-container" id="2393691" visual_id="5178771"><math alttext="M=\frac{3^{n+2}-1}{8}\mod 1000000007" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mrow><mfrac><mrow><msup><mn>3</mn><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow></msup><mo>-</mo><mn>1</mn></mrow><mn>8</mn></mfrac><mo lspace="2.5pt" rspace="2.5pt">mod</mo><mn>1000000007</mn></mrow></mrow></semantics></math></span> For example: If <span class="math-container" id="2393692" visual_id="689882"><math alttext="n=4000" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4000</mn></mrow></semantics></math></span> I must split <span class="math-container" id="2393693" visual_id="5178772"><math alttext="3^{4000+2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>3</mn><mrow><mn>4000</mn><mo>+</mo><mn>2</mn></mrow></msup></semantics></math></span> into <span class="math-container" id="2393694" visual_id="5178773"><math alttext="3^{40}3^{40}...3^{40}3^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>3</mn><mn>40</mn></msup><mo>⁢</mo><msup><mn>3</mn><mn>40</mn></msup><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><msup><mn>3</mn><mn>40</mn></msup><mo>⁢</mo><msup><mn>3</mn><mn>2</mn></msup></mrow></semantics></math></span> and compute modulo for each part to improve speed like this: <span class="math-container" id="2393695" visual_id="5178774"><math alttext="(3^{40}\mod 1000000007)(3^{40}\mod 1000000007)...(3^{40}\mod 1000000007)3^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="false">(</mo><mrow><msup><mn>3</mn><mn>40</mn></msup><mo lspace="2.5pt" rspace="2.5pt">mod</mo><mn>1000000007</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mn>3</mn><mn>40</mn></msup><mo lspace="2.5pt" rspace="2.5pt">mod</mo><mn>1000000007</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mn>3</mn><mn>40</mn></msup><mo lspace="2.5pt" rspace="2.5pt">mod</mo><mn>1000000007</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msup><mn>3</mn><mn>2</mn></msup></mrow></semantics></math></span> But how can I compute M with the above idea.  </p> <p><strong>Update more</strong><br/> It seems related to inverse modulo. I think the problem was solved like this <span class="math-container" id="2393696" visual_id="5178775"><math alttext="I=\frac{(1000000007+1)}{8}=125000001" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mrow><mn>1000000007</mn><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mn>8</mn></mfrac><mo>=</mo><mn>125000001</mn></mrow></semantics></math></span> <span class="math-container" id="2393697" visual_id="5178776"><math alttext="\frac{3^{n+2}-1}{8}\mod 1000000007=(3^{n+2}I-I)\mod 1000000007" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mfrac><mrow><msup><mn>3</mn><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow></msup><mo>-</mo><mn>1</mn></mrow><mn>8</mn></mfrac><mo lspace="2.5pt" rspace="2.5pt">mod</mo><mn>1000000007</mn></mrow><mo>=</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><msup><mn>3</mn><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow></msup><mo>⁢</mo><mi>I</mi></mrow><mo>-</mo><mi>I</mi></mrow><mo stretchy="false">)</mo></mrow><mo lspace="2.5pt" rspace="2.5pt">mod</mo><mn>1000000007</mn></mrow></mrow></semantics></math></span> Is it right?</p>
</div>
<hr/>
<div id="tags">
<span> modular-arithmetic </span><span> summation </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
<tr><td comment_id="475422"> You may find something helpful in this earlier question: http://math.stackexchange.com/questions/26722/calculating-ab-mod-c </td></tr><tr><td comment_id="475527"> So, did you look at the link I gave? Questions about raising numbers to powers in modular arithmetic have been asked and answered repeatedly on this site --- it pays to see what's been written before. </td></tr><tr><td comment_id="476640"> It is true that <span class="math-container" id="2393698" visual_id="5178777"><math alttext="8I\equiv 1\pmod{p}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mn>8</mn><mo>⁢</mo><mi>I</mi></mrow><mo>≡</mo><mrow><mn>1</mn><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo>mod</mo><mi>p</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> (where <span class="math-container" id="2393699" visual_id="5178778"><math alttext="p=100\dots 007" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mrow><mn>100</mn><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mn>007</mn></mrow></mrow></semantics></math></span>), so it's true that <span class="math-container" id="2393700" visual_id="5178779"><math alttext="(3^{n+2}-1)/8\equiv 3^{n+2}I-I\pmod{p}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><msup><mn>3</mn><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow></msup><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>/</mo><mn>8</mn></mrow><mo>≡</mo><mrow><mrow><mrow><msup><mn>3</mn><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow></msup><mo>⁢</mo><mi>I</mi></mrow><mo>-</mo><mi>I</mi></mrow><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo>mod</mo><mi>p</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>. I'm not sure how much that helps you. But **did you look at the link I gave?** </td></tr><tr><td comment_id="476678"> Yes, I found some useful things from the link, thanks. </td></tr><tr><td comment_id="476723"> So, the link tells you how to calculate powers in modular arithmetic. So what is it that you still have a question about? </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="1588820" id="answer">
<p>The modulo value of a geometric sum </p> <pre><code>1 + a + a^2 + ... +a^n mod m </code></pre> <p>can be calculated based on the identity (if the highest exponent is odd)</p> <pre><code>1 + a + a^2 + ... +a^(2x+1) = (1 + a)(1 + a^2 + (a^2)^2 + ... + (a^2)^x) </code></pre> <p>A complete algorithm which can deal with odd <em>and</em> even highest exponents looks like this in Mathematica: </p> <pre><code>geometricSeriesMod[a_, n_, m_] :=     Module[ {q = a, exp = n, factor = 1, sum = 0, temp},     While[And[exp &gt; 0, q != 0],      If[EvenQ[exp],        temp = Mod[factor*PowerMod[q, exp, m], m];        sum = Mod[sum + temp, m];        exp--];      factor = Mod[Mod[1 + q, m]*factor, m];      q = Mod[q*q, m];      exp = Floor[ exp /2];    ];     Return [Mod[sum + factor, m]] ] </code></pre> <p>Parameters:</p> <ul> <li><code>a</code> is the "ratio" of the series. It can be any integer (including zero and negative values).</li> <li><code>n</code> is the highest exponent of the series. Allowed are integers &gt;= 0.</li> <li><code>m</code>is the integer modulus != 0</li> </ul> <p>Note: The algorithm performs a Mod operation after <em>every</em> arithmetic operation. This is essential, if you transcribe this algorithm to a language with a limited word length for integers.</p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
<tr><td post_id="2082120"> Modulo of a Sum/Summation </td></tr><tr><td post_id="26722"> calculating <span class="math-container" id="270732" visual_id="70380"><math alttext="a^{b}\!\mod c" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mpadded width="-1.7pt"><msup><mi>a</mi><mi>b</mi></msup></mpadded><mo lspace="2.5pt" rspace="2.5pt">mod</mo><mi>c</mi></mrow></semantics></math></span> </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
