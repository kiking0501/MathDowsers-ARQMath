<!DOCTYPE html>

<html>
<head>
<title>Why does Engel expansion give smaller denominators than the Greedy algorithm?</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> Why does Engel expansion give smaller denominators than the Greedy algorithm? </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="2128623">
<p>I compared the two best known algorithms for Egyptian fraction expansion:</p> <ul> <li><a href="https://en.wikipedia.org/wiki/Greedy_algorithm_for_Egyptian_fractions" rel="nofollow noreferrer">Greedy algorithm</a>.</li> </ul> <p>On each step for a fraction <span class="math-container" id="19674070" visual_id="83647"><math alttext="p_{n}/q_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>n</mi></msub><mo>/</mo><msub><mi>q</mi><mi>n</mi></msub></mrow></semantics></math></span> we choose a denominator <span class="math-container" id="19674071" visual_id="2733"><math alttext="a_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>n</mi></msub></semantics></math></span> such that:</p> <p><span class="math-container" id="19674072" visual_id="2746418"><math alttext="\frac{p_{n}}{q_{n}}-\frac{1}{a_{n}}\geq 0,\quad\frac{p_{n}}{q_{n}}-\frac{1}{a_% {n}-1}&amp;lt;0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mfrac><msub><mi>p</mi><mi>n</mi></msub><msub><mi>q</mi><mi>n</mi></msub></mfrac><mo>-</mo><mfrac><mn>1</mn><msub><mi>a</mi><mi>n</mi></msub></mfrac></mrow><mo>≥</mo><mrow><mn>0</mn><mo rspace="12.5pt">,</mo><mrow><mfrac><msub><mi>p</mi><mi>n</mi></msub><msub><mi>q</mi><mi>n</mi></msub></mfrac><mo>-</mo><mrow><mfrac><mn>1</mn><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>-</mo><mn>1</mn></mrow></mfrac><mo>&lt;</mo></mrow></mrow><mn>0</mn></mrow></mrow></semantics></math></span></p> <p><span class="math-container" id="19674073" visual_id="2746419"><math alttext="\frac{p_{n+1}}{q_{n+1}}=\frac{a_{n}p_{n}-q_{n}}{q_{n}a_{n}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msub><mi>p</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><msub><mi>q</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mfrac><mo>=</mo><mfrac><mrow><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>p</mi><mi>n</mi></msub></mrow><mo>-</mo><msub><mi>q</mi><mi>n</mi></msub></mrow><mrow><msub><mi>q</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>a</mi><mi>n</mi></msub></mrow></mfrac></mrow></semantics></math></span></p> <ul> <li><a href="https://en.wikipedia.org/wiki/Engel_expansion" rel="nofollow noreferrer">Engel expansion</a>.</li> </ul> <p>On each step for a fraction <span class="math-container" id="19674074" visual_id="83647"><math alttext="p_{n}/q_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>n</mi></msub><mo>/</mo><msub><mi>q</mi><mi>n</mi></msub></mrow></semantics></math></span> we choose a multiplier <span class="math-container" id="19674075" visual_id="69653"><math alttext="m_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>n</mi></msub></semantics></math></span> such that:</p> <p><span class="math-container" id="19674076" visual_id="2746420"><math alttext="\frac{m_{n}p_{n}}{q_{n}}\geq 1,\quad\frac{(m_{n}-1)p_{n}}{q_{n}}&amp;lt;1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msub><mi>m</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>p</mi><mi>n</mi></msub></mrow><msub><mi>q</mi><mi>n</mi></msub></mfrac><mo>≥</mo><mrow><mn>1</mn><mo rspace="12.5pt">,</mo><mrow><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>m</mi><mi>n</mi></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msub><mi>p</mi><mi>n</mi></msub></mrow><msub><mi>q</mi><mi>n</mi></msub></mfrac><mo>&lt;</mo></mrow><mn>1</mn></mrow></mrow></semantics></math></span></p> <p>(In other words, these are the <strong>exact same</strong> inequalities as in the previous case).</p> <p>Then we represent:</p> <p><span class="math-container" id="19674077" visual_id="2746421"><math alttext="\frac{p_{n}}{q_{n}}=\frac{1}{m_{n}}\frac{m_{n}p_{n}}{q_{n}}=\frac{1}{m_{n}}% \left(1+\frac{m_{n}p_{n}-q_{n}}{q_{n}}\right)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msub><mi>p</mi><mi>n</mi></msub><msub><mi>q</mi><mi>n</mi></msub></mfrac><mo>=</mo><mrow><mfrac><mn>1</mn><msub><mi>m</mi><mi>n</mi></msub></mfrac><mo>⁢</mo><mfrac><mrow><msub><mi>m</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>p</mi><mi>n</mi></msub></mrow><msub><mi>q</mi><mi>n</mi></msub></mfrac></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><msub><mi>m</mi><mi>n</mi></msub></mfrac><mo>⁢</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mfrac><mrow><mrow><msub><mi>m</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>p</mi><mi>n</mi></msub></mrow><mo>-</mo><msub><mi>q</mi><mi>n</mi></msub></mrow><msub><mi>q</mi><mi>n</mi></msub></mfrac></mrow><mo>)</mo></mrow></mrow></mrow></semantics></math></span></p> <p><span class="math-container" id="19674078" visual_id="2746422"><math alttext="\frac{p_{n+1}}{q_{n+1}}=\frac{m_{n}p_{n}-q_{n}}{q_{n}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msub><mi>p</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><msub><mi>q</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mfrac><mo>=</mo><mfrac><mrow><mrow><msub><mi>m</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>p</mi><mi>n</mi></msub></mrow><mo>-</mo><msub><mi>q</mi><mi>n</mi></msub></mrow><msub><mi>q</mi><mi>n</mi></msub></mfrac></mrow></semantics></math></span></p> <p>This is the only difference between the methods - the fractions we work with on the next step are different. However, the denominators in this case are defined as the product of <span class="math-container" id="19674079" visual_id="14543"><math alttext="m_{k}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>k</mi></msub></semantics></math></span>, so I don't see why they are different from the greedy algorithm at all.</p> <blockquote> <p>But the fact is: the second method almost always gives better results in terms of the maximum denominator size. I can't figure out why.</p> </blockquote> <p>One famous exapmle (I give a list of denominators for each expansion):</p> <p><span class="math-container" id="19674080" visual_id="2746423"><math alttext="\frac{5}{121}=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>5</mn><mn>121</mn></mfrac><mo>=</mo><mi></mi></mrow></semantics></math></span> <code>{25, 757, 763309, 873960180913, 1527612795642093418846225}</code> (greedy)</p> <p>=<code>{25, 25 * 31, 25 * 31 * 41, 25 * 31 * 41 * 61, 25 * 31 * 41 * 61 * 121}</code></p> <p>=<code>{25, 775, 31775, 1938275, 234531275}</code> (Engel)</p> <p>We can see that after the first one all the other denominators are different and much smaller in the Engel case.</p> <hr/> <p>Below I will only write the final (multiplied) version of the denominators for the Engel expansions:</p> <p><span class="math-container" id="19674081" visual_id="2746424"><math alttext="\frac{18}{23}=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>18</mn><mn>23</mn></mfrac><mo>=</mo><mi></mi></mrow></semantics></math></span> <code>{2, 4, 31, 2852}</code> (greedy)</p> <p><span class="math-container" id="19674082" visual_id="3609"><math alttext="=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>=</mo></semantics></math></span> <code>{2, 4, 32, 736}</code> (Engel)</p> <p><span class="math-container" id="19674083" visual_id="2746425"><math alttext="\frac{41}{182}=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>41</mn><mn>182</mn></mfrac><mo>=</mo><mi></mi></mrow></semantics></math></span> <code>{5, 40, 3640}</code> (greedy)</p> <p><span class="math-container" id="19674084" visual_id="3609"><math alttext="=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>=</mo></semantics></math></span> <code>{5, 40, 3640}</code> (Engel)</p> <p><span class="math-container" id="19674085" visual_id="2746426"><math alttext="\frac{3}{37}=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>3</mn><mn>37</mn></mfrac><mo>=</mo><mi></mi></mrow></semantics></math></span> <code>{13, 241, 115921}</code> (greedy)</p> <p><span class="math-container" id="19674086" visual_id="3609"><math alttext="=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>=</mo></semantics></math></span> <code>{13, 247, 9139}</code> (Engel)</p> <p><span class="math-container" id="19674087" visual_id="2746427"><math alttext="\frac{10}{39}=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>10</mn><mn>39</mn></mfrac><mo>=</mo><mi></mi></mrow></semantics></math></span> <code>{4, 156}</code> (greedy)</p> <p><span class="math-container" id="19674088" visual_id="3609"><math alttext="=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>=</mo></semantics></math></span> <code>{4, 156}</code> (Engel)</p> <p><span class="math-container" id="19674089" visual_id="2746428"><math alttext="\frac{5}{122}=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>5</mn><mn>122</mn></mfrac><mo>=</mo><mi></mi></mrow></semantics></math></span> <code>{25, 1017, 3101850}</code> (greedy)</p> <p><span class="math-container" id="19674090" visual_id="3609"><math alttext="=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>=</mo></semantics></math></span> <code>{25, 1025, 125050}</code> (Engel)</p> <p><span class="math-container" id="19674091" visual_id="2746429"><math alttext="\frac{5}{22}=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>5</mn><mn>22</mn></mfrac><mo>=</mo><mi></mi></mrow></semantics></math></span> <code>{5, 37, 4070}</code> (greedy)</p> <p><span class="math-container" id="19674092" visual_id="3609"><math alttext="=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>=</mo></semantics></math></span> <code>{5, 40, 440}</code> (Engel)</p> <p><span class="math-container" id="19674093" visual_id="2746430"><math alttext="\frac{31}{311}=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>31</mn><mn>311</mn></mfrac><mo>=</mo><mi></mi></mrow></semantics></math></span> <code>{11, 115, 13567, 190623619, 37683192230798623, 1474639245038064805618553239385819}</code> (greedy)</p> <p><span class="math-container" id="19674094" visual_id="3609"><math alttext="=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>=</mo></semantics></math></span> <code>{11, 121, 2057, 53482, 16632902}</code> (Engel)</p> <p><span class="math-container" id="19674095" visual_id="2746431"><math alttext="\frac{21}{23}=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>21</mn><mn>23</mn></mfrac><mo>=</mo><mi></mi></mrow></semantics></math></span> <code>{2, 3, 13, 359, 644046}</code> (greedy)</p> <p><span class="math-container" id="19674096" visual_id="3609"><math alttext="=" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>=</mo></semantics></math></span> <code>{2, 4, 8, 32, 160, 1920, 44160}</code> (Engel)</p> <hr/> <p>In other words, we have some cases where the expansions are the same, but in most cases Engel is better.</p> <p>To tell the truth I encountered a case where Engel gave larger denominators, but I can't remember it now. Still, I think it was more of an exception.</p> <hr/> <p>A relevant paper: <a href="http://www.sciencedirect.com/science/article/pii/S0022314X03000179" rel="nofollow noreferrer">How many points have the same Engel and Sylvester expansions?</a></p>
</div>
<hr/>
<div id="tags">
<span> elementary-number-theory </span><span> inequality </span><span> fractions </span><span> egyptian-fractions </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="2131921" id="answer">
<p>The first step in the greedy algorithm and the Engel expansion is always the same, after that, the two may start to differ. Let's start with <span class="math-container" id="19674097" visual_id="2746432"><math alttext="\dfrac{p_{1}}{q_{1}}\in(0,1)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle displaystyle="true"><mfrac><msub><mi>p</mi><mn>1</mn></msub><msub><mi>q</mi><mn>1</mn></msub></mfrac></mstyle><mo>∈</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> and suppose</p> <p><span class="math-container" id="19674098" visual_id="2746433"><math alttext="\frac{1}{e_{1}}&amp;lt;\frac{p_{1}}{q_{1}}&amp;lt;\frac{1}{e_{1}-1}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mfrac><mn>1</mn><msub><mi>e</mi><mn>1</mn></msub></mfrac><mo>&lt;</mo></mrow><mrow><mfrac><msub><mi>p</mi><mn>1</mn></msub><msub><mi>q</mi><mn>1</mn></msub></mfrac><mo>&lt;</mo></mrow><mfrac><mn>1</mn><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>-</mo><mn>1</mn></mrow></mfrac></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>Let <span class="math-container" id="19674099" visual_id="2746434"><math alttext="p_{2}=e_{1}p_{1}-q_{1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub><mo>=</mo><mrow><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>p</mi><mn>1</mn></msub></mrow><mo>-</mo><msub><mi>q</mi><mn>1</mn></msub></mrow></mrow></semantics></math></span> the numerator of the next fraction we consider in the expansions. In the Engel expansion, we next look at the fraction <span class="math-container" id="19674100" visual_id="2746435"><math alttext="\dfrac{p_{2}}{q_{1}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><msub><mi>p</mi><mn>2</mn></msub><msub><mi>q</mi><mn>1</mn></msub></mfrac></mstyle></semantics></math></span>, and in the greedy algorithm we next look at <span class="math-container" id="19674101" visual_id="2746436"><math alttext="\dfrac{p_{2}}{e_{1}q_{1}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><msub><mi>p</mi><mn>2</mn></msub><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>q</mi><mn>1</mn></msub></mrow></mfrac></mstyle></semantics></math></span>. Our next factor in the Engel expansion is <span class="math-container" id="19674102" visual_id="2746437"><math alttext="e_{2}\in\mathbb{N}\setminus\{0\}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mn>2</mn></msub><mo>∈</mo><mrow><mi>ℕ</mi><mo>∖</mo><mrow><mo stretchy="false">{</mo><mn>0</mn><mo stretchy="false">}</mo></mrow></mrow></mrow></semantics></math></span> such that</p> <p><span class="math-container" id="19674103" visual_id="2746438"><math alttext="\frac{1}{e_{2}}\leqslant\frac{p_{2}}{q_{1}}&amp;lt;\frac{1}{e_{2}-1}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mfrac><mn>1</mn><msub><mi>e</mi><mn>2</mn></msub></mfrac><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\leqslant</mtext></merror><mo>⁢</mo><mfrac><msub><mi>p</mi><mn>2</mn></msub><msub><mi>q</mi><mn>1</mn></msub></mfrac><mo>&lt;</mo></mrow><mfrac><mn>1</mn><mrow><msub><mi>e</mi><mn>2</mn></msub><mo>-</mo><mn>1</mn></mrow></mfrac></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>Multiplying through with <span class="math-container" id="19674104" visual_id="2746439"><math alttext="1/e_{1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>/</mo><msub><mi>e</mi><mn>1</mn></msub></mrow></semantics></math></span>, the inequality is</p> <p><span class="math-container" id="19674105" visual_id="2746440"><math alttext="\frac{1}{e_{1}e_{2}}\leqslant\frac{p_{2}}{e_{1}q_{1}}&amp;lt;\frac{1}{e_{1}(e_{2}-% 1)}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mfrac><mn>1</mn><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>e</mi><mn>2</mn></msub></mrow></mfrac><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\leqslant</mtext></merror><mo>⁢</mo><mfrac><msub><mi>p</mi><mn>2</mn></msub><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>q</mi><mn>1</mn></msub></mrow></mfrac><mo>&lt;</mo></mrow><mfrac><mn>1</mn><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>e</mi><mn>2</mn></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>Now <span class="math-container" id="19674106" visual_id="2746441"><math alttext="e_{1}&amp;gt;1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>&gt;</mo></mrow><mn>1</mn></mrow></semantics></math></span>, so there are unit fractions strictly between the two bounds,</p> <p><span class="math-container" id="19674107" visual_id="2746442"><math alttext="\frac{1}{e_{1}e_{2}}&amp;lt;\frac{1}{e_{1}e_{2}-1}&amp;lt;\frac{1}{e_{1}e_{2}-2}&amp;lt;% \dotsc&amp;lt;\frac{1}{e_{1}(e_{2}-1)+1}&amp;lt;\frac{1}{e_{1}(e_{2}-1)}," class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mfrac><mn>1</mn><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>e</mi><mn>2</mn></msub></mrow></mfrac><mo>&lt;</mo></mrow><mrow><mfrac><mn>1</mn><mrow><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>e</mi><mn>2</mn></msub></mrow><mo>-</mo><mn>1</mn></mrow></mfrac><mo>&lt;</mo></mrow><mrow><mfrac><mn>1</mn><mrow><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>e</mi><mn>2</mn></msub></mrow><mo>-</mo><mn>2</mn></mrow></mfrac><mo>&lt;</mo></mrow><mrow><mi mathvariant="normal">…</mi><mo>&lt;</mo></mrow><mrow><mfrac><mn>1</mn><mrow><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>e</mi><mn>2</mn></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow></mfrac><mo>&lt;</mo></mrow><mfrac><mn>1</mn><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>e</mi><mn>2</mn></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow><mo>,</mo></mrow></semantics></math></span></p> <p>and the second fraction in the greedy algorithm coincides with the second fraction from the Engel expansion if and only if</p> <p><span class="math-container" id="19674108" visual_id="2746443"><math alttext="\frac{1}{e_{1}e_{2}}\leqslant\frac{p_{2}}{e_{1}q_{1}}&amp;lt;\frac{1}{e_{1}e_{2}-1}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mfrac><mn>1</mn><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>e</mi><mn>2</mn></msub></mrow></mfrac><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\leqslant</mtext></merror><mo>⁢</mo><mfrac><msub><mi>p</mi><mn>2</mn></msub><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>q</mi><mn>1</mn></msub></mrow></mfrac><mo>&lt;</mo></mrow><mfrac><mn>1</mn><mrow><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>e</mi><mn>2</mn></msub></mrow><mo>-</mo><mn>1</mn></mrow></mfrac></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>That does happen, but of course not always. If the second fractions obtained with both algorithms coincide, and the expansion is not yet complete, in the next step we have the same situation (with different numbers), in the Engel expansion we look at <span class="math-container" id="19674109" visual_id="2746444"><math alttext="\dfrac{p_{3}}{q_{1}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><msub><mi>p</mi><mn>3</mn></msub><msub><mi>q</mi><mn>1</mn></msub></mfrac></mstyle></semantics></math></span>, where <span class="math-container" id="19674110" visual_id="2746445"><math alttext="p_{3}=e_{2}p_{2}-q_{1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>3</mn></msub><mo>=</mo><mrow><mrow><msub><mi>e</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>p</mi><mn>2</mn></msub></mrow><mo>-</mo><msub><mi>q</mi><mn>1</mn></msub></mrow></mrow></semantics></math></span>, and in the greedy algorithm we look at <span class="math-container" id="19674111" visual_id="2746446"><math alttext="\dfrac{p_{3}}{(e_{1}e_{2})q_{1}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><msub><mi>p</mi><mn>3</mn></msub><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>e</mi><mn>2</mn></msub></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msub><mi>q</mi><mn>1</mn></msub></mrow></mfrac></mstyle></semantics></math></span>. Then the Engel expansion next produces the denominator <span class="math-container" id="19674112" visual_id="2746447"><math alttext="(e_{1}e_{2})e_{3}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>e</mi><mn>2</mn></msub></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msub><mi>e</mi><mn>3</mn></msub></mrow></semantics></math></span> and the greedy algorithm the denominator <span class="math-container" id="19674113" visual_id="2746448"><math alttext="(e_{1}e_{2})e_{3}-k" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>e</mi><mn>2</mn></msub></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msub><mi>e</mi><mn>3</mn></msub></mrow><mo>-</mo><mi>k</mi></mrow></semantics></math></span>, where <span class="math-container" id="19674114" visual_id="2746449"><math alttext="0\leqslant k&amp;lt;e_{3}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mn>0</mn><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\leqslant</mtext></merror><mo>⁢</mo><mi>k</mi><mo>&lt;</mo></mrow><msub><mi>e</mi><mn>3</mn></msub></mrow></semantics></math></span>. Note that the denominator of the first different unit fraction - if any - that we obtain via the Engel expansion is larger than the corresponding denominator from the greedy algorithm. The algorithms produce different Egyptian fraction expansions because the Engel algorithm produces a chain of denominators where every denominator divides the next, while no such restriction holds for the greedy algorithm.</p> <p>To see why the Engel expansion often yields much smaller denominators than the greedy algorithm, note that in the Engel expansion the denominator of the fraction we consider to determine the next Engel factor never grows. When we consider the fraction <span class="math-container" id="19674115" visual_id="217251"><math alttext="\dfrac{p_{n}}{q_{n}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><msub><mi>p</mi><mi>n</mi></msub><msub><mi>q</mi><mi>n</mi></msub></mfrac></mstyle></semantics></math></span> and obtain the factor <span class="math-container" id="19674116" visual_id="25951"><math alttext="e_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mi>n</mi></msub></semantics></math></span>, which we suppose doesn't yet terminate the algorithm, the next fraction considered is the reduced form of <span class="math-container" id="19674117" visual_id="2746450"><math alttext="\dfrac{e_{n}p_{n}-q_{n}}{q_{n}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mrow><mrow><msub><mi>e</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>p</mi><mi>n</mi></msub></mrow><mo>-</mo><msub><mi>q</mi><mi>n</mi></msub></mrow><msub><mi>q</mi><mi>n</mi></msub></mfrac></mstyle></semantics></math></span>, and its denominator <span class="math-container" id="19674118" visual_id="334911"><math alttext="q_{n+1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>q</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></semantics></math></span> is either <span class="math-container" id="19674119" visual_id="20335"><math alttext="q_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>q</mi><mi>n</mi></msub></semantics></math></span> or a proper divisor of <span class="math-container" id="19674120" visual_id="20335"><math alttext="q_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>q</mi><mi>n</mi></msub></semantics></math></span>. Except for the last step, where we consider the fraction <span class="math-container" id="19674121" visual_id="2746451"><math alttext="\dfrac{1}{q_{\ell}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>1</mn><msub><mi>q</mi><mi mathvariant="normal">ℓ</mi></msub></mfrac></mstyle></semantics></math></span>, we always consider a fraction <span class="math-container" id="19674122" visual_id="217251"><math alttext="\dfrac{p_{n}}{q_{n}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><msub><mi>p</mi><mi>n</mi></msub><msub><mi>q</mi><mi>n</mi></msub></mfrac></mstyle></semantics></math></span> with <span class="math-container" id="19674123" visual_id="2746452"><math alttext="p_{n}\geqslant 2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>n</mi></msub><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\geqslant</mtext></merror><mo>⁢</mo><mn>2</mn></mrow></semantics></math></span>, so we have</p> <p><span class="math-container" id="19674124" visual_id="2746453"><math alttext="e_{n}-1&amp;lt;\frac{q_{n}}{2}\quad\text{or}\quad e_{n}\leqslant\biggl{\lceil}% \frac{q_{n}}{2}\biggr{\rceil}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><msub><mi>e</mi><mi>n</mi></msub><mo>-</mo><mrow><mn>1</mn><mo>&lt;</mo></mrow></mrow><mfrac><msub><mi>q</mi><mi>n</mi></msub><mn>2</mn></mfrac><mo mathvariant="italic" separator="true"> </mo><mtext>or</mtext><mo mathvariant="italic" separator="true"> </mo><mrow><msub><mi>e</mi><mi>n</mi></msub><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\leqslant</mtext></merror><mo>⁢</mo><mrow><mo maxsize="210%" minsize="210%">⌈</mo><mfrac><msub><mi>q</mi><mi>n</mi></msub><mn>2</mn></mfrac><mo maxsize="210%" minsize="210%">⌉</mo></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>If we expand the fraction <span class="math-container" id="19674125" visual_id="53786"><math alttext="\dfrac{p}{q}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mi>p</mi><mi>q</mi></mfrac></mstyle></semantics></math></span>, that means the <span class="math-container" id="19674126" visual_id="23650"><math alttext="n^{\text{th}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>n</mi><mtext>th</mtext></msup></semantics></math></span> denominator <span class="math-container" id="19674127" visual_id="2746454"><math alttext="a_{n}=e_{1}\cdot\dotsc\cdot e_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>=</mo><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>⋅</mo><mi mathvariant="normal">…</mi><mo>⋅</mo><msub><mi>e</mi><mi>n</mi></msub></mrow></mrow></semantics></math></span> satisfies</p> <p><span class="math-container" id="19674128" visual_id="2746455"><math alttext="a_{n}\leqslant\biggl{\lceil}\frac{q}{2}\biggr{\rfloor}^{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>n</mi></msub><merror class="ltx_ERROR undefined undefined"><mtext>\leqslant</mtext></merror><msup><mrow><mo maxsize="210%" minsize="210%">⌈</mo><mfrac><mi>q</mi><mn>2</mn></mfrac><mo maxsize="210%" minsize="210%">⌋</mo></mrow><mi>n</mi></msup></mrow></semantics></math></span></p> <p>except possibly for the last denominator where we may have <span class="math-container" id="19674129" visual_id="2746456"><math alttext="e_{\ell}=q" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mi mathvariant="normal">ℓ</mi></msub><mo>=</mo><mi>q</mi></mrow></semantics></math></span>. In any case, we have</p> <p><span class="math-container" id="19674130" visual_id="2746457"><math alttext="a_{n}\leqslant 2\cdot\biggl{\lceil}\frac{q}{2}\biggr{\rfloor}^{n}," class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>n</mi></msub><merror class="ltx_ERROR undefined undefined"><mtext>\leqslant</mtext></merror><mn>2</mn><mo>⋅</mo><msup><mrow><mo maxsize="210%" minsize="210%">⌈</mo><mfrac><mi>q</mi><mn>2</mn></mfrac><mo maxsize="210%" minsize="210%">⌋</mo></mrow><mi>n</mi></msup><mo>,</mo></mrow></semantics></math></span></p> <p>so the denominators obtained via the Engel expansion grow at most exponentially.</p> <p>In the greedy algorithm on the other hand, the denominators of the considered fractions can grow, and they can grow quite fast, and that leads to the possibility of very large denominators occurring quickly. At a step before the greedy algorithm ends, we have</p> <p><span class="math-container" id="19674131" visual_id="2746458"><math alttext="\frac{1}{a_{n}}&amp;lt;\frac{p_{n}}{q_{n}}&amp;lt;\frac{1}{a_{n}-1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mfrac><mn>1</mn><msub><mi>a</mi><mi>n</mi></msub></mfrac><mo>&lt;</mo></mrow><mrow><mfrac><msub><mi>p</mi><mi>n</mi></msub><msub><mi>q</mi><mi>n</mi></msub></mfrac><mo>&lt;</mo></mrow><mfrac><mn>1</mn><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>-</mo><mn>1</mn></mrow></mfrac></mrow></semantics></math></span></p> <p>and consequently</p> <p><span class="math-container" id="19674132" visual_id="2746459"><math alttext="0&amp;lt;\frac{p_{n+1}}{q_{n+1}}=\frac{a_{n}p_{n}-q_{n}}{a_{n}q_{n}}&amp;lt;\frac{1}{a% _{n}-1}-\frac{1}{a_{n}}=\frac{1}{a_{n}(a_{n}-1)}," class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mrow><mrow><mn>0</mn><mo>&lt;</mo></mrow><mfrac><msub><mi>p</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><msub><mi>q</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mfrac></mrow><mo>=</mo><mrow><mfrac><mrow><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>p</mi><mi>n</mi></msub></mrow><mo>-</mo><msub><mi>q</mi><mi>n</mi></msub></mrow><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>⁢</mo><msub><mi>q</mi><mi>n</mi></msub></mrow></mfrac><mo>&lt;</mo></mrow></mrow><mrow><mrow><mfrac><mn>1</mn><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>-</mo><mn>1</mn></mrow></mfrac><mo>-</mo><mfrac><mn>1</mn><msub><mi>a</mi><mi>n</mi></msub></mfrac></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow></mrow><mo>,</mo></mrow></semantics></math></span></p> <p>so we have <span class="math-container" id="19674133" visual_id="2746460"><math alttext="a_{n+1}&amp;gt;a_{n}(a_{n}-1)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>a</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>&gt;</mo></mrow><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>. Considering only <span class="math-container" id="19674134" visual_id="1457521"><math alttext="\dfrac{p}{q}\in(0,1)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle displaystyle="true"><mfrac><mi>p</mi><mi>q</mi></mfrac></mstyle><mo>∈</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> to avoid initial <span class="math-container" id="19674135" visual_id="51438"><math alttext="\frac{1}{1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mn>1</mn></mfrac></semantics></math></span> in the expansion, in the greedy algorithm we have <span class="math-container" id="19674136" visual_id="2746461"><math alttext="a_{1}\geqslant 2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\geqslant</mtext></merror><mo>⁢</mo><mn>2</mn></mrow></semantics></math></span> and <span class="math-container" id="19674137" visual_id="2746462"><math alttext="a_{n+1}-\frac{1}{2}&amp;gt;\bigl{(}a_{n}-\frac{1}{2}\bigr{)}^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>a</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>-</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>&gt;</mo></mrow></mrow><msup><mrow><mo maxsize="120%" minsize="120%">(</mo><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>-</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><mo maxsize="120%" minsize="120%">)</mo></mrow><mn>2</mn></msup></mrow></semantics></math></span>, which yields a lower bound of</p> <p><span class="math-container" id="19674138" visual_id="2746463"><math alttext="a_{n}\geqslant\biggl{(}\frac{3}{2}\biggr{)}^{\bigl{(}2^{n-1}\bigr{)}}+\frac{1}% {2}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\geqslant</mtext></merror><mo>⁢</mo><msup><mrow><mo maxsize="210%" minsize="210%">(</mo><mfrac><mn>3</mn><mn>2</mn></mfrac><mo maxsize="210%" minsize="210%">)</mo></mrow><mrow><mo maxsize="171%" minsize="171%">(</mo><msup><mn>2</mn><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msup><mo maxsize="171%" minsize="171%">)</mo></mrow></msup></mrow><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>So the denominators in the greedy algorithm grow at least as fast as the composition of two exponentials. Unless the greedy algorithm yields a short expansion or the Engel algorithm yields a very long expansion, the at most geometric growth of the denominators obtained through Engel expansion is dwarfed by the superexponential growth of the denominators obtained in the greedy algorithm.</p> <p>But for fractions where the greedy algorithm yields a short expansion, the Engel algorithm can yield much larger denominators. The smallest (in the sense of smallest denominator and numerator) example is <span class="math-container" id="19674139" visual_id="25230"><math alttext="\dfrac{5}{6}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>5</mn><mn>6</mn></mfrac></mstyle></semantics></math></span>, where the greedy algorithm gives <span class="math-container" id="19674140" visual_id="1939161"><math alttext="\dfrac{5}{6}=\dfrac{1}{2}+\dfrac{1}{3}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle displaystyle="true"><mfrac><mn>5</mn><mn>6</mn></mfrac></mstyle><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo>+</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>3</mn></mfrac></mstyle></mrow></mrow></semantics></math></span>, while the Engel algorithm yields <span class="math-container" id="19674141" visual_id="2746464"><math alttext="\dfrac{5}{6}=\dfrac{1}{2}+\dfrac{1}{4}+\dfrac{1}{12}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle displaystyle="true"><mfrac><mn>5</mn><mn>6</mn></mfrac></mstyle><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo>+</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>4</mn></mfrac></mstyle><mo>+</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>12</mn></mfrac></mstyle></mrow></mrow></semantics></math></span>. A more striking example is <span class="math-container" id="19674142" visual_id="2746465"><math alttext="\dfrac{73}{366}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>73</mn><mn>366</mn></mfrac></mstyle></semantics></math></span>, where the greedy algorithm yields <span class="math-container" id="19674143" visual_id="2746466"><math alttext="\dfrac{73}{366}=\dfrac{1}{6}+\dfrac{1}{31}+\dfrac{1}{1891}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle displaystyle="true"><mfrac><mn>73</mn><mn>366</mn></mfrac></mstyle><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>6</mn></mfrac></mstyle><mo>+</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>31</mn></mfrac></mstyle><mo>+</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>1891</mn></mfrac></mstyle></mrow></mrow></semantics></math></span>, while the Engel algorithm yields</p> <p><span class="math-container" id="19674144" visual_id="2746467"><math alttext="\frac{73}{366}=\frac{1}{6}+\frac{1}{36}+\frac{1}{216}+\frac{1}{2808}+\frac{1}{% 44928}+\frac{1}{943488}+\frac{1}{29248128}+\frac{1}{1784135808}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mfrac><mn>73</mn><mn>366</mn></mfrac><mo>=</mo><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>36</mn></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>216</mn></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>2808</mn></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>44928</mn></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>943488</mn></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>29248128</mn></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>1784135808</mn></mfrac></mrow></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>Ouch!</p> <p>Let's look <em>why</em> the Engel algorithm loses so spectacularly here. We can formulate the algorithm to obtain an Egyptian fraction expansion of <span class="math-container" id="19674145" visual_id="53786"><math alttext="\dfrac{p}{q}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mi>p</mi><mi>q</mi></mfrac></mstyle></semantics></math></span> as</p> <ol> <li>Let <span class="math-container" id="19674146" visual_id="2746468"><math alttext="m=\biggl{\lceil}\dfrac{q}{p}\biggr{\rceil}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mrow><mo maxsize="210%" minsize="210%">⌈</mo><mstyle displaystyle="true"><mfrac><mi>q</mi><mi>p</mi></mfrac></mstyle><mo maxsize="210%" minsize="210%">⌉</mo></mrow></mrow></semantics></math></span>, output <span class="math-container" id="19674147" visual_id="88611"><math alttext="\dfrac{1}{m}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>1</mn><mi>m</mi></mfrac></mstyle></semantics></math></span>.</li> <li>Let <span class="math-container" id="19674148" visual_id="2746469"><math alttext="\tilde{p}=m\cdot p-q" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>p</mi><mo stretchy="false">~</mo></mover><mo>=</mo><mrow><mrow><mi>m</mi><mo>⋅</mo><mi>p</mi></mrow><mo>-</mo><mi>q</mi></mrow></mrow></semantics></math></span>. If <span class="math-container" id="19674149" visual_id="2746470"><math alttext="\tilde{p}=0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>p</mi><mo stretchy="false">~</mo></mover><mo>=</mo><mn>0</mn></mrow></semantics></math></span>, stop. Else expand <span class="math-container" id="19674150" visual_id="2746471"><math alttext="\dfrac{\tilde{p}}{q}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mover accent="true"><mi>p</mi><mo stretchy="false">~</mo></mover><mi>q</mi></mfrac></mstyle></semantics></math></span> (reducing the fraction lets one work with smaller numbers, but is not really necessary here) using this algorithm and multiply all denominators of the resulting expansion by <span class="math-container" id="19674151" visual_id="20"><math alttext="m" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi></semantics></math></span>.</li> </ol> <p>In the example above, we get</p> <p><span class="math-container" id="19674152" visual_id="2746472"><math alttext="E\biggl{(}\frac{73}{366}\biggr{)}=\frac{1}{6}+\frac{1}{6}\cdot E\biggl{(}\frac% {6\cdot 73-366}{366}\biggr{)}=\frac{1}{6}+\frac{1}{6}\cdot E\biggl{(}\frac{72}% {366}\biggr{)}=\frac{1}{6}+\frac{1}{6}\cdot E\biggl{(}\frac{12}{61}\biggr{)}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mi>E</mi><mo>⁢</mo><mrow><mo maxsize="210%" minsize="210%">(</mo><mfrac><mn>73</mn><mn>366</mn></mfrac><mo maxsize="210%" minsize="210%">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac><mo>+</mo><mrow><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac><mo>⋅</mo><mi>E</mi></mrow><mo>⁢</mo><mrow><mo maxsize="210%" minsize="210%">(</mo><mfrac><mrow><mrow><mn>6</mn><mo>⋅</mo><mn>73</mn></mrow><mo>-</mo><mn>366</mn></mrow><mn>366</mn></mfrac><mo maxsize="210%" minsize="210%">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac><mo>+</mo><mrow><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac><mo>⋅</mo><mi>E</mi></mrow><mo>⁢</mo><mrow><mo maxsize="210%" minsize="210%">(</mo><mfrac><mn>72</mn><mn>366</mn></mfrac><mo maxsize="210%" minsize="210%">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac><mo>+</mo><mrow><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac><mo>⋅</mo><mi>E</mi></mrow><mo>⁢</mo><mrow><mo maxsize="210%" minsize="210%">(</mo><mfrac><mn>12</mn><mn>61</mn></mfrac><mo maxsize="210%" minsize="210%">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>Now we see that the multiplying denominator <span class="math-container" id="19674153" visual_id="340"><math alttext="6" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>6</mn></semantics></math></span> and the numerator <span class="math-container" id="19674154" visual_id="2460"><math alttext="12" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>12</mn></semantics></math></span> of the next fraction to expand are not coprime. Per the algorithm, we do not simplify and expand <span class="math-container" id="19674155" visual_id="2746473"><math alttext="\dfrac{12}{61}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>12</mn><mn>61</mn></mfrac></mstyle></semantics></math></span>. That has a pretty bad expansion for both algorithms and thus leads to the above expansion. If we simplify and rewrite <span class="math-container" id="19674156" visual_id="2746474"><math alttext="\dfrac{1}{6}\cdot E\biggl{(}\dfrac{12}{61}\biggr{)}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>6</mn></mfrac></mstyle><mo>⋅</mo><mi>E</mi></mrow><mo>⁢</mo><mrow><mo maxsize="210%" minsize="210%">(</mo><mstyle displaystyle="true"><mfrac><mn>12</mn><mn>61</mn></mfrac></mstyle><mo maxsize="210%" minsize="210%">)</mo></mrow></mrow></semantics></math></span> to <span class="math-container" id="19674157" visual_id="2746475"><math alttext="E\biggl{(}\dfrac{2}{61}\biggr{)}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>⁢</mo><mrow><mo maxsize="210%" minsize="210%">(</mo><mstyle displaystyle="true"><mfrac><mn>2</mn><mn>61</mn></mfrac></mstyle><mo maxsize="210%" minsize="210%">)</mo></mrow></mrow></semantics></math></span>, which is mathematically valid of course, we get <span class="math-container" id="19674158" visual_id="2746476"><math alttext="\dfrac{2}{61}=\dfrac{1}{31}+\dfrac{1}{1891}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle displaystyle="true"><mfrac><mn>2</mn><mn>61</mn></mfrac></mstyle><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>31</mn></mfrac></mstyle><mo>+</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>1891</mn></mfrac></mstyle></mrow></mrow></semantics></math></span>, and the much nicer expansion that the greedy algorithm yields.</p> <p>This suggests that we may get expansions with smaller denominators if we modify the Engel algorithm to simplify in such cases. The modified algorithm is</p> <ol> <li>Let <span class="math-container" id="19674159" visual_id="2746468"><math alttext="m=\biggl{\lceil}\dfrac{q}{p}\biggr{\rceil}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mrow><mo maxsize="210%" minsize="210%">⌈</mo><mstyle displaystyle="true"><mfrac><mi>q</mi><mi>p</mi></mfrac></mstyle><mo maxsize="210%" minsize="210%">⌉</mo></mrow></mrow></semantics></math></span>, output <span class="math-container" id="19674160" visual_id="88611"><math alttext="\dfrac{1}{m}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>1</mn><mi>m</mi></mfrac></mstyle></semantics></math></span>.</li> <li>Let <span class="math-container" id="19674161" visual_id="2746469"><math alttext="\tilde{p}=m\cdot p-q" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>p</mi><mo stretchy="false">~</mo></mover><mo>=</mo><mrow><mrow><mi>m</mi><mo>⋅</mo><mi>p</mi></mrow><mo>-</mo><mi>q</mi></mrow></mrow></semantics></math></span>. If <span class="math-container" id="19674162" visual_id="2746470"><math alttext="\tilde{p}=0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>p</mi><mo stretchy="false">~</mo></mover><mo>=</mo><mn>0</mn></mrow></semantics></math></span>, stop. Else let <span class="math-container" id="19674163" visual_id="2746477"><math alttext="\dfrac{\hat{p}}{\hat{q}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mover accent="true"><mi>p</mi><mo stretchy="false">^</mo></mover><mover accent="true"><mi>q</mi><mo stretchy="false">^</mo></mover></mfrac></mstyle></semantics></math></span> the reduced form of <span class="math-container" id="19674164" visual_id="2746471"><math alttext="\dfrac{\tilde{p}}{q}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mover accent="true"><mi>p</mi><mo stretchy="false">~</mo></mover><mi>q</mi></mfrac></mstyle></semantics></math></span>, let <span class="math-container" id="19674165" visual_id="2746478"><math alttext="\dfrac{p^{\prime}}{m^{\prime}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><msup><mi>p</mi><mo>′</mo></msup><msup><mi>m</mi><mo>′</mo></msup></mfrac></mstyle></semantics></math></span> the reduced form of <span class="math-container" id="19674166" visual_id="2746479"><math alttext="\dfrac{\hat{p}}{m}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mover accent="true"><mi>p</mi><mo stretchy="false">^</mo></mover><mi>m</mi></mfrac></mstyle></semantics></math></span>, expand <span class="math-container" id="19674167" visual_id="2746480"><math alttext="\dfrac{p^{\prime}}{\hat{q}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><msup><mi>p</mi><mo>′</mo></msup><mover accent="true"><mi>q</mi><mo stretchy="false">^</mo></mover></mfrac></mstyle></semantics></math></span> using this algorithm and multiply all denominators of the resulting expansion by <span class="math-container" id="19674168" visual_id="47712"><math alttext="m^{\prime}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>m</mi><mo>′</mo></msup></semantics></math></span>.</li> </ol> <p>The modification pushes the algorithm in the direction of the greedy algorithm whenever <span class="math-container" id="19674169" visual_id="275216"><math alttext="\tilde{p}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover accent="true"><mi>p</mi><mo stretchy="false">~</mo></mover></semantics></math></span> and <span class="math-container" id="19674170" visual_id="20"><math alttext="m" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi></semantics></math></span> aren't coprime. That opens it to a weaker form of the risk of the greedy algorithm that a unit fraction is used that is too close to the fraction to expand for the next unit fraction to have a small(ish) denominator. We still have the growth bounds for the denominators that hold for the Engel algorithm, but it can happen that <span class="math-container" id="19674171" visual_id="2746481"><math alttext="\dfrac{p^{\prime}}{q}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><msup><mi>p</mi><mo>′</mo></msup><mi>q</mi></mfrac></mstyle></semantics></math></span> has a longer expansion than <span class="math-container" id="19674172" visual_id="2746471"><math alttext="\dfrac{\tilde{p}}{q}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mover accent="true"><mi>p</mi><mo stretchy="false">~</mo></mover><mi>q</mi></mfrac></mstyle></semantics></math></span>, leading to an overall expansion with larger denominators. But it seems plausible that this is a rare occurrence.</p> <p>Testing on fractions <span class="math-container" id="19674173" visual_id="53786"><math alttext="\dfrac{p}{q}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mi>p</mi><mi>q</mi></mfrac></mstyle></semantics></math></span> with <span class="math-container" id="19674174" visual_id="2746482"><math alttext="2\leqslant p&amp;lt;q\leqslant 100" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mn>2</mn><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\leqslant</mtext></merror><mo>⁢</mo><mi>p</mi><mo>&lt;</mo></mrow><mrow><mi>q</mi><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\leqslant</mtext></merror><mo>⁢</mo><mn>100</mn></mrow></mrow></semantics></math></span> and <span class="math-container" id="19674175" visual_id="161747"><math alttext="\gcd(p,q)=1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>gcd</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></semantics></math></span>, the modified algorithm does in the majority of cases yield the "better" of the expansions obtained by the greedy algorithm or the Engel algorithm, in some cases (roughly <span class="math-container" id="19674176" visual_id="7412"><math alttext="5\%" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>%</mo></mrow></semantics></math></span>) the modified algorithm produces an expansion whose largest denominator is smaller than that obtained from either the greedy or the Engel algorithm, and in few cases (about <span class="math-container" id="19674177" visual_id="320809"><math alttext="0.6\%" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.6</mn><mo>%</mo></mrow></semantics></math></span>) it produces an expansion whose largest denominator is larger than that produce by either of the other two algorithms. For larger <span class="math-container" id="19674178" visual_id="3699"><math alttext="p,q" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>,</mo><mi>q</mi></mrow></semantics></math></span> the expansions will generally become longer, so there will be more opportunity for the modified algorithm to differ from the Engel algorithm without producing the same expansion as the greedy algorithm. Nevertheless, I expect that it will continue to be at least as good as the greedy and the Engel algorithm for most inputs, strictly better (measured by largest denominator produced) in a non-negligible number of cases, and only rarely strictly worse than both. I dare not predict numbers, however.</p> <p>Another variation of the algorithm doesn't only use the current factor to simplify the fraction but also the previously determined factors. This leads to more simplifications occurring. According to my tests with small <span class="math-container" id="19674179" visual_id="3699"><math alttext="p,q" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>,</mo><mi>q</mi></mrow></semantics></math></span>, that more often leads to an expansion with smaller denominators than to one with larger denominators, and makes it the overall best of the four algorithms at least for smallish <span class="math-container" id="19674180" visual_id="3699"><math alttext="p,q" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>,</mo><mi>q</mi></mrow></semantics></math></span>. But I expect that will also be the case in general. (I make no promises, though, I guessed wrong before.) The algorithm is as follows: To expand the fraction <span class="math-container" id="19674181" visual_id="53786"><math alttext="\dfrac{p}{q}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mi>p</mi><mi>q</mi></mfrac></mstyle></semantics></math></span> with multiplier <span class="math-container" id="19674182" visual_id="20"><math alttext="m" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi></semantics></math></span>,</p> <ol> <li>Let <span class="math-container" id="19674183" visual_id="2746483"><math alttext="a=\biggl{\lceil}\dfrac{q}{p}\biggr{\rceil}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mrow><mo maxsize="210%" minsize="210%">⌈</mo><mstyle displaystyle="true"><mfrac><mi>q</mi><mi>p</mi></mfrac></mstyle><mo maxsize="210%" minsize="210%">⌉</mo></mrow></mrow></semantics></math></span>, output <span class="math-container" id="19674184" visual_id="2746484"><math alttext="\dfrac{1}{am}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>1</mn><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi></mrow></mfrac></mstyle></semantics></math></span>.</li> <li>Let <span class="math-container" id="19674185" visual_id="2746485"><math alttext="\tilde{p}=ap-q" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>p</mi><mo stretchy="false">~</mo></mover><mo>=</mo><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>p</mi></mrow><mo>-</mo><mi>q</mi></mrow></mrow></semantics></math></span>. If <span class="math-container" id="19674186" visual_id="2746470"><math alttext="\tilde{p}=0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>p</mi><mo stretchy="false">~</mo></mover><mo>=</mo><mn>0</mn></mrow></semantics></math></span>, stop. Else let <span class="math-container" id="19674187" visual_id="2746477"><math alttext="\dfrac{\hat{p}}{\hat{q}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mover accent="true"><mi>p</mi><mo stretchy="false">^</mo></mover><mover accent="true"><mi>q</mi><mo stretchy="false">^</mo></mover></mfrac></mstyle></semantics></math></span> the reduced form of <span class="math-container" id="19674188" visual_id="2746471"><math alttext="\dfrac{\tilde{p}}{q}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mover accent="true"><mi>p</mi><mo stretchy="false">~</mo></mover><mi>q</mi></mfrac></mstyle></semantics></math></span>, let <span class="math-container" id="19674189" visual_id="2746478"><math alttext="\dfrac{p^{\prime}}{m^{\prime}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><msup><mi>p</mi><mo>′</mo></msup><msup><mi>m</mi><mo>′</mo></msup></mfrac></mstyle></semantics></math></span> the reduced form of <span class="math-container" id="19674190" visual_id="2746486"><math alttext="\dfrac{\hat{p}}{am}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mover accent="true"><mi>p</mi><mo stretchy="false">^</mo></mover><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi></mrow></mfrac></mstyle></semantics></math></span> and expand <span class="math-container" id="19674191" visual_id="2746480"><math alttext="\dfrac{p^{\prime}}{\hat{q}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><msup><mi>p</mi><mo>′</mo></msup><mover accent="true"><mi>q</mi><mo stretchy="false">^</mo></mover></mfrac></mstyle></semantics></math></span> with multiplier <span class="math-container" id="19674192" visual_id="47712"><math alttext="m^{\prime}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>m</mi><mo>′</mo></msup></semantics></math></span> using this algorithm.</li> </ol> <hr/> <p>Some fun expansions (<code>svariant</code> is the first modification and <code>variant</code> is the last algorithm mentioned above; the names suck, but as is well-known, naming is the hardest thing in computer science):</p> <pre><code>*Egyptian&gt; greedy 113 355 [4,15,609,864780] *Egyptian&gt; engel 113 355 [4,16,176,7920,562320] *Egyptian&gt; svariant 113 355 [4,16,176,7920,562320] *Egyptian&gt; variant 113 355 [4,16,176,7810] *Egyptian&gt; greedy 53 75 [2,5,150] *Egyptian&gt; engel 53 75 [2,6,30,150] *Egyptian&gt; svariant 53 75 [2,6,26,650] *Egyptian&gt; variant 53 75 [2,6,25] *Egyptian&gt; greedy 63 76 [2,4,13,494] *Egyptian&gt; engel 63 76 [2,4,16,64,1216] *Egyptian&gt; svariant 63 76 [2,4,14,140,2660] *Egyptian&gt; variant 63 76 [2,4,14,133] *Egyptian&gt; greedy 44 59 [2,5,22,3245] *Egyptian&gt; engel 44 59 [2,6,18,54,216,2592,152928] *Egyptian&gt; svariant 44 59 [2,6,18,54,216,2592,152928] *Egyptian&gt; variant 44 59 [2,6,15,90,810,12150,716850] *Egyptian&gt; greedy 49 66 [2,5,24,1320] *Egyptian&gt; engel 49 66 [2,6,18,54,594] *Egyptian&gt; svariant 49 66 [2,5,25,425,14025] *Egyptian&gt; variant 49 66 [2,5,25,425,14025] *Egyptian&gt; greedy 73 99 [2,5,27,2970] *Egyptian&gt; engel 73 99 [2,6,18,72,792] *Egyptian&gt; svariant 73 99 [2,6,18,66] *Egyptian&gt; variant 73 99 [2,6,15,255,8415] </code></pre> <p>I particularly like the cases <span class="math-container" id="19674193" visual_id="2746487"><math alttext="\dfrac{53}{75}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>53</mn><mn>75</mn></mfrac></mstyle></semantics></math></span>, <span class="math-container" id="19674194" visual_id="2746488"><math alttext="\dfrac{63}{76}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>63</mn><mn>76</mn></mfrac></mstyle></semantics></math></span>, and <span class="math-container" id="19674195" visual_id="2746489"><math alttext="\dfrac{73}{99}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>73</mn><mn>99</mn></mfrac></mstyle></semantics></math></span> since all four algorithms produce different Egyptian fraction expansions for them. These examples illustrate that simplifying can have huge benefits, but it can also incur a significant penalty. </p> <p>I note in passing that you stopped the greedy expansion of <span class="math-container" id="19674196" visual_id="2746490"><math alttext="\dfrac{31}{311}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>31</mn><mn>311</mn></mfrac></mstyle></semantics></math></span> short, the greedy algorithm gives an expansion with ten unit fractions, the largest denominator having 537 digits.</p> <hr/> <p>Code (Haskell, unoptimised) for those who want to play:</p> <pre><code>module Egyptian where  greedy :: Integer -&gt; Integer -&gt; [Integer] greedy 0 _ = [] greedy p q = case quotRem q' p' of                (m,0) -&gt; [m]                (m,_) -&gt; let a = m+1 in a : greedy (a*p-q) (a*q)   where     (p',q') = case gcd q p of                 1 -&gt; (p,q)                 g -&gt; (p `quot` g , q `quot` g)  engel :: Integer -&gt; Integer -&gt; [Integer] engel 0 _ = [] engel p q = case quotRem q' p' of               (m,0) -&gt; [m]               (m,_) -&gt; let a = m+1 in a : map (*a) (engel (a*p-q) q)   where     (p',q') = case gcd q p of                 1 -&gt; (p,q)                 g -&gt; (p `quot` g , q `quot` g)  variant :: Integer -&gt; Integer -&gt; [Integer] variant p q = go 1 p' q'   where     (p',q') = case gcd q p of                 1 -&gt; (p,q)                 g -&gt; (p `quot` g , q `quot` g)     go m 1 b = [m*b]     go m a b = m' : go m'' a''' b'       where         e = 1 + (b `quot` a)         a' = a*e - b         g = gcd b a'         a'' = a' `quot` g         b' = b `quot` g         m' = m*e         g' = gcd m' a''         a''' = a'' `quot` g'         m'' = m' `quot` g'  svariant :: Integer -&gt; Integer -&gt; [Integer] svariant p q = go 1 p' q'   where     (p',q') = case gcd q p of                 1 -&gt; (p,q)                 g -&gt; (p `quot` g , q `quot` g)     go m 1 b = [m*b]     go m a b = (m*e) : go m' a''' b'       where         e = 1 + (b `quot` a)         a' = a*e - b         g = gcd b a'         a'' = a' `quot` g         b' = b `quot` g         g' = gcd e a''         e' = e `quot` g'         m' = m*e'         a''' = a'' `quot` g' </code></pre>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
<tr><td comment_id="4384616"> This is an excellent answer, thank you! Checking for divisibility is a difficult procedure to implement in an algorithm (not counting build-in functions of course, but they can still be slow for large numbers), but necessary in this case. And thank you for the new algorithms! Turns out that <span class="math-container" id="19674197" visual_id="2746491"><math alttext="73/366" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>73</mn><mo>/</mo><mn>366</mn></mrow></semantics></math></span> and your other examples can't be tackled by some of the 'best' algorithms I found so far. (without getting long and bad expansions). </td></tr><tr><td comment_id="4384630"> As for the mistake with 31/311, I just hadn't noticed because my algorithm had a 'safety feature' and it stopped once <span class="math-container" id="19674198" visual_id="83647"><math alttext="p_{n}/q_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>n</mi></msub><mo>/</mo><msub><mi>q</mi><mi>n</mi></msub></mrow></semantics></math></span> became too small </td></tr><tr><td comment_id="4385660"> <span class="math-container" id="19674199" visual_id="2746492"><math alttext="\dfrac{233}{987}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>233</mn><mn>987</mn></mfrac></mstyle></semantics></math></span>, <span class="math-container" id="19674200" visual_id="2746493"><math alttext="\dfrac{610}{987}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>610</mn><mn>987</mn></mfrac></mstyle></semantics></math></span>, <span class="math-container" id="19674201" visual_id="2746494"><math alttext="\dfrac{706}{987}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>706</mn><mn>987</mn></mfrac></mstyle></semantics></math></span> and <span class="math-container" id="19674202" visual_id="2746495"><math alttext="\dfrac{712}{987}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>712</mn><mn>987</mn></mfrac></mstyle></semantics></math></span> are also interesting. Again all algorithms give different expansions. </td></tr><tr><td comment_id="4385764"> Curious. Unfortunately, I don't know Haskell, so I can't try your algorithm without rewriting it first for Mathematica. Still, checking with some methods I found the best expansion for <span class="math-container" id="19674203" visual_id="2746494"><math alttext="\frac{706}{987}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>706</mn><mn>987</mn></mfrac></semantics></math></span> as `{2, 8, 14, 56, 987}`, using my 'splitting-joining algorithm' </td></tr><tr><td comment_id="4387249"> The second modified algorithm produces `[2,6,21,987]`. The first modified algorithm gives `[2,6,22,330,6930,325710]`, which is far less good. </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
<tr><td post_id="2132484"> Why this algorithm for egyptian fractions doesn't terminate in ~<span class="math-container" id="19710430" visual_id="358"><math alttext="2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn></semantics></math></span>% cases? </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
