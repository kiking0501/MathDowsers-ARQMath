<!DOCTYPE html>

<html>
<head>
<title>How to solve an equation with the sum of minima numerically?</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> How to solve an equation with the sum of minima numerically? </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="1378769">
<p>The equation is given by</p> <p><span class="math-container" id="12813642" visual_id="9013404"><math alttext="\sum_{n=1}^{N}\min(\gamma,\beta a_{n})=N" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mrow><mi>min</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>γ</mi><mo>,</mo><mrow><mi>β</mi><mo>⁢</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>=</mo><mi>N</mi></mrow></semantics></math></span> where <span class="math-container" id="12813643" visual_id="57"><math alttext="\beta" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi></semantics></math></span> is the variable with <span class="math-container" id="12813644" visual_id="9013405"><math alttext="\beta\in[0,\sqrt{\gamma}/\min(a_{n}\mid a_{n}&amp;gt;0)]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>∈</mo><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mrow><msqrt><mi>γ</mi></msqrt><mo>/</mo><mrow><mi>min</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>a</mi><mi>n</mi></msub><mo lspace="2.5pt" rspace="2.5pt">∣</mo><mrow><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>&gt;</mo></mrow><mn>0</mn></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></semantics></math></span>, <span class="math-container" id="12813645" visual_id="485"><math alttext="\gamma" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi></semantics></math></span> is a constant with <span class="math-container" id="12813646" visual_id="9013406"><math alttext="1\leq\gamma\leq N" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>γ</mi><mo>≤</mo><mi>N</mi></mrow></semantics></math></span>, and <span class="math-container" id="12813647" visual_id="2733"><math alttext="a_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>n</mi></msub></semantics></math></span> is an nonnegative constant.</p> <p>I know that the function <span class="math-container" id="12813648" visual_id="9013407"><math alttext="f(\beta)=\sum_{n=1}^{N}\min(\gamma,\beta a_{n})-N" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>β</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mrow><mi>min</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>γ</mi><mo>,</mo><mrow><mi>β</mi><mo>⁢</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>-</mo><mi>N</mi></mrow></mrow></semantics></math></span> is strictly increasing. Also, <span class="math-container" id="12813649" visual_id="188887"><math alttext="f(0)&amp;lt;0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><mo>&lt;</mo></mrow><mn>0</mn></mrow></semantics></math></span> and <span class="math-container" id="12813650" visual_id="9013408"><math alttext="f(\sqrt{\gamma}/\min(a_{n}\mid a_{n}&amp;gt;0))&amp;gt;0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msqrt><mi>γ</mi></msqrt><mo>/</mo><mrow><mi>min</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>a</mi><mi>n</mi></msub><mo lspace="2.5pt" rspace="2.5pt">∣</mo><mrow><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>&gt;</mo></mrow><mn>0</mn></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>&gt;</mo></mrow><mn>0</mn></mrow></semantics></math></span>. Thus, there must exist an unique solution for the above equation. How can I find the solution numerically? e.g. using matlab. Increasing <span class="math-container" id="12813651" visual_id="57"><math alttext="\beta" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi></semantics></math></span> slowly works, but it is not accurate. </p>
</div>
<hr/>
<div id="tags">
<span> numerical-methods </span><span> systems-of-equations </span><span> matlab </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
<tr><td comment_id="2807492"> have you tried with bi-section algorithm ? </td></tr><tr><td comment_id="2807611"> useful: https://en.wikipedia.org/wiki/Root-finding_algorithm </td></tr><tr><td comment_id="2807676"> I don't understand why is there <span class="math-container" id="12813652" visual_id="3399642"><math alttext="\sqrt{\gamma}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><mi>γ</mi></msqrt></semantics></math></span> in the upper bound. <span class="math-container" id="12813653" visual_id="9013409"><math alttext="\frac{1}{\min a_{n}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mrow><mi>min</mi><mo>⁡</mo><msub><mi>a</mi><mi>n</mi></msub></mrow></mfrac></semantics></math></span> should work as well. </td></tr><tr><td comment_id="2807798"> @uranix I got this equation from an optimization problem. Yes, without  <span class="math-container" id="12813654" visual_id="3399642"><math alttext="\sqrt{\gamma}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><mi>γ</mi></msqrt></semantics></math></span> is ok of course. Sorry for not simplifying the equation. </td></tr><tr><td comment_id="2807800"> @Cardinal : Yes, I think bi-section is a good choice now. It is simple and relatively efficient. </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="1378794" id="answer">
<p>The fastest generic (read: linear convergence) algorithm given a continuous function and an interval <span class="math-container" id="12813655" visual_id="3186"><math alttext="[a,b]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">]</mo></mrow></semantics></math></span> with <span class="math-container" id="12813656" visual_id="239909"><math alttext="f(a)&amp;lt;0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><mo>&lt;</mo></mrow><mn>0</mn></mrow></semantics></math></span> and <span class="math-container" id="12813657" visual_id="239910"><math alttext="f(b)&amp;gt;0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><mo>&gt;</mo></mrow><mn>0</mn></mrow></semantics></math></span> is called bisection (sometimes binary search):</p> <ol> <li>Look at the sign <span class="math-container" id="12813658" visual_id="706"><math alttext="s" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi></semantics></math></span> of <span class="math-container" id="12813659" visual_id="293607"><math alttext="f(\frac{a+b}{2})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mfrac><mrow><mi>a</mi><mo>+</mo><mi>b</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> <ul> <li>If <span class="math-container" id="12813660" visual_id="716"><math alttext="s=0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>0</mn></mrow></semantics></math></span>, we are done with the exact solution <span class="math-container" id="12813661" visual_id="30855"><math alttext="\frac{a+b}{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>a</mi><mo>+</mo><mi>b</mi></mrow><mn>2</mn></mfrac></semantics></math></span>.</li> <li>If <span class="math-container" id="12813662" visual_id="226"><math alttext="s=1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow></semantics></math></span>, we know the root is in <span class="math-container" id="12813663" visual_id="1462346"><math alttext="[a,\frac{a+b}{2}]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>a</mi><mo>,</mo><mfrac><mrow><mi>a</mi><mo>+</mo><mi>b</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">]</mo></mrow></semantics></math></span>, so set <span class="math-container" id="12813664" visual_id="13964"><math alttext="b=\frac{a+b}{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mfrac><mrow><mi>a</mi><mo>+</mo><mi>b</mi></mrow><mn>2</mn></mfrac></mrow></semantics></math></span> and repeat until the interval length <span class="math-container" id="12813665" visual_id="18583"><math alttext="b-a" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>-</mo><mi>a</mi></mrow></semantics></math></span> is less than <span class="math-container" id="12813666" visual_id="6115"><math alttext="2\epsilon" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>⁢</mo><mi>ϵ</mi></mrow></semantics></math></span></li> <li>If <span class="math-container" id="12813667" visual_id="28519"><math alttext="s=-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mrow><mo>-</mo><mn>1</mn></mrow></mrow></semantics></math></span>, we know the root is in <span class="math-container" id="12813668" visual_id="1238703"><math alttext="[\frac{a+b}{2},b]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mfrac><mrow><mi>a</mi><mo>+</mo><mi>b</mi></mrow><mn>2</mn></mfrac><mo>,</mo><mi>b</mi><mo stretchy="false">]</mo></mrow></semantics></math></span>, so set <span class="math-container" id="12813669" visual_id="8345066"><math alttext="a=\frac{a+b}{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mfrac><mrow><mi>a</mi><mo>+</mo><mi>b</mi></mrow><mn>2</mn></mfrac></mrow></semantics></math></span> and repeat until the interval length <span class="math-container" id="12813670" visual_id="18583"><math alttext="b-a" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>-</mo><mi>a</mi></mrow></semantics></math></span> is less than <span class="math-container" id="12813671" visual_id="6115"><math alttext="2\epsilon" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>⁢</mo><mi>ϵ</mi></mrow></semantics></math></span></li> </ul></li> <li>If <span class="math-container" id="12813672" visual_id="9013410"><math alttext="b-a&amp;lt;2\epsilon" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>b</mi><mo>-</mo><mrow><mi>a</mi><mo>&lt;</mo></mrow></mrow><mrow><mn>2</mn><mo>⁢</mo><mi>ϵ</mi></mrow></mrow></semantics></math></span>, return <span class="math-container" id="12813673" visual_id="30855"><math alttext="\frac{a+b}{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>a</mi><mo>+</mo><mi>b</mi></mrow><mn>2</mn></mfrac></semantics></math></span>. We know that the actual root is wihin <span class="math-container" id="12813674" visual_id="46"><math alttext="\epsilon" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϵ</mi></semantics></math></span> of this value.</li> </ol> <p>The guaranteed accuracy (<span class="math-container" id="12813675" visual_id="60765"><math alttext="\frac{b-a}{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>b</mi><mo>-</mo><mi>a</mi></mrow><mn>2</mn></mfrac></semantics></math></span>) is halved in each iteration, so we converge linearly to the solution. In other words we need linear time if the accuracy is given in digits. This algorithm is optimal and always converges as long as <span class="math-container" id="12813676" visual_id="1"><math alttext="f" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi></semantics></math></span> is continuous.</p> <p>A slight modification to prevent numerical problems if a root is on an interval boundary (i.e. found exactly), but the value returned isn't exactly <span class="math-container" id="12813677" visual_id="92"><math alttext="0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn></semantics></math></span> would be to also return if <span class="math-container" id="12813678" visual_id="9013411"><math alttext="|f(\frac{a+b}{2})|&amp;lt;\delta" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mo stretchy="false">|</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mfrac><mrow><mi>a</mi><mo>+</mo><mi>b</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">|</mo></mrow><mo>&lt;</mo></mrow><mi>δ</mi></mrow></semantics></math></span> for some tolerance <span class="math-container" id="12813679" visual_id="1336"><math alttext="\delta&amp;gt;0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>δ</mi><mo>&gt;</mo></mrow><mn>0</mn></mrow></semantics></math></span>.</p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
<tr><td comment_id="2807685"> That's <span class="math-container" id="25915130">n</span>ot a<span class="math-container" id="25915131">n</span> exponential convergence. It's a linear convergence (slowest). I.e. <span class="math-container" id="12813680" visual_id="9013412"><math alttext="\epsilon_{k+1}\leq 0.5\epsilon_{k}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>ϵ</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>≤</mo><mrow><mn>0.5</mn><mo>⁢</mo><msub><mi>ϵ</mi><mi>k</mi></msub></mrow></mrow><mo>.</mo></mrow></semantics></math></span> Quadratic convergence can be achieved by Newton's method, and that would be <span class="math-container" id="12813681" visual_id="9013413"><math alttext="\epsilon_{k+1}\leq C\epsilon_{k}^{2}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>ϵ</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>≤</mo><mrow><mi>C</mi><mo>⁢</mo><msubsup><mi>ϵ</mi><mi>k</mi><mn>2</mn></msubsup></mrow></mrow><mo>.</mo></mrow></semantics></math></span> Exponential convergence is convergence for every <span class="math-container" id="12813682" visual_id="74"><math alttext="p" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi></semantics></math></span> <span class="math-container" id="12813683" visual_id="9013414"><math alttext="\epsilon_{k+1}\leq C_{p}\epsilon^{p},\quad\forall p\exists C_{p}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>≤</mo><mrow><mrow><msub><mi>C</mi><mi>p</mi></msub><mo>⁢</mo><msup><mi>ϵ</mi><mi>p</mi></msup></mrow><mo rspace="12.5pt">,</mo><mrow><mo>∀</mo><mrow><mi>p</mi><mo>⁢</mo><mrow><mo>∃</mo><msub><mi>C</mi><mi>p</mi></msub></mrow></mrow></mrow></mrow></mrow></semantics></math></span> and I don't know such iterative methods. </td></tr><tr><td comment_id="2807706"> @uranix How is that slow convergence? Also AFAIK the convergence is measured globally as <span class="math-container" id="12813684" visual_id="9013415"><math alttext="\epsilon\leq 2^{-k}|x-x_{0}|\leq 2^{-k-1}(b-a)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>≤</mo><mrow><msup><mn>2</mn><mrow><mo>-</mo><mi>k</mi></mrow></msup><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mrow><mi>x</mi><mo>-</mo><msub><mi>x</mi><mn>0</mn></msub></mrow><mo stretchy="false">|</mo></mrow></mrow><mo>≤</mo><mrow><msup><mn>2</mn><mrow><mrow><mo>-</mo><mi>k</mi></mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>b</mi><mo>-</mo><mi>a</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> Newton also only converges quadratically if the function is at least <span class="math-container" id="12813685" visual_id="13489"><math alttext="C^{1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>C</mi><mn>1</mn></msup></semantics></math></span>, wich this one is not. </td></tr><tr><td comment_id="2807711"> What you wrote is called linear convergence. For iterative methods, linear convergence is not the same that linear convergence for ODE, for example. Newton method I've gave only as an example of method with quadratic convergence. Actually there's no need in iterative method for this problem, you might look at my answer, no tolerance <span class="math-container" id="12813686" visual_id="41"><math alttext="\delta" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi></semantics></math></span> at all. </td></tr><tr><td comment_id="2807717"> @uranix I did. Good catch for that. (+1 btw) I'll leave this inaccuracy for the moment as I don't have time now. </td></tr><tr><td comment_id="2808409"> @uranix Fixed it now. Thanks again :) </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
