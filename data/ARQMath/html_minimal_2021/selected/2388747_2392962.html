<!DOCTYPE html>

<html>
<head>
<title>Formula for ellipse formed from projecting a tilted circle onto the xy plane</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> Formula for ellipse formed from projecting a tilted circle onto the xy plane </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="2388747">
<p>A circle is drawn in the center of a piece of paper.  The piece of paper is placed on a table and a camera is positioned directly overtop to look at the circle.</p> <p>A piece of glass is placed between the camera and the piece of paper and is parallel to the piece of paper.  A cartesian plane is drawn onto the piece of glass with point (x1, y1) marking the center of the circle on the paper below.</p> <p>A point on the circumference of the circle is chosen and its (x,y) coordinate on the piece of glass is marked.</p> <p>The paper is then tilted about the line y=x1 (the horizontal line through the center of the circle).</p> <p>Note that as the paper is tilted the camera will observe an ellipse on the piece of glass: the projection of the circle onto the piece of glass, and the center point of the ellipse will still be (x1, y1).</p> <p>However, this is magic paper: as the paper tilts the circle drawn on the piece of paper grows or shrinks such that the projection of the circle onto the piece of glass always intersects the point (x, y).</p> <p><strong>What is the formula that describes the projected ellipse on the piece of glass given the tilt angle theta, the point (x, y), the circle’s center coordinates (x1, y1)?</strong>  Note that we do not know the radius of the original circle.</p> <p>The motivation for this question is that I am working on an mobile application that renders a map onto the screen.  The user's current location is marked with a blue dot.  I want the blue dot to be placed near the bottom-left corner of the screen.  But the dot itself cannot be moved: I must instead specify the latitude/longitude to be used as the center of the map and I need to calculate the map center to use in order to locate the blue dot at the desired location.  </p> <p>When the phone is rotated then the map needs to rotate about the blue dot (not about the center of the map).  The math to figure this out is easy if the "camera" is looking at the map head-on (tilt=0) as I just need to trace the circumference of the circle centered at the center of the map that goes through the desired (x,y) position of the blue dot; however, if the map is tilted then I need to instead trace the circumference of the ellipse passing through the blue dot, the ellipse formed by projecting a circle lying on the plane of the ground onto the screen, and I can't seem to figure out the formula for this ellipse.</p>
</div>
<hr/>
<div id="tags">
<span> trigonometry </span><span> conic-sections </span><span> projective-space </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
<tr><td comment_id="4931495"> The projected image will only stay centered on the camera’s axis (line of sight) for a parallel projection, i.e., for a camera at infinity. If the camera is at a finite distance from the image plane, the center of the projected image will drift away from this axis. In general, you’ll need to both shift the ellipse back to this visual center and adjust its size so that it will pass through <span class="math-container" id="22104900" visual_id="66"><math alttext="(x,y)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></semantics></math></span>. </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="2392962" id="answer">
<p>This situation is somewhat more complicated than you’ve assumed in your question. The center of the ellipse that’s the projection of the circle will in general not be the projection of the circle’s center. It will “drift” away from this point. This is because for a finite camera, i.e., one positioned a finite distance from the image, the projection is asymmetric: rays from the camera to the edge of the circle that’s tilted away from the camera make a smaller angle with the camera’s axis than do the corresponding rays on the opposite edge, so the foreshortening parallel to the <span class="math-container" id="22104924" visual_id="68"><math alttext="y" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi></semantics></math></span>-axis is greater on that side. This asymmetry also means that uniformly stretching the magic paper doesn’t correspond to a uniform scaling of the image (glass) plane, and vice-versa. We’ll come back to this later.  </p> <p>Aside from the obvious dependency on the tilt angle <span class="math-container" id="22104925" visual_id="206"><math alttext="\theta" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi></semantics></math></span>, for a camera positioned a finite distance <span class="math-container" id="22104926" visual_id="165366"><math alttext="f\gt 0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\gt</mtext></merror><mo>⁢</mo><mn>0</mn></mrow></semantics></math></span> from the image plane, the size, shape and location of the circle’s image also depend on the distance <span class="math-container" id="22104927" visual_id="110510"><math alttext="d\gt 0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\gt</mtext></merror><mo>⁢</mo><mn>0</mn></mrow></semantics></math></span> of the circle’s center from the image plane and radius <span class="math-container" id="22104928" visual_id="180"><math alttext="r" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi></semantics></math></span> of the circle. Note that even though we’re not given this radius explicitly, we can compute it from the two given points: <span class="math-container" id="22104929" visual_id="1907707"><math alttext="r=\sqrt{(x-x_{0})^{2}+(y-y_{0})^{2}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><msqrt><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>x</mi><mo>-</mo><msub><mi>x</mi><mn>0</mn></msub></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>y</mi><mo>-</mo><msub><mi>y</mi><mn>0</mn></msub></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></msqrt></mrow></semantics></math></span>. It’s reasonable to restrict <span class="math-container" id="22104930" visual_id="206"><math alttext="\theta" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi></semantics></math></span> to the open interval <span class="math-container" id="22104931" visual_id="7384"><math alttext="\left(-\frac{\pi}{2},\frac{\pi}{2}\right)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>(</mo><mrow><mo>-</mo><mfrac><mi>π</mi><mn>2</mn></mfrac></mrow><mo>,</mo><mfrac><mi>π</mi><mn>2</mn></mfrac><mo>)</mo></mrow></semantics></math></span>: When <span class="math-container" id="22104932" visual_id="719622"><math alttext="\theta=\pm\frac{\pi}{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mrow><mo>±</mo><mfrac><mi>π</mi><mn>2</mn></mfrac></mrow></mrow></semantics></math></span> we’re looking at the paper edge on, and beyond that we’re looking at the back of the paper.  </p> <p>It seems easiest to me to proceed in two stages: compute the raw projection of the circle and then adjust it to fit the constraints. We’ll do this by computing a homography—a planar perspective projection—between the two planes. W.l.o.g. assume that <span class="math-container" id="22104933" visual_id="69755"><math alttext="(x_{0},y_{0})=(0,0)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mo>=</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> since we can always translate to make it so. Place the glass on the <span class="math-container" id="22104934" visual_id="67"><math alttext="x" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi></semantics></math></span>-<span class="math-container" id="22104935" visual_id="68"><math alttext="y" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi></semantics></math></span> plane. Working in homogeneous coordinates, the camera is at <span class="math-container" id="22104936" visual_id="6472991"><math alttext="\mathbf{V}=[0,0,f,1]^{T}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐕</mi><mo>=</mo><msup><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mi>f</mi><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><mi>T</mi></msup></mrow></semantics></math></span> and the circle’s center at <span class="math-container" id="22104937" visual_id="6472992"><math alttext="[0,0,-d,1]^{T}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mrow><mo>-</mo><mi>d</mi></mrow><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><mi>T</mi></msup></semantics></math></span>. A normal to the paper’s plane is <span class="math-container" id="22104938" visual_id="6472993"><math alttext="[0,\cos\theta,\sin\theta,0]^{T}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi></mrow><mo>,</mo><mrow><mi>sin</mi><mo>⁡</mo><mi>θ</mi></mrow><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><mi>T</mi></msup></semantics></math></span>. The image plane is then <span class="math-container" id="22104939" visual_id="6472994"><math alttext="\mathbf{\Pi}_{\text{im}}=[0,0,-1,0]^{T}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝚷</mi><mtext>im</mtext></msub><mo>=</mo><msup><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><mi>T</mi></msup></mrow></semantics></math></span> and the paper’s plane is <span class="math-container" id="22104940" visual_id="6472995"><math alttext="\mathbf{\Pi}_{\text{src}}=[0,\sin\theta,-\cos\theta,-d\cos\theta]^{T}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝚷</mi><mtext>src</mtext></msub><mo>=</mo><msup><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mrow><mi>sin</mi><mo>⁡</mo><mi>θ</mi></mrow><mo>,</mo><mrow><mo>-</mo><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow><mo>,</mo><mrow><mo>-</mo><mrow><mi>d</mi><mo>⁢</mo><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow><mo stretchy="false">]</mo></mrow><mi>T</mi></msup></mrow></semantics></math></span>, although we won’t make direct use of the latter. The matrix <span class="math-container" id="22104941" visual_id="9917"><math alttext="\mathcal{P}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi class="ltx_font_mathcaligraphic">𝒫</mi></semantics></math></span> of the projection onto the image plane is <span class="math-container" id="22104942" visual_id="6472996"><math alttext="\mathcal{P}=\mathbf{V}\mathbf{\Pi}_{\text{im}}^{T}-\mathbf{V}^{T}\mathbf{\Pi}_% {\text{im}}\mathcal{I}_{4}=\begin{bmatrix}f&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;f&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;-1&amp;amp;f\end{bmatrix}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi class="ltx_font_mathcaligraphic">𝒫</mi><mo>=</mo><mrow><mrow><mi>𝐕</mi><mo>⁢</mo><msubsup><mi>𝚷</mi><mtext>im</mtext><mi>T</mi></msubsup></mrow><mo>-</mo><mrow><msup><mi>𝐕</mi><mi>T</mi></msup><mo>⁢</mo><msub><mi>𝚷</mi><mtext>im</mtext></msub><mo>⁢</mo><msub><mi class="ltx_font_mathcaligraphic">ℐ</mi><mn>4</mn></msub></mrow></mrow><mo>=</mo><mrow><mo>[</mo><mtable columnspacing="5pt" rowspacing="0pt"><mtr><mtd columnalign="center"><mi>f</mi></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mi>f</mi></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mo>-</mo><mn>1</mn></mrow></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mi>f</mi></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>.</mo></mrow></semantics></math></span> To complete the unadjusted homography we choose convenient bases for the two planes. For the image plane, we’ll simply drop the <span class="math-container" id="22104943" visual_id="44"><math alttext="z" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi></semantics></math></span>-coordinate. For the source plane, we place the origin at the circle’s center, take the “<span class="math-container" id="22104944" visual_id="67"><math alttext="x" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi></semantics></math></span>”-axis parallel to the world <span class="math-container" id="22104945" visual_id="67"><math alttext="x" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi></semantics></math></span>-axis and use the normal for the “<span class="math-container" id="22104946" visual_id="44"><math alttext="z" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi></semantics></math></span>”-axis. Putting these together with <span class="math-container" id="22104947" visual_id="9917"><math alttext="\mathcal{P}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi class="ltx_font_mathcaligraphic">𝒫</mi></semantics></math></span> produces the homography <span class="math-container" id="22104948" visual_id="6472997"><math alttext="\mathcal{H}=\begin{bmatrix}1&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;1&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;1\end{bmatrix}\begin{bmatrix}f&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;f&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;0&amp;amp;0\\ 0&amp;amp;0&amp;amp;-1&amp;amp;f\end{bmatrix}\begin{bmatrix}1&amp;amp;0&amp;amp;0\\ 0&amp;amp;\cos\theta&amp;amp;0\\ 0&amp;amp;\sin\theta&amp;amp;-d\\ 0&amp;amp;0&amp;amp;1\end{bmatrix}=\begin{bmatrix}f&amp;amp;0&amp;amp;0\\ 0&amp;amp;f\cos\theta&amp;amp;0\\ 0&amp;amp;-\sin\theta&amp;amp;f+d\end{bmatrix}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi class="ltx_font_mathcaligraphic">ℋ</mi><mo>=</mo><mrow><mrow><mo>[</mo><mtable columnspacing="5pt" rowspacing="0pt"><mtr><mtd columnalign="center"><mn>1</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>1</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>1</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>⁢</mo><mrow><mo>[</mo><mtable columnspacing="5pt" rowspacing="0pt"><mtr><mtd columnalign="center"><mi>f</mi></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mi>f</mi></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mo>-</mo><mn>1</mn></mrow></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mi>f</mi></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>⁢</mo><mrow><mo>[</mo><mtable columnspacing="5pt" rowspacing="0pt"><mtr><mtd columnalign="center"><mn>1</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mi>sin</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mo>-</mo><mi>d</mi></mrow></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>1</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>=</mo><mrow><mo>[</mo><mtable columnspacing="5pt" rowspacing="0pt"><mtr><mtd columnalign="center"><mi>f</mi></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mo>-</mo><mrow><mi>sin</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>.</mo></mrow></semantics></math></span> </p> <p>The general equation of a plane conic can be written in matrix form as <span class="math-container" id="22104949" visual_id="6472998"><math alttext="[x,y,1]\mathcal{C}[x,y,1]^{T}=0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mo stretchy="false">[</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><mo>⁢</mo><mi class="ltx_font_mathcaligraphic">𝒞</mi><mo>⁢</mo><msup><mrow><mo stretchy="false">[</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><mi>T</mi></msup></mrow><mo>=</mo><mn>0</mn></mrow></semantics></math></span>, where <span class="math-container" id="22104950" visual_id="5307"><math alttext="\mathcal{C}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi class="ltx_font_mathcaligraphic">𝒞</mi></semantics></math></span> is a symmetric <span class="math-container" id="22104951" visual_id="2507"><math alttext="3\times 3" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>×</mo><mn>3</mn></mrow></semantics></math></span> matrix. This equation has the same form when “homogenized” by replacing <span class="math-container" id="22104952" visual_id="67"><math alttext="x" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi></semantics></math></span> and <span class="math-container" id="22104953" visual_id="68"><math alttext="y" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi></semantics></math></span> by <span class="math-container" id="22104954" visual_id="1220513"><math alttext="x/w" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>/</mo><mi>w</mi></mrow></semantics></math></span> and <span class="math-container" id="22104955" visual_id="6472999"><math alttext="y/w" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>/</mo><mi>w</mi></mrow></semantics></math></span>, respectively, and we can identify conics with these matrices. They are covariant: if points transform according to <span class="math-container" id="22104956" visual_id="2241671"><math alttext="\mathbf{p}^{\prime}=\mathcal{M}\mathbf{p}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>𝐩</mi><mo>′</mo></msup><mo>=</mo><mrow><mi class="ltx_font_mathcaligraphic">ℳ</mi><mo>⁢</mo><mi>𝐩</mi></mrow></mrow></semantics></math></span>, then <span class="math-container" id="22104957" visual_id="5307"><math alttext="\mathcal{C}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi class="ltx_font_mathcaligraphic">𝒞</mi></semantics></math></span> transforms as <span class="math-container" id="22104958" visual_id="6473000"><math alttext="\mathcal{M}^{-T}\mathcal{C}\mathcal{M}^{-1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi class="ltx_font_mathcaligraphic">ℳ</mi><mrow><mo>-</mo><mi>T</mi></mrow></msup><mo>⁢</mo><mi class="ltx_font_mathcaligraphic">𝒞</mi><mo>⁢</mo><msup><mi class="ltx_font_mathcaligraphic">ℳ</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mrow></semantics></math></span>. Our circle is represented by the matrix <span class="math-container" id="22104959" visual_id="6473001"><math alttext="\mathcal{C}=\operatorname{diag}(1,1,-r^{2})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi class="ltx_font_mathcaligraphic">𝒞</mi><mo>=</mo><mrow><mi>diag</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mrow><mo>-</mo><msup><mi>r</mi><mn>2</mn></msup></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> and its image is: <span class="math-container" id="22104960" visual_id="6473002"><math alttext="\mathcal{C}^{\prime}=\mathcal{H}^{-T}\mathcal{C}\mathcal{H}^{-1}=\begin{% bmatrix}(f+d)^{2}&amp;amp;0&amp;amp;0\\ 0&amp;amp;(f+d)^{2}\sec^{2}\theta-r^{2}\tan^{2}\theta&amp;amp;-r^{2}f\tan\theta\\ 0&amp;amp;-r^{2}f\tan\theta&amp;amp;-r^{2}f^{2}\end{bmatrix}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒞</mi><mo>′</mo></msup><mo>=</mo><mrow><msup><mi class="ltx_font_mathcaligraphic">ℋ</mi><mrow><mo>-</mo><mi>T</mi></mrow></msup><mo>⁢</mo><mi class="ltx_font_mathcaligraphic">𝒞</mi><mo>⁢</mo><msup><mi class="ltx_font_mathcaligraphic">ℋ</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mrow><mo>=</mo><mrow><mo>[</mo><mtable columnspacing="5pt" rowspacing="0pt"><mtr><mtd columnalign="center"><msup><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup><mo>⁢</mo><mrow><msup><mi>sec</mi><mn>2</mn></msup><mo>⁡</mo><mi>θ</mi></mrow></mrow><mo>-</mo><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>⁢</mo><mrow><msup><mi>tan</mi><mn>2</mn></msup><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mo>-</mo><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mrow><mi>tan</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mo>-</mo><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mrow><mi>tan</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mo>-</mo><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>⁢</mo><msup><mi>f</mi><mn>2</mn></msup></mrow></mrow></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>.</mo></mrow></semantics></math></span> (I’ve multiplied through by <span class="math-container" id="22104961" visual_id="6473003"><math alttext="f^{2}(f+d)^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mn>2</mn></msup><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></semantics></math></span>, which doesn’t change the conic.) <span class="math-container" id="22104962" visual_id="6473004"><math alttext="\det\mathcal{C}^{\prime}\lt 0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>det</mo><mo>⁡</mo><mrow><msup><mi class="ltx_font_mathcaligraphic">𝒞</mi><mo>′</mo></msup><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\lt</mtext></merror><mo>⁢</mo><mn>0</mn></mrow></mrow></semantics></math></span>, so this is an ellipse when <span class="math-container" id="22104963" visual_id="6473005"><math alttext="(f+d)^{2}\gt r^{2}\sin^{2}\theta" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\gt</mtext></merror><mo>⁢</mo><msup><mi>r</mi><mn>2</mn></msup><mo>⁢</mo><mrow><msup><mi>sin</mi><mn>2</mn></msup><mo>⁡</mo><mi>θ</mi></mrow></mrow></semantics></math></span>, an hyperbola when <span class="math-container" id="22104964" visual_id="6473005"><math alttext="(f+d)^{2}\lt r^{2}\sin^{2}\theta" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\lt</mtext></merror><mo>⁢</mo><msup><mi>r</mi><mn>2</mn></msup><mo>⁢</mo><mrow><msup><mi>sin</mi><mn>2</mn></msup><mo>⁡</mo><mi>θ</mi></mrow></mrow></semantics></math></span>, while equality produces a parabola. These conditions correspond to zero, two and one intersections, respectively, of the tilted circle with the plane <span class="math-container" id="22104965" visual_id="244582"><math alttext="z=f" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>f</mi></mrow></semantics></math></span>. This ellipse is axis-aligned, but its center is not at the origin. <span class="math-container" id="22104966" visual_id="3659"><math alttext="\mathcal{H}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi class="ltx_font_mathcaligraphic">ℋ</mi></semantics></math></span> preserves colinearity, so the center of this ellipse is the midpoint of the points <span class="math-container" id="22104967" visual_id="6473006"><math alttext="\mathcal{H}[0,\pm r,1]^{T}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi class="ltx_font_mathcaligraphic">ℋ</mi><mo>⁢</mo><msup><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mrow><mo>±</mo><mi>r</mi></mrow><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><mi>T</mi></msup></mrow></semantics></math></span>, <span class="math-container" id="22104968" visual_id="6473007"><math alttext="\mathbf{c}^{\prime}=\left[0,{rf\sin\theta\over(f+d)^{2}-r^{2}\sin^{2}\theta}r% \cos\theta,1\right]^{T}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msup><mi>𝐜</mi><mo>′</mo></msup><mo>=</mo><msup><mrow><mo>[</mo><mn>0</mn><mo>,</mo><mrow><mfrac><mrow><mi>r</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mrow><mi>sin</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup><mo>-</mo><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>⁢</mo><mrow><msup><mi>sin</mi><mn>2</mn></msup><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow></mfrac><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow><mo>,</mo><mn>1</mn><mo>]</mo></mrow><mi>T</mi></msup></mrow><mo>.</mo></mrow></semantics></math></span> </p> <p>By linearity, a translation in one plane corresponds to a translation in the other plane, so the projected image’s center can be adjusted by “sliding” the paper a bit in the direction of its “<span class="math-container" id="22104969" visual_id="68"><math alttext="y" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi></semantics></math></span>”-axis. On the other hand, because of the asymmetry in the projection noted at the beginning, uniformly stretching the paper to hit the target point will change the shape of the ellipse. Not only that, because the center of the projection depends nonlinearly on the circle’s size, this stretch will also affect the shift needed to place the center where it’s supposed to go. I don’t think that’s what you really had in mind when you described the “magic paper,” so I’ll go through how to make the necessary adjustments <em>after</em> projection.  </p> <p>Since we already have the ellipse center <span class="math-container" id="22104970" visual_id="3769547"><math alttext="\mathbf{c}^{\prime}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>𝐜</mi><mo>′</mo></msup></semantics></math></span>, it’s easiest to first translate and then scale. The effect of this translation is easy to compute: the translated ellipse is in standard position, so the resulting matrix is diagonal, with the first two elements the same as those along the main diagonal of <span class="math-container" id="22104971" visual_id="40568"><math alttext="\mathcal{C}^{\prime}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi class="ltx_font_mathcaligraphic">𝒞</mi><mo>′</mo></msup></semantics></math></span>, while the lower-right element becomes <span class="math-container" id="22104972" visual_id="6473008"><math alttext="\mathbf{c}^{\prime T}\mathcal{C}^{\prime}\mathbf{c}^{\prime}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>𝐜</mi><mrow><mo mathsize="142%" stretchy="false">′</mo><mo>⁣</mo><mi>T</mi></mrow></msup><mo>⁢</mo><msup><mi class="ltx_font_mathcaligraphic">𝒞</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>𝐜</mi><mo>′</mo></msup></mrow></semantics></math></span>. We can then normalize this matrix so that the lower-right element is <span class="math-container" id="22104973" visual_id="343"><math alttext="-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>-</mo><mn>1</mn></mrow></semantics></math></span>, after which the semi-axis lengths can be read off as the reciprocal square roots of the other two diagonal elements. That is, <span class="math-container" id="22104974" visual_id="6473009"><math alttext="\begin{aligned} \displaystyle a^{2}&amp;\displaystyle amp;=-{\mathbf{c}^{\prime T}% \mathcal{C}^{\prime}\mathbf{c}^{\prime}\over\mathcal{C}^{\prime}_{1,1}}\\ \displaystyle b^{2}&amp;\displaystyle amp;=-{\mathbf{c}^{\prime T}\mathcal{C}^{% \prime}\mathbf{c}^{\prime}\over\mathcal{C}^{\prime}_{2,2}}.\end{aligned}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable columnspacing="0pt" rowspacing="0pt"><mtr><mtd columnalign="right"><msup><mi>a</mi><mn>2</mn></msup></mtd><mtd columnalign="left"><mrow><mi>a</mi><mi>m</mi><mi>p</mi><mo>;</mo><mo>=</mo><mo>-</mo><mstyle displaystyle="true"><mfrac><mrow><msup><mi>𝐜</mi><mrow><mo mathsize="142%" stretchy="false">′</mo><mo>⁣</mo><mi>T</mi></mrow></msup><mo>⁢</mo><msup><mi class="ltx_font_mathcaligraphic">𝒞</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>𝐜</mi><mo>′</mo></msup></mrow><msubsup><mi class="ltx_font_mathcaligraphic">𝒞</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow><mo>′</mo></msubsup></mfrac></mstyle></mrow></mtd></mtr><mtr><mtd columnalign="right"><msup><mi>b</mi><mn>2</mn></msup></mtd><mtd columnalign="left"><mrow><mi>a</mi><mi>m</mi><mi>p</mi><mo>;</mo><mo>=</mo><mo>-</mo><mstyle displaystyle="true"><mfrac><mrow><msup><mi>𝐜</mi><mrow><mo mathsize="142%" stretchy="false">′</mo><mo>⁣</mo><mi>T</mi></mrow></msup><mo>⁢</mo><msup><mi class="ltx_font_mathcaligraphic">𝒞</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>𝐜</mi><mo>′</mo></msup></mrow><msubsup><mi class="ltx_font_mathcaligraphic">𝒞</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow><mo>′</mo></msubsup></mfrac></mstyle><mo>.</mo></mrow></mtd></mtr></mtable></semantics></math></span> However, before going to the trouble of calculating these values, remember that this ellipse will be scaled, so we really only care about its eccentricity, which depends on the <em>ratio</em> of <span class="math-container" id="22104975" visual_id="3589"><math alttext="a^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>a</mi><mn>2</mn></msup></semantics></math></span> to <span class="math-container" id="22104976" visual_id="483"><math alttext="b^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>b</mi><mn>2</mn></msup></semantics></math></span>. Thus, we can simply use the diagonal elements <span class="math-container" id="22104977" visual_id="6473010"><math alttext="\mathcal{C}^{\prime}_{1,1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">𝒞</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow><mo>′</mo></msubsup></semantics></math></span> and <span class="math-container" id="22104978" visual_id="6473011"><math alttext="\mathcal{C}^{\prime}_{2,2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">𝒞</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow><mo>′</mo></msubsup></semantics></math></span> directly without computing <span class="math-container" id="22104979" visual_id="6473008"><math alttext="\mathbf{c}^{\prime T}\mathcal{C}^{\prime}\mathbf{c}^{\prime}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>𝐜</mi><mrow><mo mathsize="142%" stretchy="false">′</mo><mo>⁣</mo><mi>T</mi></mrow></msup><mo>⁢</mo><msup><mi class="ltx_font_mathcaligraphic">𝒞</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>𝐜</mi><mo>′</mo></msup></mrow></semantics></math></span> (or, for that matter, the center <span class="math-container" id="22104980" visual_id="3769547"><math alttext="\mathbf{c}^{\prime}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>𝐜</mi><mo>′</mo></msup></semantics></math></span> itself) and even discard other common factors to get <span class="math-container" id="22104981" visual_id="6473012"><math alttext="a^{-2}=1\\ b^{-2}=\sec^{2}\theta-{r^{2}\over(f+d)^{2}}\tan^{2}\theta." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msup><mi>a</mi><mrow><mo>-</mo><mn>2</mn></mrow></msup><mo>=</mo><mrow><mn>1</mn><mo>⁢</mo><msup><mi>b</mi><mrow><mo>-</mo><mn>2</mn></mrow></msup></mrow><mo>=</mo><mrow><mrow><msup><mi>sec</mi><mn>2</mn></msup><mo>⁡</mo><mi>θ</mi></mrow><mo>-</mo><mrow><mfrac><msup><mi>r</mi><mn>2</mn></msup><msup><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mfrac><mo>⁢</mo><mrow><msup><mi>tan</mi><mn>2</mn></msup><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span> </p> <p>(To satisfy my curiosity, I computed the actual values, anyway: <span class="math-container" id="22104982" visual_id="6473013"><math alttext="a^{2}={f^{2}\over(f+d)^{2}-r^{2}\sin^{2}\theta}r^{2}\\ b^{2}=\left({f(f+d)\over(f+d)^{2}-r^{2}\sin^{2}\theta}\right)^{2}r^{2}\cos^{2}\theta." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msup><mi>a</mi><mn>2</mn></msup><mo>=</mo><mrow><mfrac><msup><mi>f</mi><mn>2</mn></msup><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup><mo>-</mo><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>⁢</mo><mrow><msup><mi>sin</mi><mn>2</mn></msup><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow></mfrac><mo>⁢</mo><msup><mi>r</mi><mn>2</mn></msup><mo>⁢</mo><msup><mi>b</mi><mn>2</mn></msup></mrow><mo>=</mo><mrow><msup><mrow><mo>(</mo><mfrac><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup><mo>-</mo><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>⁢</mo><mrow><msup><mi>sin</mi><mn>2</mn></msup><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow></mfrac><mo>)</mo></mrow><mn>2</mn></msup><mo>⁢</mo><msup><mi>r</mi><mn>2</mn></msup><mo>⁢</mo><mrow><msup><mi>cos</mi><mn>2</mn></msup><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span> As <span class="math-container" id="22104983" visual_id="96553"><math alttext="f\to\infty" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></semantics></math></span>, i.e., as the projection becomes parallel, <span class="math-container" id="22104984" visual_id="6473014"><math alttext="a\to r" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>→</mo><mi>r</mi></mrow></semantics></math></span>, <span class="math-container" id="22104985" visual_id="6473015"><math alttext="b\to r\cos\theta" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>→</mo><mrow><mi>r</mi><mo>⁢</mo><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow></semantics></math></span> and <span class="math-container" id="22104986" visual_id="6473016"><math alttext="\mathbf{c}^{\prime}\to[0,0,1]^{T}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>𝐜</mi><mo>′</mo></msup><mo>→</mo><msup><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><mi>T</mi></msup></mrow></semantics></math></span>.)  </p> <p>To find the necessary scale factor so that this translated ellipse passes through <span class="math-container" id="22104987" visual_id="6473017"><math alttext="\mathbf{p}^{\prime}=[x_{p},y_{p},1]^{T}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>𝐩</mi><mo>′</mo></msup><mo>=</mo><msup><mrow><mo stretchy="false">[</mo><msub><mi>x</mi><mi>p</mi></msub><mo>,</mo><msub><mi>y</mi><mi>p</mi></msub><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><mi>T</mi></msup></mrow></semantics></math></span>, observe that scaling the ellipse <span class="math-container" id="22104988" visual_id="43381"><math alttext="{x^{2}\over a^{2}}+{y^{2}\over b^{2}}=1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mfrac><msup><mi>x</mi><mn>2</mn></msup><msup><mi>a</mi><mn>2</mn></msup></mfrac><mo>+</mo><mfrac><msup><mi>y</mi><mn>2</mn></msup><msup><mi>b</mi><mn>2</mn></msup></mfrac></mrow><mo>=</mo><mn>1</mn></mrow></semantics></math></span> by a factor of <span class="math-container" id="22104989" visual_id="4869"><math alttext="s&amp;gt;0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>s</mi><mo>&gt;</mo></mrow><mn>0</mn></mrow></semantics></math></span> changes the equation to <span class="math-container" id="22104990" visual_id="6473018"><math alttext="{x^{2}\over a^{2}}+{y^{2}\over b^{2}}=s^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mfrac><msup><mi>x</mi><mn>2</mn></msup><msup><mi>a</mi><mn>2</mn></msup></mfrac><mo>+</mo><mfrac><msup><mi>y</mi><mn>2</mn></msup><msup><mi>b</mi><mn>2</mn></msup></mfrac></mrow><mo>=</mo><msup><mi>s</mi><mn>2</mn></msup></mrow></semantics></math></span>, therefore the correct scale factor is <span class="math-container" id="22104991" visual_id="6473019"><math alttext="s=\sqrt{{x_{p}^{2}\over a^{2}}+{y_{p}^{2}\over b^{2}}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><msqrt><mrow><mfrac><msubsup><mi>x</mi><mi>p</mi><mn>2</mn></msubsup><msup><mi>a</mi><mn>2</mn></msup></mfrac><mo>+</mo><mfrac><msubsup><mi>y</mi><mi>p</mi><mn>2</mn></msubsup><msup><mi>b</mi><mn>2</mn></msup></mfrac></mrow></msqrt></mrow></semantics></math></span> and the equation of the adjusted ellipse is <span class="math-container" id="22104992" visual_id="6473020"><math alttext="{x^{2}\over a^{2}}+{y^{2}\over b^{2}}={x_{p}^{2}\over a^{2}}+{y_{p}^{2}\over b% ^{2}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mfrac><msup><mi>x</mi><mn>2</mn></msup><msup><mi>a</mi><mn>2</mn></msup></mfrac><mo>+</mo><mfrac><msup><mi>y</mi><mn>2</mn></msup><msup><mi>b</mi><mn>2</mn></msup></mfrac></mrow><mo>=</mo><mrow><mfrac><msubsup><mi>x</mi><mi>p</mi><mn>2</mn></msubsup><msup><mi>a</mi><mn>2</mn></msup></mfrac><mo>+</mo><mfrac><msubsup><mi>y</mi><mi>p</mi><mn>2</mn></msubsup><msup><mi>b</mi><mn>2</mn></msup></mfrac></mrow></mrow></semantics></math></span> with <span class="math-container" id="22104993" visual_id="3589"><math alttext="a^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>a</mi><mn>2</mn></msup></semantics></math></span> and <span class="math-container" id="22104994" visual_id="483"><math alttext="b^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>b</mi><mn>2</mn></msup></semantics></math></span> as above. Substituting for <span class="math-container" id="22104995" visual_id="3589"><math alttext="a^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>a</mi><mn>2</mn></msup></semantics></math></span> and <span class="math-container" id="22104996" visual_id="483"><math alttext="b^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>b</mi><mn>2</mn></msup></semantics></math></span> and rearranging finally gives the sought-after equation: <span class="math-container" id="22104997" visual_id="6473021"><math alttext="(x^{2}-x_{p}^{2})+(y^{2}-y_{p}^{2})\left(\sec^{2}\theta-{r^{2}\over(f+d)^{2}}% \tan^{2}\theta\right)=0." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>-</mo><msubsup><mi>x</mi><mi>p</mi><mn>2</mn></msubsup></mrow><mo stretchy="false">)</mo></mrow><mo>+</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>-</mo><msubsup><mi>y</mi><mi>p</mi><mn>2</mn></msubsup></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo>(</mo><mrow><mrow><msup><mi>sec</mi><mn>2</mn></msup><mo>⁡</mo><mi>θ</mi></mrow><mo>-</mo><mrow><mfrac><msup><mi>r</mi><mn>2</mn></msup><msup><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mfrac><mo>⁢</mo><mrow><msup><mi>tan</mi><mn>2</mn></msup><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>=</mo><mn>0</mn></mrow><mo>.</mo></mrow></semantics></math></span> In the limit as <span class="math-container" id="22104998" visual_id="96553"><math alttext="f\to\infty" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></semantics></math></span>, this becomes <span class="math-container" id="22104999" visual_id="6473022"><math alttext="(x^{2}-x_{p}^{2})+(y^{2}-y_{p}^{2})\sec^{2}\theta" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>-</mo><msubsup><mi>x</mi><mi>p</mi><mn>2</mn></msubsup></mrow><mo stretchy="false">)</mo></mrow><mo>+</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>-</mo><msubsup><mi>y</mi><mi>p</mi><mn>2</mn></msubsup></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><msup><mi>sec</mi><mn>2</mn></msup><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow></semantics></math></span>. Note that the final adjusted ellipse doesn’t so much depend on the actual values of <span class="math-container" id="22105000" visual_id="180"><math alttext="r" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi></semantics></math></span>, <span class="math-container" id="22105001" visual_id="1"><math alttext="f" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi></semantics></math></span> and <span class="math-container" id="22105002" visual_id="302"><math alttext="d" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi></semantics></math></span> as on the ratio of the size of the circle to the distance of the camera from its center. If this distance is large relative to the radius of the circle, or the tilt angle very large or small, the limit ellipse is a good approximation to the true image.</p> <p>In matrix terms, the final ellipse is obtained via the transformation matrix <span class="math-container" id="22105003" visual_id="6473023"><math alttext="\begin{bmatrix}s&amp;amp;0&amp;amp;-sc^{\prime}_{x}\\ 0&amp;amp;s&amp;amp;-sc^{\prime}_{y}\\ 0&amp;amp;0&amp;amp;1\end{bmatrix}\mathcal{H}=\begin{bmatrix}sf&amp;amp;0&amp;amp;0\\ 0&amp;amp;s(f\cos\theta+c^{\prime}_{y}\sin\theta)&amp;amp;-sc^{\prime}_{y}(f+d)\\ 0&amp;amp;-\sin\theta&amp;amp;f+d\end{bmatrix}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mrow><mo>[</mo><mtable columnspacing="5pt" rowspacing="0pt"><mtr><mtd columnalign="center"><mi>s</mi></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mo>-</mo><mrow><mi>s</mi><mo>⁢</mo><msubsup><mi>c</mi><mi>x</mi><mo>′</mo></msubsup></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mi>s</mi></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mo>-</mo><mrow><mi>s</mi><mo>⁢</mo><msubsup><mi>c</mi><mi>y</mi><mo>′</mo></msubsup></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>1</mn></mrow></mtd></mtr></mtable><mo>]</mo></mrow><mo>⁢</mo><mi class="ltx_font_mathcaligraphic">ℋ</mi></mrow><mo>=</mo><mrow><mo>[</mo><mtable columnspacing="5pt" rowspacing="0pt"><mtr><mtd columnalign="center"><mrow><mi>s</mi><mo>⁢</mo><mi>f</mi></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mi>s</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow><mo>+</mo><mrow><msubsup><mi>c</mi><mi>y</mi><mo>′</mo></msubsup><mo>⁢</mo><mrow><mi>sin</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mo>-</mo><mrow><mi>s</mi><mo>⁢</mo><msubsup><mi>c</mi><mi>y</mi><mo>′</mo></msubsup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mo>-</mo><mrow><mi>sin</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>.</mo></mrow></semantics></math></span> Here, <span class="math-container" id="22105004" visual_id="706"><math alttext="s" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi></semantics></math></span> should be computed using the true values of <span class="math-container" id="22105005" visual_id="159"><math alttext="a" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi></semantics></math></span> and <span class="math-container" id="22105006" visual_id="368"><math alttext="b" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi></semantics></math></span>. This matrix allows you to map the entire source plane, not just the circle, if so desired.  </p> <p>If you want to do the scaling on the paper side instead, that will entail a similar computation. Instead of starting out with <span class="math-container" id="22105007" visual_id="3659"><math alttext="\mathcal{H}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi class="ltx_font_mathcaligraphic">ℋ</mi></semantics></math></span>, however, you’ll use <span class="math-container" id="22105008" visual_id="6473024"><math alttext="\mathcal{H}^{\prime}=\begin{bmatrix}sf&amp;amp;0&amp;amp;0\\ 0&amp;amp;sf\cos\theta&amp;amp;0\\ 0&amp;amp;-s\sin\theta&amp;amp;f+d\end{bmatrix}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msup><mi class="ltx_font_mathcaligraphic">ℋ</mi><mo>′</mo></msup><mo>=</mo><mrow><mo>[</mo><mtable columnspacing="5pt" rowspacing="0pt"><mtr><mtd columnalign="center"><mrow><mi>s</mi><mo>⁢</mo><mi>f</mi></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mi>s</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mo>-</mo><mrow><mi>s</mi><mo>⁢</mo><mrow><mi>sin</mi><mo>⁡</mo><mi>θ</mi></mrow></mrow></mrow></mrow></mtd><mtd columnalign="center"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>p</mi></mrow><mo>;</mo><mrow><mi>f</mi><mo>+</mo><mi>d</mi></mrow></mrow></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>.</mo></mrow></semantics></math></span> The center of the ellipse and its semi-axis lengths are found as above, but they will all depend on the unknown scale factor <span class="math-container" id="22105009" visual_id="706"><math alttext="s" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi></semantics></math></span>. Plugging the coordinates of <span class="math-container" id="22105010" visual_id="160982"><math alttext="\mathbf{p}^{\prime}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>𝐩</mi><mo>′</mo></msup></semantics></math></span> into the resulting ellipse equation will let you solve for this scale factor.</p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
<tr><td comment_id="4936656"> The projective viewpoint certainly eases the visualization and the algebra. (+1 of course.) </td></tr><tr><td comment_id="4939086"> Wow I've never worked with perspective geometry before!  Thank you for the detailed explanation.  Would it be possible to write the equation in parametric form?  That is, given an angle phi from the circle's center coordinates what is the (x,y) coordinates that satisfy the relation?  I was able to convert the first response from ronald-blaak into the x=a*cos(t) and y=b*sin(t) parametric form but I don't have the skills to convert the final equation provided by amd into parametric form. </td></tr><tr><td comment_id="4939151"> @denversc Write it as <span class="math-container" id="22105011" visual_id="6473025"><math alttext="(x^{2}-x_{p}^{2})+\mu(y^{2}-y_{p}^{2})=0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>-</mo><msubsup><mi>x</mi><mi>p</mi><mn>2</mn></msubsup></mrow><mo stretchy="false">)</mo></mrow><mo>+</mo><mrow><mi>μ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>-</mo><msubsup><mi>y</mi><mi>p</mi><mn>2</mn></msubsup></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>=</mo><mn>0</mn></mrow></semantics></math></span> and rearrange it into standard form. </td></tr><tr><td comment_id="4940600"> @denversc Actually, you can just go back one equation and divide that one through by the r.h.s. to get an equation in standard form. </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
<tr><td post_id="2385120"> Area of a circle as it changes to an ellipse when viewing at different angles </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
