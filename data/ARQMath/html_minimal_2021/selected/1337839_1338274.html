<!DOCTYPE html>

<html>
<head>
<title>Is my answer correct? Expected number of coin flips to get 5 consecutive heads</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> Is my answer correct? Expected number of coin flips to get 5 consecutive heads </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="1337839">
<p>I found this puzzle online. Before my question gets flagged or on hold, I know the question has already been answered <a href="https://math.stackexchange.com/questions/364038/expected-number-of-coin-tosses-to-get-five-consecutive-heads">here</a> but since I tried to solve it on my own I want to check if it's correct or not.</p> <p>The puzzle is "What is the expected Number of Coin Tosses to Get Five Consecutive Heads".</p> <p>My answer is the following:</p> <p>Because a coin has two sides, one for tails and one for heads, let <span class="math-container" id="12434043" visual_id="74"><math alttext="p" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi></semantics></math></span> be the probability of getting heads. Then the probability of getting tails is <span class="math-container" id="12434044" visual_id="10548"><math alttext="1-p" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>-</mo><mi>p</mi></mrow></semantics></math></span>. For obvious reasons I shall assume that the coin is fair, thus the probability of getting heads is <span class="math-container" id="12434045" visual_id="363"><math alttext="\dfrac{1}{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></semantics></math></span> and tails <span class="math-container" id="12434046" visual_id="363"><math alttext="\dfrac{1}{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></semantics></math></span> as well.</p> <p>Let <span class="math-container" id="12434047" visual_id="377"><math alttext="X_{i}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub></semantics></math></span> be a random variable indicating the number of flips required to get heads, when <span class="math-container" id="12434048" visual_id="9537"><math alttext="i-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></semantics></math></span> was heads.</p> <p>What we are looking for is the number of tries for a single success, thus we shall assume the random variable <span class="math-container" id="12434049" visual_id="377"><math alttext="X_{i}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub></semantics></math></span> is following the Geometric Distribution with Probability <span class="math-container" id="12434050" visual_id="7694255"><math alttext="P(X_{i}=x)=p(1-p)^{x-1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>=</mo><mi>p</mi><msup><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>-</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><mrow><mi>x</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></semantics></math></span>.</p> <p>The expected number of coin flips to get 5 consecutive heads is given by the expected average <span class="math-container" id="12434051" visual_id="754810"><math alttext="E(X)=\dfrac{1}{p}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mstyle displaystyle="true"><mfrac><mn>1</mn><mi>p</mi></mfrac></mstyle></mrow></semantics></math></span>. </p> <p>The probability of the random variable <span class="math-container" id="12434052" visual_id="377"><math alttext="X_{i}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub></semantics></math></span> is <span class="math-container" id="12434053" visual_id="1599314"><math alttext="\dfrac{1}{2^{i}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mstyle displaystyle="true"><mfrac><mn>1</mn><msup><mn>2</mn><mi>i</mi></msup></mfrac></mstyle></semantics></math></span> since the coin is fair.</p> <p>Thus for <span class="math-container" id="12434054" visual_id="339"><math alttext="5" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>5</mn></semantics></math></span> consecutive heads <span class="math-container" id="12434055" visual_id="7694256"><math alttext="E(X)=E(X_{1})+...+E(X_{5})=\sum_{i=1}^{5}E(X_{i})=\sum_{i=1}^{5}2^{i}=62" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mi mathvariant="normal">…</mi><mo>+</mo><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>X</mi><mn>5</mn></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>5</mn></msubsup><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>5</mn></msubsup><msup><mn>2</mn><mi>i</mi></msup></mrow><mo>=</mo><mn>62</mn></mrow></semantics></math></span></p> <p>So the expected number of coin flips to get <span class="math-container" id="12434056" visual_id="339"><math alttext="5" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>5</mn></semantics></math></span> consecutive heads is <span class="math-container" id="12434057" visual_id="7646"><math alttext="62" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>62</mn></semantics></math></span>.</p>
</div>
<hr/>
<div id="tags">
<span> probability </span><span> statistics </span><span> puzzle </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
<tr><td comment_id="2718928"> Just for fun I simulated this in excel, using all of the columns except 1 for 16,383 samples for each simulation.  The rows were the coin flips.  After a few recalculations the averages of the 16,383 runs were: 61.41469816, 62.28999573, 61.48391625, 61.73258866, 62.85423915.  It seems to support your answer. </td></tr><tr><td comment_id="2718940"> @MitchellKaplan I'm curious, how can you run a simulation in excel? I thought probability simulations were written in R. </td></tr><tr><td comment_id="2719052"> Excel has a Rand() function, which returns a uniform random number X, with 0&lt;=X&lt;1.  In sheet1, cell A1 contains Rand()&lt;.5.  I decided that a result of TRUE is heads, and FALSE is tails.  Copy this down for about 1,000 rows.  On sheet2, cell A5 put the following formula:  AND(Sheet1!A1:A5).  So if cells A1-A5 (on sheet1) are all "heads", then the value of A5 on sheet 2 will be TRUE.  Copy this formula (on sheet2) down for 1,000 rows.  Now you have to find out where the first TRUE occurs in that column of sheet 2.  I'm running out of room here.  Copy this to other columns.  Hit F9 to do a recalc </td></tr><tr><td comment_id="2719843"> I tried to understand the definition of your <span class="math-container" id="12434065" visual_id="377"><math alttext="X_{i}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub></semantics></math></span> but I failed. Could you explain again? I didi't understand what you meant by "probability of the random variable <span class="math-container" id="12434065" visual_id="377"><math alttext="X_{i}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub></semantics></math></span>." </td></tr><tr><td comment_id="2719856"> @RodrigoRibeiro pardon my math terms  but English isn't my first language. I defined <span class="math-container" id="12434065" visual_id="377"><math alttext="X_{i}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub></semantics></math></span> as the random variable showing the number of coin flips to get head , when the previous flip <span class="math-container" id="12434064" visual_id="9537"><math alttext="i-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></semantics></math></span> was heads. At the probability of the random variable I meant because the flips are independent, to get <span class="math-container" id="12434062" visual_id="83"><math alttext="k" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi></semantics></math></span> consecutive heads the probability is <span class="math-container" id="12434063" visual_id="16262"><math alttext="\frac{1}{2^{k}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><msup><mn>2</mn><mi>k</mi></msup></mfrac></semantics></math></span>. </td></tr><tr><td comment_id="2719870"> No problem, it isn't my first language too. Well, now I get it. And it is correct. </td></tr><tr><td comment_id="2720073"> Why do you add "when the previous flip <span class="math-container" id="12434064" visual_id="9537"><math alttext="i-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></semantics></math></span> was heads"? Are the variables <span class="math-container" id="12434065" visual_id="377"><math alttext="X_{i}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub></semantics></math></span> not independent? </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="1338274" id="answer">
<p>I ask you for additional explanation. Meanwhile I'll post here another approach.</p> <p>Denote by <span class="math-container" id="12434066" visual_id="7694257"><math alttext="\tau_{i}^{5}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>τ</mi><mi>i</mi><mn>5</mn></msubsup></semantics></math></span> the random variable that counts the time required to get five heads starting from <span class="math-container" id="12434067" visual_id="158"><math alttext="i" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi></semantics></math></span> heads, ok? </p> <p>What we want is exactly <span class="math-container" id="12434068" visual_id="7694258"><math alttext="E[\tau_{0}^{5}]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><msubsup><mi>τ</mi><mn>0</mn><mn>5</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow></semantics></math></span>, right?</p> <p>Now, you can evaluate <span class="math-container" id="12434069" visual_id="7694258"><math alttext="E[\tau_{0}^{5}]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><msubsup><mi>τ</mi><mn>0</mn><mn>5</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow></semantics></math></span> conditioning at the first step.</p> <p><span class="math-container" id="12434070" visual_id="7694259"><math alttext="E[\tau_{0}^{5}]=\frac{E[\tau_{0}^{5}]}{2}+\frac{E[\tau_{1}^{5}]}{2}+1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><msubsup><mi>τ</mi><mn>0</mn><mn>5</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><msubsup><mi>τ</mi><mn>0</mn><mn>5</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow><mn>2</mn></mfrac><mo>+</mo><mfrac><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><msubsup><mi>τ</mi><mn>1</mn><mn>5</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow><mn>2</mn></mfrac><mo>+</mo><mn>1</mn></mrow></mrow></semantics></math></span></p> <p>Explaining the equation above. With probability <span class="math-container" id="12434071" visual_id="519"><math alttext="1/2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></semantics></math></span> you have a tail, so the time you will take to get five heads is the same, because you have any heads. On the other hand, with the same probability you get a head, and now, the number of flips needed to get 5 heads is <span class="math-container" id="12434072" visual_id="7694260"><math alttext="E[\tau_{1}^{5}]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><msubsup><mi>τ</mi><mn>1</mn><mn>5</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow></semantics></math></span>, because now you that you have one head. The +1 it is because you have to count the first step.</p> <p>Repeating the argument above you get</p> <p><span class="math-container" id="12434073" visual_id="7694261"><math alttext="E[\tau_{1}^{5}]=\frac{E[\tau_{0}^{5}]}{2}+\frac{E[\tau_{2}^{5}]}{2}+1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><msubsup><mi>τ</mi><mn>1</mn><mn>5</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><msubsup><mi>τ</mi><mn>0</mn><mn>5</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow><mn>2</mn></mfrac><mo>+</mo><mfrac><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><msubsup><mi>τ</mi><mn>2</mn><mn>5</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow><mn>2</mn></mfrac><mo>+</mo><mn>1</mn></mrow></mrow></semantics></math></span></p> <p>Proceeding this way, and remembering <span class="math-container" id="12434074" visual_id="7694262"><math alttext="E[\tau_{5}^{5}]=0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><msubsup><mi>τ</mi><mn>5</mn><mn>5</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></semantics></math></span>, you get </p> <p><span class="math-container" id="12434075" visual_id="7694263"><math alttext="E[\tau_{0}^{5}]=62" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>E</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><msubsup><mi>τ</mi><mn>0</mn><mn>5</mn></msubsup><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mn>62</mn></mrow></semantics></math></span></p> <p>This may seems more complicated at the first sight, but the idea of "to conditionate at what happens at the first time (or movement)" solve a big variety of problems.</p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
<tr><td comment_id="2719872"> Thanks for your alternative answer! I will take a look at it in detail tomorrow because it's very late. Any suggested readings on recursive techniques in probabilistic problems? </td></tr><tr><td comment_id="2719875"> Well, I see this kind of solution, usually, in problems involving Discrete Markov Chains. The Gambler's ruin, the first run of three sixes, the secretary problem are classical problems of the subject. </td></tr><tr><td comment_id="2719877"> Thanks, I'm aware of Markov Chains, will look more in depth. Have a great night! </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
<tr><td post_id="364038"> Expected Number of Coin Tosses to Get Five Consecutive Heads </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
