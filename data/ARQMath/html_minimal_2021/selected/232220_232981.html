<!DOCTYPE html>

<html>
<head>
<title>Optimizing response times of an ambulance corp: short-term versus average</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> Optimizing response times of an ambulance corp: short-term versus average </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="232220">
<p><strong>Background:</strong> I work for an Ambulance service. We are one of the largest ambulance services in the world. We have a dispatch system that will always send the closest ambulance to any emergency call. There is a belief that this results in the <em>fastest response time as an average across the system</em>.</p> <p><strong>Example:</strong> Suppose we have the following simplified scenario. We have 3 ambulances available (labelled A, B and C). At any given point in time, there is an random chance of an emergency call originating equally anywhere inside this box: <img alt="enter image description here" src="https://i.stack.imgur.com/KgQJ9.png"/></p> <p>If an emergency job appears (labelled 1), we will send the closest ambulance (in this case Ambulance C) <img alt="enter image description here" src="https://i.stack.imgur.com/hruel.png"/></p> <p>You will notice that Ambulances A and B are very close together on the left side of the box (lets pretend they are just leaving a hospital after dropping off their patients). There is now a large gap on the right. Suppose a small amount of time passes, and another emergency call drops in (labelled 2).</p> <p><img alt="enter image description here" src="https://i.stack.imgur.com/VNdsc.png"/></p> <p>Ambulance C is no longer available, so you must use Ambulance A or B. They have a significantly longer distance to travel to reach incident 2. In this case we have sent Ambulance A to the job.</p> <p><strong>Hypothesis:</strong> If you always send the closest ambulance to an emergency call, you will have the quickest response time to that specific call, but the overall average response time of the ambulance service is not optimised.</p> <p>Using that hypothesis - it would seem to be better to send Ambulance A or B to the original incident 1. This would mean the the next incident to happen, there will be "on average" a significantly shorter distance for the next ambulance to travel. <img alt="enter image description here" src="https://i.stack.imgur.com/TAAuv.png"/></p> <p><strong>Question:</strong> How can I "prove" this? Is there a mathematical theory or formula? This is obviously a simplifed scenario, there are some other issues - but I just need to prove the fundamental issue that the "closest ambulance being sent to the next incident" actually results in a non-optimal response time across the system as a whole.</p> <p>To answer some generic concerns:</p> <p><em>"Just move A to C's location after C goes on the job"</em> Yes - we already try to do this - however there is often another "incident" before A gets into the new position. And for other reasons <em>{which are beyond this question}</em> it is not always an option.</p> <p><em>"Why are A+B so close together? Perhaps B should be elsewhere?"</em> There are lots of reasons for ambulances to be 'clumped' together. The main reason is they have probably just offloaded a patient at a hospital - this often causes uneven dispersal of ambulances resources. Other reasons include the physical locations of our stations/depots.</p> <p><em>"Volume of work"</em> We are one of the largest ambulance services in the world. In my scenario I have 3 ambulances. In reality there are approx 100 ambulances, and we service approx 2000 "incidents" per day in our main metropolitan area. At some points in time we run at very high capacity - i.e. almost every ambulance is on an 'incident' - so applying a optimal response strategy across the system will have a significant impact to our response times.</p> <p><em>"Ethics of not sending closest ambulance"</em> Yes - this is not just a mathematical issue. But for the purpose of this Stack Exchange, please limit responses to a mathematical answer. In regards to ethics, I would suggest that if we can lower the "overall" response time (i.e. from 12mins to 10min average) - then "overall" we are ethically providing the best service. If we use a sub-optimal response, and "overall" we provide a slower response, then is not a bad ethical decision? Also - there would probably be exceptions to the rule (i.e. a heart attack or choking would ALWAYS get the closet ambulance - because seconds matter. But for this scenario lets not make it complicated)</p>
</div>
<hr/>
<div id="tags">
<span> optimization </span><span> problem-solving </span><span> mathematical-modeling </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
<tr><td comment_id="515481"> The problem I can see, is time.  If you know of both position 1 and 2 at the same time, then the best decision is to send C to 2 and A to 1.  However, unless you have precogniscient dolphins, you don't have this information.  The best decision you can make, with the information available, is that which you have in your 3rd diagram. </td></tr><tr><td comment_id="515483"> Sorry - to clarify - Position 1 occurs at a point in time, so we sent ambulance C. Position 2 occurs "later", so therefore ambulance C is not available. However given that there is an "equal random" chance of incident 2 occuring anywhere in the box, and ambulances A and B are to the "left" of the box, it would seem to be reasonable to conclude we are not optimising our response as a whole... </td></tr><tr><td comment_id="515484"> The strategy of always sending the closest ambulance is akin to using a greedy algorithm for solving optimization problems, as in trying to solve the traveling salesman problem by always going to the closest unvisited location. In general, not an optimal situation. </td></tr><tr><td comment_id="515485"> @TheShiftExchange the problem is that where events happen would be somewhat random, so you _cannot_ expect to have a strategy that _always_ optimises. What you can expect is a strategy that optimises in the long run (on average). But to actually prove whether a strategy is or is not optimal, we need to know about the typical distance traveled by an ambulance and the typical interval between incidences. If on average events happen infrequently enough then no strategy can beat the "closest responder" one. </td></tr><tr><td comment_id="515486"> @HaraldHanche-Olsen - thanks - that is VERY interesting and I will look into it alot further... </td></tr><tr><td comment_id="515487"> There is, however, one problem with *not* sending the closest ambulance: If the person dies, and it is plausible that sending the closest ambulance could have saved a life, you're open to lawsuits. It will be very difficult to defend against that by referring to hypothetical other patients that might have needed that ambulance. Especially when hindsight reveals there was no such patient. </td></tr><tr><td comment_id="515489"> @HaraldHanche-Olsen - yes, as I mentioned this is just a simplified theory. There are other factors at play, as you suggest. However I would also suggest the opposite is true: if we take a "very long" time to respond, BECAUSE no ambulance was closely available (because we were poorly optimised) - then we are also open to a lawsuit :) </td></tr><tr><td comment_id="515494"> @Willie wong - I dont neccessarily need to "always" optimise. In my scenario, it is simplified, but in the real life there is enough high frequency that I believe the "closet responder" is not optimal. </td></tr><tr><td comment_id="515497"> This kind of problem is known as an online job scheduling problem in the unrelated machines model, where the jobs are emergency calls and the machines are ambulances. You'll probably want to cross-post this to the theoretical computer science stack exchange. </td></tr><tr><td comment_id="515498"> It would probably be useful to gather statistics on the relative frequency of emergency calls that occur in different areas of your 'box'.  Given this information, it would be easier to approximate an optimal solution (for whatever meaning of 'optimal' you decide to use). </td></tr><tr><td comment_id="515501"> I think you would need statistics to answer this satisfactorily. Barring major disasters, the need for ambulances is probably a bit like radioactive decay: Isolated, independent incidents that can be treated with statistical methods. So if you know the statistics of the need for ambulances as a function of space and time, you should be able to get a handle on creating a good strategy. Without it, all we can say is that sending the closest is *not necessarily* optimal. </td></tr><tr><td comment_id="515506"> On a side note, in your scenario it might make sense to send A across to the right as soon as C goes out on its call, in order to lower the maximal waiting time for a new emergency. But this sort of consideration will of course complicate the issue further â€¦ </td></tr><tr><td comment_id="515509"> @HaraldHanche-Olsen - yes - we already do this - its known as "fluid deployment". But if the "time" between incidents is low enough (and it often is) - then A never reaches C's location - and thus we often still get the long distance. For the sake of the scenario I left it out to keep it simple to start with :) </td></tr><tr><td comment_id="515712"> You may want to drop an email to the University of Auckland engineering science department http://www.des.auckland.ac.nz/uoa/home/about/ourdepartment/contact-us - while I was there in 2000 Prof. Andrew Mason had already been studying optimization for ambulance scheduling for some time and I believe it is still one of his research areas. </td></tr><tr><td comment_id="515770"> I think the real problem here is that A and B were close together at the start. </td></tr><tr><td comment_id="515854"> This is a traditional GIS question. I might try asking on the [GIS Stack Exchange Site](http://gis.stackexchange.com/). </td></tr><tr><td comment_id="515919"> @LorenPechtel - yes - I've added a FAQ - please see an answer there </td></tr><tr><td comment_id="515920"> @DavidHall - thanks - will do that. </td></tr><tr><td comment_id="515922"> @sixtyfootersdude - thanks - I'll look into it. </td></tr><tr><td comment_id="515990"> I did not have a chance to read all what has been posted here but in your final algorithm you must consider the density of trafic at a given time of day in addition to the physical distance. This is accounted for already with tire trucks dispatching systems in some USA cities already. The second point is that you need to take in consideration how critical is the call. Serving a critical call may outweigh balancing the average. </td></tr><tr><td comment_id="515994"> @EmmadKareem - yes, "how critical is the call" will be a factor, but for the purpose of this question I'm happy to ignore it to try and get a basic proof first. </td></tr><tr><td comment_id="516336"> Perhaps I'm missing something, but is it not possible to reassign an ambulance once it's been dispatched?  In your example, once you receive the information about 2, what prevents you from reassigning C from 1 to 2, and assigning A to 1? </td></tr><tr><td comment_id="516396"> One thing that I haven't seen addressed--take any prospective algorithm and play it against as much real world historical data as you have and see what you get.  The debate here about which ambulance to send--walk through every minute of your data and see what produces the lowest total response time.  Given what you have said about load levels I would be very surprised if send the nearest isn't the best answer (with the provisio that you recompute nearest whenever a new call is added.) </td></tr><tr><td comment_id="516553"> Closest unit responds. Apart from this, divide units in (at least 2 level) response hierarchy. And also get a real time _heat map_ of area. The first level is positioned to provide even coverage across area. The next level's coverage is _more_ concentrated on _hotter_ areas. And so on for higher levels. Each level units always move to match required distribution each time a unit goes busy or becomes free. Now the fine tuning is how you divide units into the response hierarchy. </td></tr><tr><td comment_id="516557"> @KevinK - the assumption is the "C" has already arrived at the incident, so therefore is unable to be reassigned once it has arrived. You are correct in saying that if C had not already reached the destination, then the reallocation of the incidents would probably be most optimal </td></tr><tr><td comment_id="516659"> Your approach is incomplete. You should add real life constraints (traffic density, roads layout, red lights, bridges...). In real life situations some areas cost more to traverse than others, you have to take into account the QoS of the entire intervention from current point to delivery. There is also the context. Some contexts require different approaches. St. Patricks night will leave no spare resources and will require a different response scenario from other contexts. You have to think about multiple contexts and find what intervention process is most adapted to each. </td></tr><tr><td comment_id="516793"> First of all, **have you confirmed that the "average time" is the right measure to be optimized**? There are model fitting use cases where the "average of squares" is more useful, for example. You know, it might not help if 10 patients are served a little bit quicker but one patient is served way too late. When you use the average of time, you implicitly presume that the "usefulness" of an ambulance to an individual patient is linear to the time it takes to arrive. Though I'm not a physicist I imagine that the curve of emergency/risk of death is not linear over the time of arrival. </td></tr><tr><td comment_id="516797"> One more thing to add: If it turns out, e.g., that danger of death increases very rapidly after a certain amount of time not being served, you may even want to set an upper limit to the time being served. That shifts this issue into the domain of "constraint optimization problems": You optimize the average of any kind of function over time, while making sure that not a single patient takes more than a certain limit to be served. </td></tr><tr><td comment_id="517003"> Your problem is closely related to what is called the <span class="math-container" id="2595813" visual_id="83"><math alttext="k" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi></semantics></math></span>-server problem.  That problem is studied from a worst-case point of view in theoretical computer science, using what's called competitive analysis.  (The <span class="math-container" id="2595813" visual_id="83"><math alttext="k" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi></semantics></math></span>-server problem would be your problem with <span class="math-container" id="2595813" visual_id="83"><math alttext="k" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi></semantics></math></span> ambulances and a constraint that ambulances can't be repositioned after going to a call until they go to their next call.)  [http://en.wikipedia.org/wiki/K-server_problem](http://en.wikipedia.org/wiki/K-server_problem) </td></tr><tr><td comment_id="517330"> There are a lot of factors that could determine the best real-world algorithm, but for the mathematical problem you pose, the gain of the "dispatch A" algorithm you propose is illusory: You incur up-front the exact cost that you _hope_ to avoid on the next dispatch. You never gain and you might lose, so it is slower _on average_ than dispatching the closest car. (See my answer for details). </td></tr><tr><td comment_id="518055"> I know this is supposed to be a somewhat general case, but are you actually designing such an algorithm for the real case? In this instance, I wonder will you be taking into account the computed time it will take for each ambulance to get there based on the road infrastructure? I am just curious to know if emergency response services are taking full advantage of today's ability to make such realtime calculations... </td></tr><tr><td comment_id="520513"> I am pretty sure that even in a simplified problem in which you take away all probabilistic considerations by simply being given in advance all the future calls - The problem is NP-Complete, I.E. there would be no fast algorithm to find the optimal solution, assuming you have many ambulances and many calls. (Any algorithm would take exponential running time in the number of ambulances and the number of future calls - For example if you had 100 ambulances and 100 calls, the running time to find the BEST solution would be around 2^100 - too long to work out) </td></tr><tr><td comment_id="520515"> This still leaves the open question how well the greedy algorithm fares, as compared to other proposed algorithms. Acknowledging the fact the problem is NP-Complete might help change the discussions here as to what approximation ratios of the best solution different algorithms achieve... </td></tr><tr><td comment_id="523735"> Only one tip. When you decrease response time, more patients will be delivered to hospital at the same time. It can create unpredictable problem and you should take care of it also. </td></tr><tr><td comment_id="949682"> have you done a map of the simple probabilities for each position relative to favorable outcome?  are the bad outcome positions found mostly near clusters? </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="232981" id="answer">
<p>It seems your (mathematical) intuition is wrong, at least under the constraints you specified. Let's firm them up as follows:</p> <ol> <li><p>The goal is to optimize the average time it takes to reach an incident. </p></li> <li><p>The starting locations of the ambulances are fixed. The question is what order to dispatch them in.</p></li> <li><p>Once an ambulance is dispatched, it is permanently unavailable: It cannot serve other incidents during the same trip, or return to service before the end of the calculation. </p></li> </ol> <p>Note that after the second ambulance is dispatched, there is only one ambulance left, and it no longer matters where, timewise: There's a 50% chance that the third incident will be in the opposite side of the map. So, the question is: <strong>Starting with the 2 : 1 configuration you present, which dispatch strategy will result in the quickest response, <em>on average,</em> over the first two incidents?</strong> </p> <p>The result can be generalized to larger sizes, but the two-incident case is instructive. The answer will surprise you: The nearest-ambulance strategy is better!</p> <pre><code>A, B ----------------------'---------------------- C </code></pre> <p>Let's draw a line from A/B to C, and label it as the interval [0, 1]. An incident is a uniformly distributed random variable <em>t</em> in this interval. We can equate response time to distance: If there are ambulances on both sides, the response time to an incident at point <em>t</em> is <em>min(t, 1-t)</em>. If ambulance A must be dispatched, the response time is simply <em>t</em>. </p> <p>The expected value of <em>t</em>, <em>E(t)</em>, is 0.5. Obviously <em>t</em> is closer to the left if <em>t &lt; 0.5</em>. It's easiest to consider scenarios by grouping incidents into two random events: Let's call an event <em>L</em> if <em>t</em> is in the left half of the range (<em>t &lt; 0.5</em>), and <em>R</em> if it is in the right half. Then R and L occur with probability 0.5 each. </p> <p>There can be four two-incident patterns, occurring with equal probability (0.25): LL, LR, RL, RR. If you could always dispatch from the closest side, the expected travel is 0.25 per incident. You incur a cost when you have to dispatch from the wrong side of the map. The expected length of a "long" trip is 0.75.</p> <p>So, the payoff matrix is:</p> <pre><code>incidents   dispatch closest   dispatch A  L L            A, B             A, B  L R            A, C             A, C  R L            C, A             A*, B  R R            C, A*            A*, C </code></pre> <p>The right column is your proposed strategy: dispatch A first, then whichever is closest. A star means that the ambulance had to make a long trip (from the wrong side of the map) to get there. Note that there are more stars (penalties) on the right column.</p> <p>The fourth row in the table is the one you're worried about: What if there's another incident on the right side of the map, after you've dispatched C? The answer is, don't worry! The bottom row has exactly the same cost under the two strategies: When you dispatched A to the first incident, you already incurred the cost you were trying to avoid in the second incident.</p> <p>But the third case is one you didn't factor in: What if you send A on a long trip, and then C is not needed after all? In this case, dispatch-A will take <em>longer</em> than the dispatch-closest algorithm. </p> <p><strong>Since dispatch-A is not better under any scenario, dispatch-closest is superior on average.</strong></p> <p><strong>Informal summary:</strong> If C is closer but you dispatch A, as you propose, you incur a penalty equal to the benefit you will reap <em>if</em> the next incident is nearer to C. So you would break even at best. But the next incident might be closer to A, and you'll never get to collect on your investment. Conclusion: Dispatching the closest ambulance is the better strategy. You can only do better by improving the distribution of ambulances <em>before</em> the second call comes in, as various others suggested. Once the phone rings, sending the closest car is in fact globally optimal.</p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
<tr><td comment_id="517505"> Thanks alexis - I'm just as "open" to proving that dispatch-closet is the correct answer. The whole point of this question is proving something, one way or the other - because at the moment it is only done this way because we "think" it is best - I want proof :) </td></tr><tr><td comment_id="517587"> @Alexis. Yes, for the *first two* incidents sending the nearest car gives better average. However, for the three incidents it gets worse. If the third incident doesn't occur, then the strategy I proposed is inferior, but if it occurs, it is superior. Funny, isn't it? That's why I said "sometimes" in my conclusion. And no, there is no mistake in my computations; just the assumptions are different (3 incidents instead of two for 3 vehicles). </td></tr><tr><td comment_id="518146"> @fedja, thanks for checking but I don't think that's right. Once two vehicles are gone, the situation is completely symmetric: It doesn't matter where the last vehicle is, there's a 50% probability that the third incident will be near it. So there's no way for one strategy to perform better than the other in the third step. </td></tr><tr><td comment_id="518154"> @ShiftExchange, thanks. I'm confident my proof is correct, but I could be deluded of course. Let me know if you have any concerns. And feel free to upvote my answer so that more people can find it and weigh in. (Congrats for having such a hit as your first question, by the way :-) </td></tr><tr><td comment_id="518250"> Yeah, you are right about the third step. This means you are wrong about the first two. Note that after the first step, if you are left with 1-1, you have a great advantage over being left with 2-0 (1/4 against 1/2 for the expected distance on the second call). That's what I exploited when saying that it is beneficial to send the A-vehicle a bit further. I'll have to go over your argument carefully to see where the mistake is... </td></tr><tr><td comment_id="518254"> Ah, found it! You just erroneously think that the strategy must decide which vehicle to send depending only on whether <span class="math-container" id="2595889" visual_id="470794"><math alttext="x&lt;1/2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>&lt;</mo><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></mrow></semantics></math></span> or <span class="math-container" id="2595890" visual_id="253044"><math alttext="x&gt;1/2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>&gt;</mo><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></mrow></semantics></math></span>. Of course, in the class of such restricted strategies the one that uses the nearest vehicle is optimal. However, notice that my cutoff point is <span class="math-container" id="2595891" visual_id="54911"><math alttext="5/8" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>/</mo><mn>8</mn></mrow></semantics></math></span>, so the strategy I cited as optimal is not in your class... </td></tr><tr><td comment_id="518317"> @fedja: Re your first comment, the "big advantage" of being left with 1-1 is exactly equal to the cost of sending out A instead of C. At best, you recoup your investment. Re the second, you're right that I address the limited case of splitting at 1/2. But I've done the calculation for the general case, and will add it to my answer as soon as I can. (Preview: I got the same result). </td></tr><tr><td comment_id="518359"> Alexis, the cost of sending <span class="math-container" id="2595892" visual_id="188"><math alttext="A" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi></semantics></math></span> instead of <span class="math-container" id="2595893" visual_id="599"><math alttext="B" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi></semantics></math></span> is small if you do it only when the distances are sufficiently close. The gain however is fixed. Just do your calculations for the particular strategy I offered. Then you'll convince me :). </td></tr><tr><td comment_id="518397"> Will do. I certainly don't expect to convince you without a full analysis! :-) </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
