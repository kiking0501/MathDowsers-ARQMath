<!DOCTYPE html>

<html>
<head>
<title>Probability that after 10,000 steps (+-1) you'll end up at the origin. How to use Central Limit Theorem?</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> Probability that after 10,000 steps (+-1) you'll end up at the origin. How to use Central Limit Theorem? </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="1342654">
<p>Starting at the origin and taking one step left or right with equal probability, what is the probability that you'll end up at 0 after 10,000 steps?</p> <p>I figured it'd be <span class="math-container" id="12479630" visual_id="1816016"><math alttext="\frac{1}{2^{10000}}\binom{10000}{5000}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><msup><mn>2</mn><mn>10000</mn></msup></mfrac><mo>⁢</mo><mrow><mo>(</mo><mfrac linethickness="0pt"><mn>10000</mn><mn>5000</mn></mfrac><mo>)</mo></mrow></mrow></semantics></math></span> since you will be taking half of the steps in one direction and half in the other in no particular order and then divide the number of all possible paths that land you at 0 by the total possible number of paths.</p> <p>I got probability of about 0.008.</p> <blockquote> <p>But how do I get this result using central limit theorem?</p> </blockquote>
</div>
<hr/>
<div id="tags">
<span> probability </span><span> random-walk </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
<tr><td comment_id="2732434"> The correct calculation is that for even <span class="math-container" id="12479771" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span>, <span class="math-container" id="12479632" visual_id="1816017"><math alttext="C(n,n/2)/2^{n}\sim\sqrt{\dfrac{2}{n\pi}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mi>C</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo>,</mo><mrow><mi>n</mi><mo>/</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>/</mo><msup><mn>2</mn><mi>n</mi></msup></mrow><mo>∼</mo><msqrt><mstyle displaystyle="true"><mfrac><mn>2</mn><mrow><mi>n</mi><mo>⁢</mo><mi>π</mi></mrow></mfrac></mstyle></msqrt></mrow></semantics></math></span> using Stirling's approximation.  As Did notes, this is **not** using central limit theorem. </td></tr><tr><td comment_id="2732439"> On the other hand, you **could** use the de Moivre-Laplace theorem (e.g. in the form Wikipedia gives). </td></tr><tr><td comment_id="2732783"> @Robert Israel I was just typing a comment about de Moivre-Laplace when I noticed yours.  You'll also notice where that Wikipedia article says it's a **special case of CLT**.  So contrary to what Did says, we can use CLT to get the information requested in this problem. </td></tr><tr><td comment_id="2732916"> No, that's muddled.  There is a weak version of de Moivre-Laplace that is a special case of CLT.  The strong version of de Moivre-Laplace, that talks about the probability mass function rather than the cumulative distribution, is what we can use here. </td></tr><tr><td comment_id="2734185"> @Robert Israel The cumulative form is what I used, and it's called the De Moivre-Laplace limit theorem.  It's based on an approximation theorem that is a special case of CLT according to Feller III.3 and used as a binomial approximation in VII.3 despite having the same issue Did raised about constant deviation.  The DM-L from wiki based on the mass function is a special case of the lattice form of CLT as shown by Papoulis 8-5.  I understand you to agree than at least one of these binomial approximations is a special case of CLT in contradiction to Did. </td></tr><tr><td comment_id="2734577"> There is no disagreement between me and Did on this. </td></tr><tr><td comment_id="2737564"> @Robert Israel  So you disagree with Feller.  He says the "main application" of the  DeMoivre-Laplace limit theorem (with cdfs exactly as I used) is to obtain approximations to the binomial  (VII.3), and in X.I he states that the CLT "generalizes the DeMoivre-Laplace limit theorem for Bernoulli trials" (which is obvious).  Did says binomial approximations "do not follow from the direct statement of the CLT".  His objection that it says nothing about <span class="math-container" id="12479683" visual_id="116914"><math alttext="(a_{n},b_{n})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mi>n</mi></msub><mo>,</mo><msub><mi>b</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></semantics></math></span> decreasing as <span class="math-container" id="12479693" visual_id="112918"><math alttext="1/\sqrt{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>/</mo><msqrt><mi>n</mi></msqrt></mrow></semantics></math></span> would apply directly to that theorem too (z1,z2).  Please confirm you disagree with Feller or explain. </td></tr><tr><td comment_id="2737727"> There is no disagreement between me and Feller either.  There are two different de Moivre-Laplace theorems.  There is one for the probability mass function; that is what we use here.  There is another for the cumulative distribution function: that is what the CLT generalizes. </td></tr><tr><td comment_id="2738267"> @Robert Israel (Note correction from earlier comment) Yes I know there are 2. In Feller, the one with cumulative distribution that is generalized by  CLT subtracts 2 values of the cumulative distribution to approximate binomial probabilities between 2 numbers. **That is always more accurate for the central term than the one you are suggesting with the mass function for n = 2 to 1 MILLION** (everything I checked). Why do you say we shouldn't use it? The 2 you suggest are identical for this, and the mass one is a special case of lattice CLT as shown by Papoulis. </td></tr><tr><td comment_id="2738274"> @BruceZ: an experiment is not a proof. You cannot (in general) recover the probability of being at a given point form the CLT, although in some cases it works well numerically. Feller deduces the CDF version (i.e. the CLT applied to Rademacher r.v.) from the pointwise version, not the other way. </td></tr><tr><td comment_id="2738404"> @D. Thomine  The CLT implies the CDF version.  If you say you can't deduce it from CLT, then you're saying you can't deduce it from the CDF version.  What does it matter how Feller deduced CDF version.  Now that we have CLT, we have the CDF version. </td></tr><tr><td comment_id="2738412"> @BruceZ: The CDF version tells you nothing about the probability of being at any given point. </td></tr><tr><td comment_id="2738462"> @D. Thomine If we use it to approximate the central term of the binomial, then it tells us probability of being at 0.  You say you can't get it from that, but I just did.  What is it just a huge coincidence that every single value of N gives us that probability more accurately than the pointwise version that you favor?   And anyway, that pointwise version also comes from CLT by simply inserting the binomial mass function into the sampled version of the normal pdf as Papoulis does. </td></tr><tr><td comment_id="2738767"> @D. Thomine  I have added more detail to both answers.  For those who keep voting up comments saying that you can't approximate the probability of being at 0 from the CDF version which is generalized by CLT, then please look at the examples in Feller in VII.4 and elsewhere and explain why what he's doing there is any different than what appears in my first answer. </td></tr><tr><td comment_id="2738868"> @BruceZ: I don't say that you can never approximate the probability of being in <span class="math-container" id="12479758" visual_id="92"><math alttext="0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn></semantics></math></span> by the distribution function. I say that we need additional assumptions (Bernoulli, or some aperiodicity as in my answer) and use something stronger than the CLT (e.g. Feller, VII.3, Theorem 1), so it is *not* generalized by the CLT. Your answer suggest that it is a consequence of the CLT, which is false. </td></tr><tr><td comment_id="2738917"> @D. Thomine We have Bernoulli trials.  CLT "generalizes the DeMoivre-Laplace limit theorem for Bernoulli trials" as Feller says in X.1 right before he introduces the CLT.  That means it follows from CLT.  All we're doing is subtracting 2 probabilities that come from the cdf.  CLT says they each converge, so the difference must converge.  It's no different from his first 2 examples in VII.3 with the coin flips. </td></tr><tr><td comment_id="2738948"> Let us [continue this discussion in chat](http://chat.stackexchange.com/rooms/25460/discussion-between-d-thomine-and-brucez). </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="1342696" id="answer">
<p>We shall consider Bernoulli random variables <span class="math-container" id="12479636" visual_id="377"><math alttext="X_{i}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub></semantics></math></span> that take on the value <span class="math-container" id="12479637" visual_id="342"><math alttext="1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn></semantics></math></span> with probability 1/2 corresponding to a step to the right at step i, and the value <span class="math-container" id="12479638" visual_id="92"><math alttext="0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn></semantics></math></span> with probability 1/2 corresponding to a step to the left at step i.  Define</p> <p><span class="math-container" id="12479639" visual_id="1816018"><math alttext="Y=\sum_{i=1}^{1000}X_{i}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>Y</mi><mo>=</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>1000</mn></msubsup><msub><mi>X</mi><mi>i</mi></msub></mrow></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>We wish to approximate </p> <p><span class="math-container" id="12479640" visual_id="1816019"><math alttext="P(Y=5000)={10000\choose 5000}\frac{1}{2^{10000}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><mi>Y</mi><mo>=</mo><mn>5000</mn><mo stretchy="false">)</mo></mrow><mo>=</mo><mrow><mo>(</mo><mfrac linethickness="0pt"><mn>10000</mn><mn>5000</mn></mfrac><mo>)</mo></mrow><mfrac><mn>1</mn><msup><mn>2</mn><mn>10000</mn></msup></mfrac></mrow></semantics></math></span></p> <p>the probability that we end up at <span class="math-container" id="12479641" visual_id="92"><math alttext="0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn></semantics></math></span> after 10000 steps.  We shall use the  DeMoivre-Laplace limit theorem (Feller <span class="math-container" id="12479642" visual_id="1816020"><math alttext="VII.3" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mn>.3</mn></mrow></semantics></math></span> <span class="math-container" id="12479643" visual_id="354999"><math alttext="3.16" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3.16</mn></semantics></math></span>) which is generalized by the central limit theorem (Feller <span class="math-container" id="12479644" visual_id="1816021"><math alttext="X.1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>⁢</mo><mn>.1</mn></mrow></semantics></math></span>) to approximate this central  binomial probability as</p> <p><span class="math-container" id="12479645" visual_id="1816022"><math alttext="P(Y=5000)=P\left(-0.5\leq\frac{Y-5000}{\sqrt{2500}}\leq 0.5\right)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><mi>Y</mi><mo>=</mo><mn>5000</mn><mo stretchy="false">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo>(</mo><mo>-</mo><mn>0.5</mn><mo>≤</mo><mfrac><mrow><mi>Y</mi><mo>-</mo><mn>5000</mn></mrow><msqrt><mn>2500</mn></msqrt></mfrac><mo>≤</mo><mn>0.5</mn><mo>)</mo></mrow></mrow></semantics></math></span></p> <p><span class="math-container" id="12479646" visual_id="1816023"><math alttext="\approx\Phi(0.5/\sqrt{2500})-\Phi(-0.5/\sqrt{2500})\approx 0.00797871" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi></mi><mo>≈</mo><mrow><mrow><mi mathvariant="normal">Φ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mn>0.5</mn><mo>/</mo><msqrt><mn>2500</mn></msqrt></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>-</mo><mrow><mi mathvariant="normal">Φ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mrow><mn>0.5</mn><mo>/</mo><msqrt><mn>2500</mn></msqrt></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>≈</mo><mn>0.00797871</mn></mrow></semantics></math></span></p> <p>where <span class="math-container" id="12479647" visual_id="31654"><math alttext="\Phi(x)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Φ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> is the cumulative standard normal distribution.  The 2500 came from the variance of the binomial distribution npq where n = 10000, p=q=1/2.  We are in effect approximating the binomial distribution of Y with mean np and variance npq with a normal distribution of the same mean and variance.  Then we are normalizing Y so that we may use the standard cumulative normal distribution.  The factors of +/- 0.5 come about not from CLT, but from the fact that we are approximating the discrete binomial distribution with a continuous normal distribution.  This is done such that the interval between -0.5 and +0.5 on the normal will correspond naturally to <span class="math-container" id="12479648" visual_id="92"><math alttext="0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn></semantics></math></span> on the binomial.</p> <p>Compare this numerical result to the exact answer which to 8 decimal places is 0.00797865.  This is slightly more accurate than the result of the DeMoivre-Laplace theorem based on the mass function used in my other answer as well as the answer of <a href="https://math.stackexchange.com/a/1346879/244722">D. Thomine</a> which gives 0.00797885.  In fact, we may verify that for even n from 2 to several billion, the method in this answer is more accurate than that one, with the biggest differences coming at small n.  By performing series expansions, one can verify that this will be the case for all even n.</p> <p>Note that some sources refer to this as the DeMoivre-Laplace central limit theorem.  </p> <p>Now an objection has been raised that says we can't use CLT to approximate this probability.  Approximating a probability by CLT means that we identify a probability which CLT says will converge as <span class="math-container" id="12479649" visual_id="1477"><math alttext="n\rightarrow\infty" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></semantics></math></span>, and then we approximate it for some finite n by the value CLT gives as the limit.  The approximation will be good to the extent that the probability has converged by that value of n.  It is also possible to bound the error with something like the Berry-Esseen theorem if desired, and for Bernoulli random variables, the error decreases ~<span class="math-container" id="12479650" visual_id="112918"><math alttext="1/\sqrt{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>/</mo><msqrt><mi>n</mi></msqrt></mrow></semantics></math></span>.</p> <p>For our case, CLT takes the form of the DeMoivre-Laplace limit theorem for Bernoulli random variable which states</p> <p><span class="math-container" id="12479651" visual_id="1816024"><math alttext="P\left(a\sqrt{npq}\leq Y_{n}-np\leq b\sqrt{npq}\right)\rightarrow\Phi(b)-\Phi(a)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo>(</mo><mi>a</mi><msqrt><mrow><mi>n</mi><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mi>q</mi></mrow></msqrt><mo>≤</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>-</mo><mi>n</mi><mi>p</mi><mo>≤</mo><mi>b</mi><msqrt><mrow><mi>n</mi><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mi>q</mi></mrow></msqrt><mo>)</mo></mrow><mo>→</mo><mi mathvariant="normal">Φ</mi><mrow><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><mo>-</mo><mi mathvariant="normal">Φ</mi><mrow><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span></p> <p>with </p> <p><span class="math-container" id="12479652" visual_id="24600"><math alttext="Y_{n}=\sum_{i=1}^{n}X_{i}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>n</mi></msub><mo>=</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>X</mi><mi>i</mi></msub></mrow></mrow></semantics></math></span></p> <p>and <span class="math-container" id="12479653" visual_id="37366"><math alttext="p=q=1/2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi>q</mi><mo>=</mo><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></mrow></semantics></math></span>.  Now the objection concerns the fact that a and b must be constants so that the interval grows as <span class="math-container" id="12479654" visual_id="7664"><math alttext="\sqrt{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><mi>n</mi></msqrt></semantics></math></span>.  We are in fact setting a and b to constants, specifically <span class="math-container" id="12479655" visual_id="1816025"><math alttext="a=-0.5/\sqrt{2500}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mrow><mo>-</mo><mrow><mn>0.5</mn><mo>/</mo><msqrt><mn>2500</mn></msqrt></mrow></mrow></mrow></semantics></math></span>, and <span class="math-container" id="12479656" visual_id="1816026"><math alttext="b=+0.5/\sqrt{2500}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mrow><mo>+</mo><mrow><mn>0.5</mn><mo>/</mo><msqrt><mn>2500</mn></msqrt></mrow></mrow></mrow></semantics></math></span>, not <span class="math-container" id="12479657" visual_id="1816027"><math alttext="\pm 0.5/\sqrt{npq}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>±</mo><mrow><mn>0.5</mn><mo>/</mo><msqrt><mrow><mi>n</mi><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mi>q</mi></mrow></msqrt></mrow></mrow></semantics></math></span>.  CLT then says that the probability that the walker is within <span class="math-container" id="12479658" visual_id="1816028"><math alttext="0.5/\sqrt{2500}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.5</mn><mo>/</mo><msqrt><mn>2500</mn></msqrt></mrow></semantics></math></span> standard deviations of <span class="math-container" id="12479659" visual_id="92"><math alttext="0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn></semantics></math></span> converges as the RHS above. The question asked about that probability for <span class="math-container" id="12479660" visual_id="21113"><math alttext="n=10000" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>10000</mn></mrow></semantics></math></span>.  We are using CLT to approximate that probability, and the approximation will be as good as the convergence of that probability by <span class="math-container" id="12479661" visual_id="21113"><math alttext="n=10000" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>10000</mn></mrow></semantics></math></span>.  But note that this probability does NOT correspond to the probability that the walker will be at <span class="math-container" id="12479662" visual_id="92"><math alttext="0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn></semantics></math></span>, that is  <span class="math-container" id="12479663" visual_id="1816029"><math alttext="P(Y_{n}=np)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>=</mo><mi>n</mi><mi>p</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>, for all n. It only coincides with that probability for n around 10000. But that's OK because we weren't asked to provide <span class="math-container" id="12479664" visual_id="1816029"><math alttext="P(Y_{n}=np)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>=</mo><mi>n</mi><mi>p</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> and show it converges by CLT. We were asked to approximate <span class="math-container" id="12479665" visual_id="342"><math alttext="1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn></semantics></math></span> probability using CLT in some way as defined above.  The objection is concerned about <span class="math-container" id="12479666" visual_id="1816029"><math alttext="P(Y_{n}=np)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>=</mo><mi>n</mi><mi>p</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> on an interval which does not grow as <span class="math-container" id="12479667" visual_id="7664"><math alttext="\sqrt{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><mi>n</mi></msqrt></semantics></math></span> as CLT requires. We are concerned with <span class="math-container" id="12479668" visual_id="1816030"><math alttext="P(|Y_{n}|&amp;lt;0.5/\sqrt{2500})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">|</mo></mrow><mo>&lt;</mo></mrow><mrow><mn>0.5</mn><mo>/</mo><msqrt><mn>2500</mn></msqrt></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> on an interval which does grow as <span class="math-container" id="12479669" visual_id="7664"><math alttext="\sqrt{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><mi>n</mi></msqrt></semantics></math></span> as CLT requires.</p> <p>Now if  we were to use this method for general n, always making a and b <span class="math-container" id="12479670" visual_id="1816027"><math alttext="\pm 0.5/\sqrt{npq}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>±</mo><mrow><mn>0.5</mn><mo>/</mo><msqrt><mrow><mi>n</mi><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mi>q</mi></mrow></msqrt></mrow></mrow></semantics></math></span>, then we could not show convergence of our probabilities <span class="math-container" id="12479671" visual_id="1816031"><math alttext="P(|Y_{n}|&amp;lt;0.5/\sqrt{npq})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><msub><mi>Y</mi><mi>n</mi></msub><mo stretchy="false">|</mo></mrow><mo>&lt;</mo></mrow><mrow><mn>0.5</mn><mo>/</mo><msqrt><mrow><mi>n</mi><mo>⁢</mo><mi>p</mi><mo>⁢</mo><mi>q</mi></mrow></msqrt></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> as <span class="math-container" id="12479672" visual_id="1477"><math alttext="n\rightarrow\infty" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></semantics></math></span> using the standard version of CLT above which requires that a and b be constants.  However, we could still show convergence of these probabilities because we could apply a theorem (Feller VII.<span class="math-container" id="12479673" visual_id="305"><math alttext="3" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3</mn></semantics></math></span> theorem 1) which allows us to relax this constraint for Bernoulli random variables so that a and b may be decreasing functions of n which go as ~<span class="math-container" id="12479674" visual_id="112918"><math alttext="1/\sqrt{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>/</mo><msqrt><mi>n</mi></msqrt></mrow></semantics></math></span> as we would require.  </p> <p>Specifically, D. Thomine has objected that the above method is "false as it stands, because if a and b are too small, then you need in general very large values of n before [convergence]. In particular, you cannot take a,b ~<span class="math-container" id="12479675" visual_id="112918"><math alttext="1/\sqrt{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>/</mo><msqrt><mi>n</mi></msqrt></mrow></semantics></math></span>." We have seen that this is false due to the fact that we have Bernoulli random variables and can apply a special theorem that guarantees convergence. It has also been shown false by direct calculation demonstrating that it converges faster and better than the D. Thomine approximation method based on the mass function for all even values of n starting with 2 and continuing into the billions. Series expansions for the approximations in question as well as for the binomial have been derived which, barring errors, shows that the above method gives a value closer to the exact binomial value for all even values of n, in agreement with all calculations to date.</p> <p>So in summary, we need not show convergence of our approximation method for <span class="math-container" id="12479676" visual_id="1816029"><math alttext="P(Y_{n}=np)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>=</mo><mi>n</mi><mi>p</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>, and we cannot show it with the CLT above.  However,this approximation method does produce values of <span class="math-container" id="12479677" visual_id="1816029"><math alttext="P(Y_{n}=np)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>n</mi></msub><mo>=</mo><mi>n</mi><mi>p</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> which converge,and this can be shown with a theorem that applies specifically to Bernoulli random variables which is routinely used in conjunction with the DeMoivre-Laplace limit theorem for Bernoulli random variables (see examples in Feller VII.4).</p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
<tr><td comment_id="2729682"> This was already mentioned à propos another answer, now deleted, but here we go again: **CLT cannot yield this kind of information**. What CLT says is that <span class="math-container" id="12479678" visual_id="1816032"><math alttext="P(a\sqrt{n}\leqslant S_{n}\leqslant b\sqrt{n})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>a</mi><mo>⁢</mo><msqrt><mi>n</mi></msqrt><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\leqslant</mtext></merror><mo>⁢</mo><msub><mi>S</mi><mi>n</mi></msub><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\leqslant</mtext></merror><mo>⁢</mo><mi>b</mi><mo>⁢</mo><msqrt><mi>n</mi></msqrt></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> converges when <span class="math-container" id="12479689" visual_id="1477"><math alttext="n\to\infty" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></semantics></math></span>, for every <span class="math-container" id="12479680" visual_id="2239"><math alttext="(a,b)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></semantics></math></span> fixed, but it says nothing about the asymptotics of <span class="math-container" id="12479681" visual_id="1816033"><math alttext="P(a_{n}\sqrt{n}\leqslant S_{n}\leqslant b_{n}\sqrt{n})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>⁢</mo><msqrt><mi>n</mi></msqrt><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\leqslant</mtext></merror><mo>⁢</mo><msub><mi>S</mi><mi>n</mi></msub><mo>⁢</mo><merror class="ltx_ERROR undefined undefined"><mtext>\leqslant</mtext></merror><mo>⁢</mo><msub><mi>b</mi><mi>n</mi></msub><mo>⁢</mo><msqrt><mi>n</mi></msqrt></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> when <span class="math-container" id="12479689" visual_id="1477"><math alttext="n\to\infty" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></semantics></math></span>, for <span class="math-container" id="12479683" visual_id="116914"><math alttext="(a_{n},b_{n})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mi>n</mi></msub><mo>,</mo><msub><mi>b</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></semantics></math></span> depending on <span class="math-container" id="12479771" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span> -- and yet this is what one needs here, with <span class="math-container" id="12479685" visual_id="2733"><math alttext="a_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>n</mi></msub></semantics></math></span> and <span class="math-container" id="12479686" visual_id="6650"><math alttext="b_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mi>n</mi></msub></semantics></math></span> roughly <span class="math-container" id="12479687" visual_id="1816034"><math alttext="\pm 1/\sqrt{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>±</mo><mrow><mn>1</mn><mo>/</mo><msqrt><mi>n</mi></msqrt></mrow></mrow></semantics></math></span>. .../... </td></tr><tr><td comment_id="2729683"> .../... <span class="math-container" id="25190692">F</span>inally, note that a sure sign that something is amiss with this approach is that it would yield the same asymptotics for <span class="math-container" id="12479688" visual_id="1816035"><math alttext="P(S_{2n}=0)\qquad\text{and}\qquad P(S_{2n+1}=0)," class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow></msub><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><mo mathvariant="italic" separator="true">  </mo><mtext>and</mtext><mo mathvariant="italic" separator="true">  </mo><mi>P</mi><mrow><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><mo>,</mo></mrow></semantics></math></span> which behave rather differently when <span class="math-container" id="12479689" visual_id="1477"><math alttext="n\to\infty" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></semantics></math></span>. </td></tr><tr><td comment_id="2729779"> @BruceZ, weird, I'm just redoing practice tests and it says here "Hint: you can use Central Limit Theorem or (in the worst case) dimensional estimate" so I just assumed there is some way to get the exact answer using CLT since with such huge numbers you can't really do it on a calculator. But what you showed gives a great estimate, so I think that's what they are looking for. Thanks! </td></tr><tr><td comment_id="2730104"> @Did I chose a and b to be constants <span class="math-container" id="12479690" visual_id="1816036"><math alttext="-0.5/\sqrt{2500}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>-</mo><mrow><mn>0.5</mn><mo>/</mo><msqrt><mn>2500</mn></msqrt></mrow></mrow></semantics></math></span> and <span class="math-container" id="12479785" visual_id="1816028"><math alttext="0.5/\sqrt{2500}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.5</mn><mo>/</mo><msqrt><mn>2500</mn></msqrt></mrow></semantics></math></span>.  CLT says for sufficiently large n, <span class="math-container" id="12479692" visual_id="128794"><math alttext="S_{n}/\sqrt{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>/</mo><msqrt><mi>n</mi></msqrt></mrow></semantics></math></span> will well-approximate a standard normal distribution.  We're using n=10000 as our sufficiently large e<span class="math-container" id="25194452">v</span>en n.  CLT tells us nothing about the rate of con<span class="math-container" id="25194454">v</span>ergence, but we <span class="math-container" id="25194455">k</span>now that it's an excellent approximation to the binomial around 0 for n=10000.  It gives  0.00797871, and the binomial gives 0.00797864.  This is a standard type of exercise in elementary classes, e.g. see DeGroot 5.7-5.8. </td></tr><tr><td comment_id="2730337"> Sorry but this is cheating... Including <span class="math-container" id="12479693" visual_id="112918"><math alttext="1/\sqrt{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>/</mo><msqrt><mi>n</mi></msqrt></mrow></semantics></math></span> in <span class="math-container" id="12479720" visual_id="159"><math alttext="a" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi></semantics></math></span> and <span class="math-container" id="12479721" visual_id="368"><math alttext="b" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi></semantics></math></span> yields a very small interval, which is natural since one chooses carefully <span class="math-container" id="12479720" visual_id="159"><math alttext="a" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi></semantics></math></span> and <span class="math-container" id="12479721" visual_id="368"><math alttext="b" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi></semantics></math></span> to catch **one** value of <span class="math-container" id="12479712" visual_id="4658"><math alttext="S_{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mi>n</mi></msub></semantics></math></span>. Yes this kind of mathematical nonsense is everywhere, textbooks, applications to the life sciences, others (ever heard of CLTs applied to samples of size 10 in reputable medicine journals?) -- and this is not a reason to reproduce them without thinking. </td></tr><tr><td comment_id="2731360"> @Did We picked that one interval because that was what was asked for. It works even better over a wider interval. You can even go down to n=10 with an error less than 1%. We made no claim about the error, but we could bound it with Berry-Esseem. It's everywhere because it gives highly useful approximations all day long. What would you have people do, ignore that? The correct answer when a student asks this is not "we can't get that information". That's absurd. I didn't do something without thinking. I knew how it would turn out. </td></tr><tr><td comment_id="2731451"> What should you do? At least indicate that this *does not follow* from CLT, contrarily to what the OP asks in the title and in the body of the question and to what you unfortunately assert in a comment above, but from other arguments. To sum up, neither make people ignore this (no risk...) nor make them believe the justification is simply the CLT. </td></tr><tr><td comment_id="2731523"> @Did He didn't ask for something that followed from the CLT alone, and I never stated that it did.  He was asked to use the CLT to calculate a probability.  We used the CLT in the sense that we used the limiting distribution that it predicts. All we're doing is approximating a binomial with a normal of the same mean and variance for sufficiently large n.  That the binomial converges to a normal for sufficiently large n does follow from applying CLT to Bernoulli trials. </td></tr><tr><td comment_id="2731533"> As I said: CLT in the title, CLT in the body, CLT in your comment. But I am not sure that you are reading what I write anymore... Sorry for the disturbance. </td></tr><tr><td comment_id="2731547"> @Did The question  just says use it.  I never even mentioned it in my answer.  It's obvious what's expected.   I read everything you wrote and thought about it very carefully.  I started a chatroom.  When I ampersanded you from it, did you get a notification?  I don't know if that works. </td></tr><tr><td comment_id="2732413"> @BruceZ , if it makes you feel any better I have had a version of this argument with Did in the recent past. He's nearly always right here on MSE and he's right here, annoyingly! ;-) </td></tr><tr><td comment_id="2732812"> @Simon S Not this time!  In this problem we want the central term, so we need only De Moivre-Lapalce which is a special case of CLT.  Did's comment about CLT being inapplicable because the interval is a function of n was not relevant to anything we did here.  In fact, allowing the interval to vary as a function of n so that it corresponds to the same number of standard deviations is precisely what is done in the direct derivation of De Moivre-Laplace. </td></tr><tr><td comment_id="2732866"> Obviously De Moivre-Laplace is somehow related to the CLT, but is it actually a special case? (Sure, Wikipedia says it is, but if you can't show it independently of Wikipedia, it isn't true.) </td></tr><tr><td comment_id="2732920"> @David K Of course. See Papoulis 8-5: "This shows that the De Moivre-Laplace Theorem (3-27) is a special case of the lattice-type form of the central limit theorem". Also, Feller refers to the exact method I used in this answer as the De Moivre-Laplace theorem, and he recommends it be used in that form for greatest accuracy when the interval is moderately small. </td></tr><tr><td comment_id="2732942"> @BruceZ You see? To justify the statements in your answer, you are naturally led to be much more specific than you were when I posted my comments advising for caution about the applications of CLT. Sure there are results allowing to approximate binomials by normals but *these do not follow from the general statement of the CLT*. If your answer is using some lattice-type CLT, just mention the fact and be specific (but note that the obfuscations about the size of the interval in your last comments are squarely misleading). .../... </td></tr><tr><td comment_id="2732943"> .../... (Yes this comme<span class="math-container" id="25221883">n</span>t is merely rephrasi<span class="math-container" id="25221886">n</span>g my previous-to-last comme<span class="math-container" id="25221890">n</span>t. Yes it is unfortunate that I have to.) </td></tr><tr><td comment_id="2734120"> @Did I don't know why CLT would exclude lattice CLT on a lattice.  It's just a form of CLT when probabilities are samples of the normal pdf.  Any binomial approximation theorem coming from it ultimately comes from CLT.  The cumulative version I used is based on an approximation theorem that is a special case of CLT according to Feller.  His recommendation was just to use the 0.5 correction factors when 1/sqrt(npq) is moderately small, not when the interval is small as I stated, sorry.  On that same Papoulis section, note his convolution notation. </td></tr><tr><td comment_id="2735027"> Yes, yes, su<span class="math-container" id="25199760">r</span>e, please continue to address NONE of the specific points I made. Sorry but I am out. </td></tr><tr><td comment_id="2738264"> Has anyone mentioned local limit theorems yet in this discussion? </td></tr><tr><td comment_id="2738465"> @D. Thomine  What?  The variance of a binomial is npq.  n = 10000, p = q = 1/2.  We want the number of steps to the right to be 5000 out of 10000. </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
