<!DOCTYPE html>

<html>
<head>
<title>Raising an expression involving modulo operator to a power.</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> Raising an expression involving modulo operator to a power. </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="2640812">
<p>I was going through on the mathematics behind RSA. Lets say:</p> <ol> <li><strong><em>e</em></strong> is the encryption key</li> <li><strong><em>d</em></strong> is the decryption key</li> <li><strong><em>M</em></strong> is the plain text</li> <li><strong><em>C = M <sup>e</sup>  mod n</em></strong> , where <strong><em>n</em></strong> is a product of two prime numbers is the cipher text.</li> </ol> <h1> Message reconstruction using decryption key </h1> <p>Most textbooks and links explain the reconstruction of message from the cipher text using the decryption key <strong><em>d</em></strong> as follows.</p> <p><strong><em>C<sup>d</sup></em></strong> ≡ <strong>M <sup> ed </sup></strong> ≡ <strong><em>M<sup> kφ(n)+1 </sup> =  M<sup>kφ(n)</sup>.M = (M<sup>φ(n)</sup>)<sup>k</sup>.M = (1)<sup>k</sup>.M = M = M mod n</em></strong> </p> <p>Couple of questions here in the decryption equation:</p> <ul> <li>Isn't C<sup>d</sup> = <strong>(M <sup> e </sup> mod n)<sup> d </sup></strong>.    All of the explanations just computes <strong>M <sup> ed </sup></strong> and    ignores <strong><em>mod n</em></strong> and just adds the <strong><em>mod n</em></strong> at the end. This    must be something basic, but due to lack of background in modulo    arithmetic, am failing to understand it.</li> <li>Same question applies for translating  <strong><em>(M<sup>φ(n)</sup>)<sup>k</sup>.M = (1)<sup>k</sup>.M</em></strong> . It is understood that <strong><em>M<sup>φ(n)</sup></em></strong> equals <strong><em>1 mod n</em></strong>, but how is  (<strong><em>1 mod n</em></strong>) <sup> k </sup> equals 1.</li> </ul> <p>Basically what am failing to understand is if an expression is of a form <strong>a mod n</strong>, and we raise that expression to an exponent k, <strong>(a mod n) <sup> k </sup>*</strong>, how do we evaluate it? </p>
</div>
<hr/>
<div id="tags">
<span> number-theory </span><span> elementary-number-theory </span><span> prime-numbers </span><span> modular-arithmetic </span><span> cryptography </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
<tr><td comment_id="5453856"> By the *fast exponentiation algorithm*, for instance. </td></tr><tr><td comment_id="5453930"> Maybe what you are missing is that, for any natural <span class="math-container" id="24407939" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span> and integers <span class="math-container" id="24407940" visual_id="522600"><math alttext="a,b,a^{\prime},b^{\prime}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><msup><mi>a</mi><mo>′</mo></msup><mo>,</mo><msup><mi>b</mi><mo>′</mo></msup></mrow></semantics></math></span> such that <span class="math-container" id="24407941" visual_id="1483755"><math alttext="a\equiv a^{\prime}\pmod{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≡</mo><mrow><msup><mi>a</mi><mo>′</mo></msup><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo>mod</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> and <span class="math-container" id="24407942" visual_id="1483756"><math alttext="b\equiv b^{\prime}\pmod{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>≡</mo><mrow><msup><mi>b</mi><mo>′</mo></msup><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo>mod</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> you have <span class="math-container" id="24407943" visual_id="1483757"><math alttext="ab\equiv a^{\prime}b^{\prime}\pmod{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>b</mi></mrow><mo>≡</mo><mrow><mrow><msup><mi>a</mi><mo>′</mo></msup><mo>⁢</mo><msup><mi>b</mi><mo>′</mo></msup></mrow><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo>mod</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>. This lets you calculate <span class="math-container" id="24407944" visual_id="1897079"><math alttext="ab\pmod{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>b</mi></mrow><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo>mod</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> as <span class="math-container" id="24407945" visual_id="6122667"><math alttext="(a\pmod{n})(b\pmod{n})\pmod{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>a</mi><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo>mod</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>b</mi><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo>mod</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo>mod</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>, and, applying multiplication multiple times: <span class="math-container" id="24407946" visual_id="6122668"><math alttext="a^{k}\pmod{n}=(a\pmod{n})^{k}\pmod{n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msup><mi>a</mi><mi>k</mi></msup><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo>mod</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>a</mi><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo>mod</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><mi>k</mi></msup><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo>mod</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>. </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="2642125" id="answer">
<p>Several of these questions are addressed by the wikipedia article on modular arithmetic. <a href="https://en.wikipedia.org/wiki/Modular_arithmetic" rel="nofollow noreferrer">https://en.wikipedia.org/wiki/Modular_arithmetic</a></p> <p>Modulus distributes over addition and multiplication, and thus commutes with exponentiation. So (a<sup>b</sup>) mod n = (a mod n)<sup>b</sup> (Keep in mind that this equality holds considering mod n to be a function from the integers to the mod n ring; thus the equality is taking place within that ring, not within the integers. To make it true within the ring of integers, it would be (a<sup>b</sup>) mod n = ((a mod n)<sup>b</sup>) mod n).) You can test this out with specific numbers. For instance, if you're in base 10, then mod 10 just takes the last digit of a number. If you raise a number to a power and take the last digit, you will get the same answer as if you take the last digit, raise it to the power, and take the last digit of <em>that</em> number. For instance, 16<sup>2</sup> = 256. If you take the last digit of 16, that's 6. 6<sup>2</sup> = 36. 256 and 36 have the same last digit: 6.</p> <p>If a = 1, then we have (1 mod n)<sup>b</sup> =  (1<sup>b</sup>) mod n. But  (1<sup>b</sup>) =  1, so (1 mod n)<sup>b</sup> = 1. Again, the "1" here is an element of the mod n ring. If you understand ring theory and the concept of homeomorphisms, this identity is a trivial consequence of the fact that n -&gt; mod n is a ring homeomorphism; if you accept that <strong>Z</strong>/n<strong>Z</strong> is a ring, then 1<sup>b</sup> must be 1, because that's an inherent property of 1 in any ring. The fact that mod n distributes over addition and multiplication also follows from  n -&gt; mod n being a ring homeomorphism.</p> <p>As for numerical methods of calculating (a mod n)<sup>b</sup>, one method is to take the binary representation of b to write  a<sup>b</sup> as a series of product and squaring. For instance, if b = 13, then b = 8+4+0+0+1, so  a<sup>b</sup> = (((a<sup>2</sup>)*a)<sup>2</sup>)<sup>2</sup>*a). After each multiplication or squaring, the result can be reduced by to the modulus function.</p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
