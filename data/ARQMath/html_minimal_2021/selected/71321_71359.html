<!DOCTYPE html>

<html>
<head>
<title>What's the asymptotic lower bound of the sum $\frac 3 2 + \sum_{k=3}^{n} \frac{n!}{k(n-k)!n^k}$?</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> What's the asymptotic lower bound of the sum <span class="math-container" id="798536" visual_id="8797685"><math alttext="\frac{3}{2}+\sum_{k=3}^{n}\frac{n!}{k(n-k)!n^{k}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>3</mn><mn>2</mn></mfrac><mo>+</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>3</mn></mrow><mi>n</mi></msubsup><mfrac><mrow><mi>n</mi><mo>!</mo></mrow><mrow><mi>k</mi><mo>⁢</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mi>k</mi></mrow><mo stretchy="false">)</mo></mrow><mo>!</mo></mrow><mo>⁢</mo><msup><mi>n</mi><mi>k</mi></msup></mrow></mfrac></mrow></mrow></semantics></math></span>? </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="71321">
<p>The sum is:</p> <p><span class="math-container" id="798537" visual_id="8797686"><math alttext="S=1+1/2+\frac{(n-1)(n-2)}{3n^{2}}+\frac{(n-1)(n-2)(n-3)}{4n^{3}}+\ldots+\frac{% (n-1)!}{n\times n^{n-1}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mrow><mn>1</mn><mo>+</mo><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow><mo>+</mo><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mn>3</mn><mo>⁢</mo><msup><mi>n</mi><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>3</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mn>4</mn><mo>⁢</mo><msup><mi>n</mi><mn>3</mn></msup></mrow></mfrac><mo>+</mo><mi mathvariant="normal">…</mi><mo>+</mo><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>!</mo></mrow><mrow><mi>n</mi><mo>×</mo><msup><mi>n</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mfrac></mrow></mrow></semantics></math></span> <span class="math-container" id="798538" visual_id="8797687"><math alttext="=\frac{3}{2}+\sum_{k=3}^{n}\frac{n!}{k(n-k)!n^{k}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi></mi><mo>=</mo><mrow><mfrac><mn>3</mn><mn>2</mn></mfrac><mo>+</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>3</mn></mrow><mi>n</mi></msubsup><mfrac><mrow><mi>n</mi><mo>!</mo></mrow><mrow><mi>k</mi><mo>⁢</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mi>k</mi></mrow><mo stretchy="false">)</mo></mrow><mo>!</mo></mrow><mo>⁢</mo><msup><mi>n</mi><mi>k</mi></msup></mrow></mfrac></mrow></mrow></mrow></semantics></math></span></p> <p>Can we get an asymptotic lower bound of <span class="math-container" id="798539" visual_id="403"><math alttext="S" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi></semantics></math></span>?</p> <p>I guess it's <span class="math-container" id="798540" visual_id="8797688"><math alttext="\Omega(\frac{1}{2}\log n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>, but I'm not sure how to get it. <span class="math-container" id="798541" visual_id="83"><math alttext="k" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi></semantics></math></span> starts from 3 because I'm actually counting the expectation of cycles in a graph.  And least 3 nodes could form a cycle.  But since what I need is an asymptotic lower bound, I guess where <span class="math-container" id="798542" visual_id="83"><math alttext="k" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi></semantics></math></span> starts doesn't really matter.</p>
</div>
<hr/>
<div id="tags">
<span> asymptotics </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
<tr><td comment_id="168733"> The first two terms don't seem to fit a simple pattern, and why are there two <span class="math-container" id="798555" visual_id="11693"><math alttext="(n-2)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></semantics></math></span> factors in second numerator? Is the general pattern supposed to be something like <span class="math-container" id="798544" visual_id="8797689"><math alttext="S(n)=\sum_{k=1}^{n}\frac{n!}{k(n-k)!n^{k}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mfrac><mrow><mi>n</mi><mo>!</mo></mrow><mrow><mi>k</mi><mo>⁢</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mi>k</mi></mrow><mo stretchy="false">)</mo></mrow><mo>!</mo></mrow><mo>⁢</mo><msup><mi>n</mi><mi>k</mi></msup></mrow></mfrac></mrow></mrow></semantics></math></span> ? </td></tr><tr><td comment_id="168736"> Why isn't the second term <span class="math-container" id="798545" visual_id="941774"><math alttext="(n-1)/(2n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>? Should the fourth term have two <span class="math-container" id="798555" visual_id="11693"><math alttext="(n-2)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></semantics></math></span>'s or is the second of these supposed to be <span class="math-container" id="798547" visual_id="73638"><math alttext="(n-3)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>3</mn></mrow><mo stretchy="false">)</mo></mrow></semantics></math></span>? Lastly, I think one should write <span class="math-container" id="798583" visual_id="12865"><math alttext="S(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> since it's a function of <span class="math-container" id="798565" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span> (and they aren't exactly partial sums because the terms themselves vary with <span class="math-container" id="798565" visual_id="177"><math alttext="n" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi></semantics></math></span>). </td></tr><tr><td comment_id="168743"> If this is <span class="math-container" id="798551" visual_id="8797690"><math alttext="S(n)=\sum_{k=1}^{n-1}\frac{n!}{(n-k)!kn^{k}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msubsup><mfrac><mrow><mi>n</mi><mo>!</mo></mrow><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mi>k</mi></mrow><mo stretchy="false">)</mo></mrow><mo>!</mo></mrow><mo>⁢</mo><mi>k</mi><mo>⁢</mo><msup><mi>n</mi><mi>k</mi></msup></mrow></mfrac></mrow></mrow></semantics></math></span> the second term should be <span class="math-container" id="798552" visual_id="981155"><math alttext="\frac{n-1}{2n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow></mfrac></semantics></math></span>, not <span class="math-container" id="798553" visual_id="363"><math alttext="\frac{1}{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mn>2</mn></mfrac></semantics></math></span>, and the fourth should be <span class="math-container" id="798554" visual_id="8797691"><math alttext="\frac{(n-1)(n-2)(n-3)}{4n^{4}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>3</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mrow><mn>4</mn><mo>⁢</mo><msup><mi>n</mi><mn>4</mn></msup></mrow></mfrac></semantics></math></span>. </td></tr><tr><td comment_id="168748"> The 2 <span class="math-container" id="798555" visual_id="11693"><math alttext="(n-2)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></semantics></math></span> is a typo, I just fixed it. </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="71359" id="answer">
<p>For a complete asymptotic up to <span class="math-container" id="798567" visual_id="57154"><math alttext="o(1)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> I get  <span class="math-container" id="798568" visual_id="8797698"><math alttext="S(n)=\frac{1}{2}\log n+\frac{\gamma+\log 2}{2}+o(1)." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mrow><mo>+</mo><mfrac><mrow><mi>γ</mi><mo>+</mo><mrow><mi>log</mi><mo>⁡</mo><mn>2</mn></mrow></mrow><mn>2</mn></mfrac><mo>+</mo><mrow><mi>o</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>Your sum <span class="math-container" id="798569" visual_id="12865"><math alttext="S(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> is very close to the sum <span class="math-container" id="798570" visual_id="8797699"><math alttext="Q(n)=1+\frac{n-1}{n}+\frac{(n-1)(n-2)}{n^{2}}+\cdots=\sum_{k\geq 1}\frac{n^{% \underline{k}}}{n^{k}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>Q</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mn>1</mn><mo>+</mo><mfrac><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mi>n</mi></mfrac><mo>+</mo><mfrac><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><msup><mi>n</mi><mn>2</mn></msup></mfrac><mo>+</mo><mi mathvariant="normal">⋯</mi></mrow><mo>=</mo><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mrow><mi>k</mi><mo>≥</mo><mn>1</mn></mrow></msub><mfrac><msup><mi>n</mi><munder accentunder="true"><mi>k</mi><mo>¯</mo></munder></msup><msup><mi>n</mi><mi>k</mi></msup></mfrac></mrow></mrow></semantics></math></span> considered in Problem 9.56 in <em>Concrete Mathematics</em> and elsewhere in Knuth's work, so I've adapted some of the arguments I found there.  </p> <p>Let's consider the sum <span class="math-container" id="798571" visual_id="8797700"><math alttext="S&amp;#39;(n)=\sum_{k\geq 1}\frac{n^{\underline{k}}}{kn^{k}}=S(n)-\frac{1}{2n}=S(n% )+o(1)." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mrow><mi>S</mi><mo>⁢</mo><mi mathvariant="normal">&amp;</mi><mo>⁢</mo><mi mathvariant="normal">#</mi><mo>⁢</mo><mn>39</mn></mrow><mo>;</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mrow><mi>k</mi><mo>≥</mo><mn>1</mn></mrow></msub><mfrac><msup><mi>n</mi><munder accentunder="true"><mi>k</mi><mo>¯</mo></munder></msup><mrow><mi>k</mi><mo>⁢</mo><msup><mi>n</mi><mi>k</mi></msup></mrow></mfrac></mrow><mo>=</mo><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>-</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow></mfrac></mrow><mo>=</mo><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><mi>o</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span>  In the answer to Problem 9.56 in <em>Concrete Mathematics</em> the authors indicate that Stirling's approximation can be used to show that if <span class="math-container" id="798572" visual_id="8797701"><math alttext="k\leq n^{1/2+\epsilon}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>≤</mo><msup><mi>n</mi><mrow><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow><mo>+</mo><mi>ϵ</mi></mrow></msup></mrow></semantics></math></span> then</p> <p><span class="math-container" id="798573" visual_id="8797702"><math alttext="\frac{n^{\underline{k}}}{kn^{k}}=e^{-k^{2}/2n}\left(\frac{1}{k}+\frac{1}{2n}-% \frac{2}{3}\frac{k^{2}}{(2n)^{2}}+O(n^{-1+4\epsilon})\right)." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mfrac><msup><mi>n</mi><munder accentunder="true"><mi>k</mi><mo>¯</mo></munder></msup><mrow><mi>k</mi><mo>⁢</mo><msup><mi>n</mi><mi>k</mi></msup></mrow></mfrac><mo>=</mo><mrow><msup><mi>e</mi><mrow><mo>-</mo><mrow><mrow><msup><mi>k</mi><mn>2</mn></msup><mo>/</mo><mn>2</mn></mrow><mo>⁢</mo><mi>n</mi></mrow></mrow></msup><mo>⁢</mo><mrow><mo>(</mo><mrow><mrow><mrow><mfrac><mn>1</mn><mi>k</mi></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow></mfrac></mrow><mo>-</mo><mrow><mfrac><mn>2</mn><mn>3</mn></mfrac><mo>⁢</mo><mfrac><msup><mi>k</mi><mn>2</mn></msup><msup><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mfrac></mrow></mrow><mo>+</mo><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mrow><mo>-</mo><mn>1</mn></mrow><mo>+</mo><mrow><mn>4</mn><mo>⁢</mo><mi>ϵ</mi></mrow></mrow></msup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span> Then, Knuth and Pittel, in "A Recurrence Related to Trees," (<em>Proceedings of the AMS</em> 105(2) 1989, pp. 335-349) indicate this means that <span class="math-container" id="798574" visual_id="8797703"><math alttext="\frac{n^{\underline{k}}}{k\,n^{k}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><msup><mi>n</mi><munder accentunder="true"><mi>k</mi><mo>¯</mo></munder></msup><mrow><mpadded width="+1.7pt"><mi>k</mi></mpadded><mo>⁢</mo><msup><mi>n</mi><mi>k</mi></msup></mrow></mfrac></semantics></math></span> is exponentially small when <span class="math-container" id="798575" visual_id="8797704"><math alttext="k\geq n^{1/2+\epsilon}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>≥</mo><msup><mi>n</mi><mrow><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow><mo>+</mo><mi>ϵ</mi></mrow></msup></mrow></semantics></math></span> and so can be replaced with other exponentially small terms to get  <span class="math-container" id="798576" visual_id="8797705"><math alttext="S&amp;#39;(n)=T_{2n}(-1)+\left(\frac{1}{2n}+O(n^{-1+4\epsilon})\right)T_{2n}(0)-% \frac{1}{6n^{2}}T_{2n}(2)," class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mrow><mi>S</mi><mo>⁢</mo><mi mathvariant="normal">&amp;</mi><mo>⁢</mo><mi mathvariant="normal">#</mi><mo>⁢</mo><mn>39</mn></mrow><mo>;</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mrow><msub><mi>T</mi><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mfrac><mn>1</mn><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow></mfrac><mo>+</mo><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mrow><mo>-</mo><mn>1</mn></mrow><mo>+</mo><mrow><mn>4</mn><mo>⁢</mo><mi>ϵ</mi></mrow></mrow></msup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>)</mo></mrow><mo>⁢</mo><msub><mi>T</mi><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>-</mo><mrow><mfrac><mn>1</mn><mrow><mn>6</mn><mo>⁢</mo><msup><mi>n</mi><mn>2</mn></msup></mrow></mfrac><mo>⁢</mo><msub><mi>T</mi><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></semantics></math></span> where <span class="math-container" id="798577" visual_id="8797706"><math alttext="T_{n}(x)=\sum_{k\geq 1}k^{x}e^{-k^{2}/n}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>T</mi><mi>n</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mrow><mi>k</mi><mo>≥</mo><mn>1</mn></mrow></msub><mrow><msup><mi>k</mi><mi>x</mi></msup><mo>⁢</mo><msup><mi>e</mi><mrow><mo>-</mo><mrow><msup><mi>k</mi><mn>2</mn></msup><mo>/</mo><mi>n</mi></mrow></mrow></msup></mrow></mrow></mrow></semantics></math></span>.</p> <p>Lemma 1 in the Knuth and Pittel paper then states that if <span class="math-container" id="798578" visual_id="122966"><math alttext="x&amp;gt;-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>x</mi><mo>&gt;</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></mrow></semantics></math></span> then <span class="math-container" id="798579" visual_id="8797707"><math alttext="T_{n}(x)=\frac{1}{2}\Gamma\left(\frac{x+1}{2}\right)n^{(x+1)/2}+O(1)." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><msub><mi>T</mi><mi>n</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⁢</mo><mi mathvariant="normal">Γ</mi><mo>⁢</mo><mrow><mo>(</mo><mfrac><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo>)</mo></mrow><mo>⁢</mo><msup><mi>n</mi><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>/</mo><mn>2</mn></mrow></msup></mrow><mo>+</mo><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span>  They also mention that a derivation of <span class="math-container" id="798580" visual_id="8797708"><math alttext="T_{n}(-1)=\frac{1}{2}\log n+\frac{\gamma}{2}+O(n^{-1})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>T</mi><mi>n</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mrow><mo>+</mo><mfrac><mi>γ</mi><mn>2</mn></mfrac><mo>+</mo><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></semantics></math></span> is in Knuth's <em>Art of Computer Programming</em>, Vol. 3, Exercise 5.2.2-4, as part of the analysis of bubblesort.  </p> <p>Putting this all together gives us <span class="math-container" id="798581" visual_id="8797709"><math alttext="S(n)=\frac{1}{2}\log(2n)+\frac{\gamma}{2}+o(1)=\frac{1}{2}\log n+\frac{\gamma+% \log 2}{2}+o(1)." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>+</mo><mfrac><mi>γ</mi><mn>2</mn></mfrac><mo>+</mo><mrow><mi>o</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mrow><mo>+</mo><mfrac><mrow><mi>γ</mi><mo>+</mo><mrow><mi>log</mi><mo>⁡</mo><mn>2</mn></mrow></mrow><mn>2</mn></mfrac><mo>+</mo><mrow><mi>o</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span></p> <p>For more on the <span class="math-container" id="798582" visual_id="300840"><math alttext="Q(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> and related functions and their asymptotics, see <em>The Art of Computer Programming</em>, Vol. 1 (3rd ed.), Section 1.2.11.3.</p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
<tr><td comment_id="170709"> I did computer simulation and <span class="math-container" id="798583" visual_id="12865"><math alttext="S(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> indeed goes to <span class="math-container" id="798584" visual_id="8797710"><math alttext="1/2log(n)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>.  But I am afraid your proof is a difficult for me to understand.  Is there any other simpler proofs? </td></tr><tr><td comment_id="170752"> @ablmf: Unfortunately, I don't know of a simpler one.  I see that you have asked for a simpler proof as a separate question, though, so maybe somebody else on the site can think of one.  However, if Knuth and Pittel felt the need to go through work like this to solve a similar problem, my guess is that finding a simpler proof won't be easy. </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
<tr><td post_id="71432"> What's the lower bound of the sum <span class="math-container" id="799805" visual_id="8798007"><math alttext="S(n)=\sum_{k=1}^{n}\prod_{j=1}^{k}(1-\frac{j}{n})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mrow><msubsup><mo largeop="true" symmetric="true">∏</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><mi>j</mi><mi>n</mi></mfrac></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></semantics></math></span>? </td></tr><tr><td post_id="72173"> Is there any easier way to get the asymptotic value of this sum? </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
