<!DOCTYPE html>

<html>
<head>
<title>Evaluating $\int_0^{2\pi}\frac{1}{1-\rho \sin{2 \phi }}\,\mathrm{d}\phi$ in verifying density function</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> Evaluating <span class="math-container" id="22599943" visual_id="4752691"><math alttext="\int_{0}^{2\pi}\frac{1}{1-\rho\sin{2\phi}}\,\mathrm{d}\phi" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo largeop="true" symmetric="true">∫</mo><mn>0</mn><mrow><mn>2</mn><mo>⁢</mo><mi>π</mi></mrow></msubsup><mrow><mpadded width="+1.7pt"><mfrac><mn>1</mn><mrow><mn>1</mn><mo>-</mo><mrow><mi>ρ</mi><mo>⁢</mo><mrow><mi>sin</mi><mo>⁡</mo><mrow><mn>2</mn><mo>⁢</mo><mi>ϕ</mi></mrow></mrow></mrow></mrow></mfrac><mo>⁢</mo><mrow><mo rspace="0pt">d</mo><mi>ϕ</mi></mrow></mpadded></mrow></mrow></semantics></math></span> in verifying density function </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="2440685">
<p>Let <span class="math-container" id="22599944" visual_id="2484"><math alttext="(X,Y)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow></semantics></math></span> have a bivariate normal density centered at the origin with <span class="math-container" id="22599945" visual_id="4752692"><math alttext="\mathbb{E}(X^{2})=\mathbb{E}(Y^{2})=1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>𝔼</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>X</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>𝔼</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>Y</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></semantics></math></span> and <span class="math-container" id="22599946" visual_id="1573838"><math alttext="\mathbb{E}(XY)=\rho" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>𝔼</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>X</mi><mo>⁢</mo><mi>Y</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mi>ρ</mi></mrow></semantics></math></span>. In polar coordinates, <span class="math-container" id="22599947" visual_id="2484"><math alttext="(X,Y)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow></semantics></math></span> becomes <span class="math-container" id="22599948" visual_id="4752693"><math alttext="(R,\Phi)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>R</mi><mo>,</mo><mi mathvariant="normal">Φ</mi><mo stretchy="false">)</mo></mrow></semantics></math></span> where <span class="math-container" id="22599949" visual_id="256620"><math alttext="R^{2}=X^{2}+Y^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mrow><msup><mi>X</mi><mn>2</mn></msup><mo>+</mo><msup><mi>Y</mi><mn>2</mn></msup></mrow></mrow></semantics></math></span>. Then it can be shown that <span class="math-container" id="22599950" visual_id="12431"><math alttext="\Phi" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">Φ</mi></semantics></math></span> has a density given by <span class="math-container" id="22599951" visual_id="4752694"><math alttext="f_{\Phi}(\phi)=\frac{\sqrt{1-\rho^{2}}}{2\pi(1-\rho\sin 2\phi)},\quad 0&lt;\phi&lt;2\pi" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><msub><mi>f</mi><mi mathvariant="normal">Φ</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mfrac><msqrt><mrow><mn>1</mn><mo>-</mo><msup><mi>ρ</mi><mn>2</mn></msup></mrow></msqrt><mrow><mn>2</mn><mo>⁢</mo><mi>π</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>-</mo><mrow><mi>ρ</mi><mo>⁢</mo><mrow><mi>sin</mi><mo>⁡</mo><mrow><mn>2</mn><mo>⁢</mo><mi>ϕ</mi></mrow></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow><mo rspace="12.5pt">,</mo><mrow><mn>0</mn><mo>&lt;</mo><mi>ϕ</mi><mo>&lt;</mo><mrow><mn>2</mn><mo>⁢</mo><mi>π</mi></mrow></mrow></mrow></semantics></math></span></p> <p>But I am having difficulty proving that this is indeed a density, more specifically the fact that <span class="math-container" id="22599952" visual_id="4752695"><math alttext="\displaystyle\int_{0}^{2\pi}f_{\Phi}(\phi)\,\mathrm{d}\phi=1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msubsup><mo largeop="true" symmetric="true">∫</mo><mn>0</mn><mrow><mn>2</mn><mo>⁢</mo><mi>π</mi></mrow></msubsup><mrow><msub><mi>f</mi><mi mathvariant="normal">Φ</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>ϕ</mi><mo rspace="4.2pt" stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo rspace="0pt">d</mo><mi>ϕ</mi></mrow></mrow></mrow><mo>=</mo><mn>1</mn></mrow></semantics></math></span>. Applying the usual substitution <span class="math-container" id="22599953" visual_id="1812674"><math alttext="t=\tan\phi" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mrow><mi>tan</mi><mo>⁡</mo><mi>ϕ</mi></mrow></mrow></semantics></math></span> in the integral <span class="math-container" id="22599954" visual_id="4752691"><math alttext="\displaystyle\int_{0}^{2\pi}\frac{1}{1-\rho\sin{2\phi}}\,\mathrm{d}\phi" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo largeop="true" symmetric="true">∫</mo><mn>0</mn><mrow><mn>2</mn><mo>⁢</mo><mi>π</mi></mrow></msubsup><mrow><mpadded width="+1.7pt"><mfrac><mn>1</mn><mrow><mn>1</mn><mo>-</mo><mrow><mi>ρ</mi><mo>⁢</mo><mrow><mi>sin</mi><mo>⁡</mo><mrow><mn>2</mn><mo>⁢</mo><mi>ϕ</mi></mrow></mrow></mrow></mrow></mfrac><mo>⁢</mo><mrow><mo rspace="0pt">d</mo><mi>ϕ</mi></mrow></mpadded></mrow></mrow></semantics></math></span> seems to be misleading. Should there be any change in the integration limits for proving that this a density. If so, why?</p> <p><strong>EDIT.</strong></p> <p>Another related integral is <span class="math-container" id="22599955" visual_id="4752696"><math alttext="I=\displaystyle\int_{0}^{\pi/2}\frac{\mathrm{d}\theta}{1-\rho\sin{2\theta}}=% \frac{\pi-\arccos\rho}{\sqrt{1-\rho^{2}}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>=</mo><mrow><msubsup><mo largeop="true" symmetric="true">∫</mo><mn>0</mn><mrow><mi>π</mi><mo>/</mo><mn>2</mn></mrow></msubsup><mfrac><mrow><mi mathvariant="normal">d</mi><mo>⁢</mo><mi>θ</mi></mrow><mrow><mn>1</mn><mo>-</mo><mrow><mi>ρ</mi><mo>⁢</mo><mrow><mi>sin</mi><mo>⁡</mo><mrow><mn>2</mn><mo>⁢</mo><mi>θ</mi></mrow></mrow></mrow></mrow></mfrac></mrow><mo>=</mo><mfrac><mrow><mi>π</mi><mo>-</mo><mrow><mi>arccos</mi><mo>⁡</mo><mi>ρ</mi></mrow></mrow><msqrt><mrow><mn>1</mn><mo>-</mo><msup><mi>ρ</mi><mn>2</mn></msup></mrow></msqrt></mfrac></mrow></semantics></math></span>, which arises while calculating <a href="https://math.stackexchange.com/questions/255368/getting-px0-y0-for-a-bivariate-distribution"><span class="math-container" id="22599956" visual_id="941016"><math alttext="\mathbb{P}(X&gt;0,Y&gt;0)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℙ</mi><mrow><mo stretchy="false">(</mo><mi>X</mi><mo>&gt;</mo><mn>0</mn><mo>,</mo><mi>Y</mi><mo>&gt;</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span></a> for the above distribution once I transform to polar coordinates. The above probability is then given by <span class="math-container" id="22599957" visual_id="4752697"><math alttext="\dfrac{\sqrt{1-\rho^{2}}}{2\pi}I" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msqrt><mrow><mn>1</mn><mo>-</mo><msup><mi>ρ</mi><mn>2</mn></msup></mrow></msqrt><mrow><mn>2</mn><mo>⁢</mo><mi>π</mi></mrow></mfrac><mo>⁢</mo><mi>I</mi></mrow></semantics></math></span>. Following the suggestions given in the answers below, I was able to evaluate <span class="math-container" id="22599958" visual_id="989"><math alttext="I" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi></semantics></math></span> correctly and hence calculated the probability by direct integration. </p>
</div>
<hr/>
<div id="tags">
<span> integration </span><span> probability-distributions </span><span> definite-integrals </span><span> normal-distribution </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="2440874" id="answer">
<p>Let <span class="math-container" id="22599959" visual_id="374651"><math alttext="z=e^{i\phi}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><msup><mi>e</mi><mrow><mi>i</mi><mo>⁢</mo><mi>ϕ</mi></mrow></msup></mrow></semantics></math></span> and then <span class="math-container" id="22599960" visual_id="4752698"><math alttext="d\phi=\frac{1}{iz}dz" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>d</mi><mo>⁢</mo><mi>ϕ</mi></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mi>i</mi><mo>⁢</mo><mi>z</mi></mrow></mfrac><mo>⁢</mo><mi>d</mi><mo>⁢</mo><mi>z</mi></mrow></mrow></semantics></math></span>. So <span class="math-container" id="22599961" visual_id="4752699"><math alttext="\sin\phi=\frac{1}{2i}(z-\frac{1}{z})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>sin</mi><mo>⁡</mo><mi>ϕ</mi></mrow><mo>=</mo><mrow><mfrac><mn>1</mn><mrow><mn>2</mn><mo>⁢</mo><mi>i</mi></mrow></mfrac><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo>-</mo><mfrac><mn>1</mn><mi>z</mi></mfrac></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> \begin{eqnarray} &amp;&amp;\int_0^{2\pi}\frac{1}{1-\rho \sin{2 \phi }}\,\mathrm{d}\phi\\ &amp;=&amp;\int_0^{2\pi}\frac{1}{1-\rho \sin{\phi }}\,\mathrm{d}\phi\\ &amp;=&amp;\int_{|z|=1}\frac{1}{1-\rho \frac{1}{2i}(z-\frac1z)}\,\frac{1}{iz}\mathrm{d}z\\ &amp;=&amp;\int_{|z|=1}\frac{2}{2iz-\rho (z^2-1)}\,\mathrm{d}z\\ &amp;=&amp;-\frac{1}{\rho}\int_{|z|=1}\frac{2}{z^2-\frac{2i}\rho z-1}\,\mathrm{d}z\\ &amp;=&amp;-\frac{2}{\rho}\int_{|z|=1}\frac{1}{(z-z_1)(z-z_2)}\,\mathrm{d}z\\ \end{eqnarray} where  <span class="math-container" id="22599962" visual_id="4752700"><math alttext="z_{1,2}=\frac{i}{\rho}\pm\frac{\sqrt{1-\rho^{2}}i}{\rho}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>=</mo><mrow><mfrac><mi>i</mi><mi>ρ</mi></mfrac><mo>±</mo><mfrac><mrow><msqrt><mrow><mn>1</mn><mo>-</mo><msup><mi>ρ</mi><mn>2</mn></msup></mrow></msqrt><mo>⁢</mo><mi>i</mi></mrow><mi>ρ</mi></mfrac></mrow></mrow></semantics></math></span> are the two root of <span class="math-container" id="22599963" visual_id="4752701"><math alttext="z^{2}-\frac{2i}{\rho}z-1=0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msup><mi>z</mi><mn>2</mn></msup><mo>-</mo><mrow><mfrac><mrow><mn>2</mn><mo>⁢</mo><mi>i</mi></mrow><mi>ρ</mi></mfrac><mo>⁢</mo><mi>z</mi></mrow><mo>-</mo><mn>1</mn></mrow><mo>=</mo><mn>0</mn></mrow></semantics></math></span> and only <span class="math-container" id="22599964" visual_id="7265"><math alttext="z_{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mn>2</mn></msub></semantics></math></span> is inside <span class="math-container" id="22599965" visual_id="9380"><math alttext="|z|=1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="false">|</mo><mi>z</mi><mo stretchy="false">|</mo></mrow><mo>=</mo><mn>1</mn></mrow></semantics></math></span>. So \begin{eqnarray} &amp;&amp;\int_0^{2\pi}\frac{1}{1-\rho \sin{2 \phi }}\,\mathrm{d}\phi\\ &amp;=&amp;-\frac{2}{\rho}\int_{|z|=1}\frac{1}{(z-z_1)(z-z_2)}\,\mathrm{d}z\\ &amp;=&amp;-\frac{2}{\rho}2\pi i\frac{1}{z_2-z_1}\\ &amp;=&amp;\frac{2\pi}{\sqrt{1-\rho^2}}. \end{eqnarray}</p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
<tr><td post_id="255368"> <span class="math-container" id="2834934" visual_id="4931033"><math alttext="P(X&gt;0,Y&gt;0)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="false">(</mo><mi>X</mi><mo>&gt;</mo><mn>0</mn><mo>,</mo><mi>Y</mi><mo>&gt;</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> for a bivariate normal distribution with correlation <span class="math-container" id="2834935" visual_id="2419"><math alttext="\rho" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi></semantics></math></span> </td></tr>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
