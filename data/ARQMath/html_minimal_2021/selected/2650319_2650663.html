<!DOCTYPE html>

<html>
<head>
<title>Polynomial ring over finite field - inverting a polynomial non-prime</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> Polynomial ring over finite field - inverting a polynomial non-prime </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="2650319">
<p>I'm trying to recreate the wiki's example procedure, available here:</p> <p><a href="https://en.wikipedia.org/wiki/NTRUEncrypt" rel="nofollow noreferrer">https://en.wikipedia.org/wiki/NTRUEncrypt</a></p> <p>I've run into an issue while attempting to invert the polynomials.</p> <p>The SAGE code below seems to be working fine for the given <em>p=3</em>, which is a prime number.</p> <p>However, the representation of the polynomial in the field generated by <em>q=32</em> ends up wrong, because it behaves as if the modulus was 2.</p> <p>Here's the code in play:</p> <pre><code>F = PolynomialRing(GF(32),'a') a = F.gen() Ring = F.quotient(a^11 - 1, 'x') x = Ring.gen() pollist = [-1, 1, 1, 0, -1, 0, 1, 0, 0, 1, -1]  fq = Ring(pollist) print(fq) print(fq^(-1)) </code></pre> <p>The Ring is described as follows:</p> <pre><code>Univariate Quotient Polynomial Ring in x over Finite Field in z5 of size 2^5 with modulus a^11 + 1 </code></pre> <p>And the result:</p> <pre><code>x^10 + x^9 + x^6 + x^4 + x^2 + x + 1 x^5 + x + 1 </code></pre> <p>I've tried to replace the Finite Field with IntegerModRing(32), but the inversion ends up demanding a field, as implied by the message:</p> <pre><code>NotImplementedError: The base ring (=Ring of integers modulo 32) is not a field </code></pre> <p>The desired result:</p> <p><span class="math-container" id="24491362" visual_id="6149979"><math alttext="fq(x)=5+9X+6X^{2}+16X^{3}+4X^{4}+15X^{5}+16X^{6}+22X^{7}+20X^{8}+18X^{9}+30X^{% 10}(mod32)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>f</mi><mo>‚Å¢</mo><mi>q</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mn>5</mn><mo>+</mo><mrow><mn>9</mn><mo>‚Å¢</mo><mi>X</mi></mrow><mo>+</mo><mrow><mn>6</mn><mo>‚Å¢</mo><msup><mi>X</mi><mn>2</mn></msup></mrow><mo>+</mo><mrow><mn>16</mn><mo>‚Å¢</mo><msup><mi>X</mi><mn>3</mn></msup></mrow><mo>+</mo><mrow><mn>4</mn><mo>‚Å¢</mo><msup><mi>X</mi><mn>4</mn></msup></mrow><mo>+</mo><mrow><mn>15</mn><mo>‚Å¢</mo><msup><mi>X</mi><mn>5</mn></msup></mrow><mo>+</mo><mrow><mn>16</mn><mo>‚Å¢</mo><msup><mi>X</mi><mn>6</mn></msup></mrow><mo>+</mo><mrow><mn>22</mn><mo>‚Å¢</mo><msup><mi>X</mi><mn>7</mn></msup></mrow><mo>+</mo><mrow><mn>20</mn><mo>‚Å¢</mo><msup><mi>X</mi><mn>8</mn></msup></mrow><mo>+</mo><mrow><mn>18</mn><mo>‚Å¢</mo><msup><mi>X</mi><mn>9</mn></msup></mrow><mo>+</mo><mrow><mn>30</mn><mo>‚Å¢</mo><msup><mi>X</mi><mn>10</mn></msup><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>m</mi><mo>‚Å¢</mo><mi>o</mi><mo>‚Å¢</mo><mi>d</mi><mo>‚Å¢</mo><mn>32</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></semantics></math></span></p> <p>Any suggestions as to how I could obtain the correct inverse of <em>f (mod q)</em> would be greatly appreciated.</p>
</div>
<hr/>
<div id="tags">
<span> polynomials </span><span> finite-fields </span><span> inverse </span><span> sagemath </span><span> polynomial-rings </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="2650663" id="answer">
<p>NTRU definitely does its arithmetic inside a ring like <span class="math-container" id="24491363" visual_id="6149980"><math alttext="\mathbb{Z}_{q}[X]/(X^{N}-1)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>‚Ñ§</mi><mi>q</mi></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></mrow></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>X</mi><mi>N</mi></msup><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>, so using the field <span class="math-container" id="24491364" visual_id="18352"><math alttext="\mathbb{F}_{q}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùîΩ</mi><mi>q</mi></msub></semantics></math></span> in place of <span class="math-container" id="24491365" visual_id="207865"><math alttext="\mathbb{Z}_{q}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>‚Ñ§</mi><mi>q</mi></msub></semantics></math></span> is not right. </p> <p>I am willing to take the error message at face value. The people behind Sage simply haven't implemented the calculation of inverses in rings like <span class="math-container" id="24491366" visual_id="6149981"><math alttext="R_{m}:=\mathbb{Z}_{2^{m}}[X]/(X^{N}-1)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>m</mi></msub><mo>:=</mo><mrow><mrow><msub><mi>‚Ñ§</mi><msup><mn>2</mn><mi>m</mi></msup></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></mrow></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>X</mi><mi>N</mi></msup><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> (IIRC in NTRU <span class="math-container" id="24491367" visual_id="625"><math alttext="q" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi></semantics></math></span> is always a power of two). </p> <p>Here's how I would do it. First a general explanation, then your example:</p> <p>Begin by calculating the inverse of <span class="math-container" id="24491368" visual_id="1"><math alttext="f" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi></semantics></math></span> in <span class="math-container" id="24491369" visual_id="35971"><math alttext="R_{1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>1</mn></msub></semantics></math></span>, i.e. the inverse modulo <span class="math-container" id="24491370" visual_id="358"><math alttext="2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn></semantics></math></span> and <span class="math-container" id="24491371" visual_id="4063812"><math alttext="X^{N}-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mi>N</mi></msup><mo>-</mo><mn>1</mn></mrow></semantics></math></span>. We need to view the coefficients of that inverse as integers rather than as elements of <span class="math-container" id="24491372" visual_id="16320"><math alttext="\mathbb{Z}_{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>‚Ñ§</mi><mn>2</mn></msub></semantics></math></span>. I don't know how to do that in Sage, but looks like the tricks you did with <code>pollist</code> is all you need to go back and forth. </p> <p>At this point we have a polynomial <span class="math-container" id="24491373" visual_id="6149982"><math alttext="g_{1}(x)\in\mathbb{Z}[x]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>‚àà</mo><mrow><mi>‚Ñ§</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></semantics></math></span> such that <span class="math-container" id="24491374" visual_id="6149983"><math alttext="f(x)g_{1}(x)=1+2r_{1}(X)+(X^{N}-1)h_{1}(X)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>f</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>‚Å¢</mo><msub><mi>g</mi><mn>1</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mn>1</mn><mo>+</mo><mrow><mn>2</mn><mo>‚Å¢</mo><msub><mi>r</mi><mn>1</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><msup><mi>X</mi><mi>N</mi></msup><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>‚Å¢</mo><msub><mi>h</mi><mn>1</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></semantics></math></span> for some polynomials <span class="math-container" id="24491375" visual_id="6149984"><math alttext="r_{1}(X),h_{1}(X)\in\mathbb{Z}[x]" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><msub><mi>r</mi><mn>1</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><msub><mi>h</mi><mn>1</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>‚àà</mo><mrow><mi>‚Ñ§</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></semantics></math></span>. For what follows it is cleaner to write this as <span class="math-container" id="24491376" visual_id="6149985"><math alttext="f(x)g_{1}(x)=1+2r_{1}(x)\in\mathbb{Z}[X]/(X^{N}-1).\qquad(*)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><msub><mi>g</mi><mn>1</mn></msub><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>=</mo><mn>1</mn><mo>+</mo><mn>2</mn><msub><mi>r</mi><mn>1</mn></msub><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>‚àà</mo><mi>‚Ñ§</mi><mrow><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><msup><mi>X</mi><mi>N</mi></msup><mo>-</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mo>.</mo><mo mathvariant="italic" separator="true">‚ÄÉ‚ÄÉ</mo><mrow><mo stretchy="false">(</mo><mo>*</mo><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span></p> <p>We next "lift" <span class="math-container" id="24491377" visual_id="8"><math alttext="g_{1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mn>1</mn></msub></semantics></math></span> to an inverse of <span class="math-container" id="24491378" visual_id="1"><math alttext="f" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi></semantics></math></span> modulo <span class="math-container" id="24491379" visual_id="1253"><math alttext="4" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>4</mn></semantics></math></span> as follows. Multiplying both sides of <span class="math-container" id="24491380" visual_id="1237"><math alttext="(*)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>*</mo><mo stretchy="false">)</mo></mrow></semantics></math></span> by <span class="math-container" id="24491381" visual_id="6149986"><math alttext="1-2r_{1}(x)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>-</mo><mrow><mn>2</mn><mo>‚Å¢</mo><msub><mi>r</mi><mn>1</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> gives <span class="math-container" id="24491382" visual_id="6149987"><math alttext="f(x)g_{1}(x)(1-2r_{1}(x))=1-4r_{1}(x)^{2}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mi>f</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>‚Å¢</mo><msub><mi>g</mi><mn>1</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>-</mo><mrow><mn>2</mn><mo>‚Å¢</mo><msub><mi>r</mi><mn>1</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mn>1</mn><mo>-</mo><mrow><mn>4</mn><mo>‚Å¢</mo><msub><mi>r</mi><mn>1</mn></msub><mo>‚Å¢</mo><msup><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span> The right hand side differs from <span class="math-container" id="24491383" visual_id="342"><math alttext="1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn></semantics></math></span> by a multiple of four, so if we set <span class="math-container" id="24491384" visual_id="6149988"><math alttext="g_{2}(x)=g_{1}(x)(1-2r_{1}(x))" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>g</mi><mn>2</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>-</mo><mrow><mn>2</mn><mo>‚Å¢</mo><msub><mi>r</mi><mn>1</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> (do the calculation in the ring <span class="math-container" id="24491385" visual_id="6149989"><math alttext="\mathbb{Z}[X]/(X^{N}-1)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>‚Ñ§</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></mrow></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>X</mi><mi>N</mi></msup><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>), then <span class="math-container" id="24491386" visual_id="6149990"><math alttext="f(x)g_{2}(x)=1+4r_{2}(x)\in\mathbb{Z}[X]/(X^{N}-1).\qquad(**)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><msub><mi>g</mi><mn>2</mn></msub><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>=</mo><mn>1</mn><mo>+</mo><mn>4</mn><msub><mi>r</mi><mn>2</mn></msub><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>‚àà</mo><mi>‚Ñ§</mi><mrow><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><msup><mi>X</mi><mi>N</mi></msup><mo>-</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mo>.</mo><mo mathvariant="italic" separator="true">‚ÄÉ‚ÄÉ</mo><mrow><mo stretchy="false">(</mo><mo>*</mo><mo>*</mo><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> In other words, <span class="math-container" id="24491387" visual_id="801934"><math alttext="g_{2}(x)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>2</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> works as an inverse of <span class="math-container" id="24491388" visual_id="1"><math alttext="f" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi></semantics></math></span> in the ring <span class="math-container" id="24491389" visual_id="47688"><math alttext="R_{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>2</mn></msub></semantics></math></span> Furthermore, because <span class="math-container" id="24491390" visual_id="6149991"><math alttext="1-2r_{1}(x)\equiv 1\pmod{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mn>1</mn><mo>-</mo><mrow><mn>2</mn><mo>‚Å¢</mo><msub><mi>r</mi><mn>1</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>‚â°</mo><mrow><mn>1</mn><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo movablelimits="false">mod</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> we get that <span class="math-container" id="24491391" visual_id="6149992"><math alttext="g_{2}\equiv g_{1}\pmod{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>2</mn></msub><mo>‚â°</mo><mrow><msub><mi>g</mi><mn>1</mn></msub><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo movablelimits="false">mod</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> (that's why we call <span class="math-container" id="24491392" visual_id="13"><math alttext="g_{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mn>2</mn></msub></semantics></math></span> a lifting of <span class="math-container" id="24491393" visual_id="8"><math alttext="g_{1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mn>1</mn></msub></semantics></math></span>.</p> <p>Next we multiply both sides of <span class="math-container" id="24491394" visual_id="63851"><math alttext="(**)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>*</mo><mo>*</mo><mo stretchy="false">)</mo></mrow></semantics></math></span> by <span class="math-container" id="24491395" visual_id="6149993"><math alttext="1-4r_{2}(X)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>-</mo><mrow><mn>4</mn><mo>‚Å¢</mo><msub><mi>r</mi><mn>2</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>. Repeating the dose, I declare <span class="math-container" id="24491396" visual_id="6149994"><math alttext="g_{3}(x)=g_{2}(x)(1-4r_{2}(x))" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>g</mi><mn>3</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>g</mi><mn>2</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>-</mo><mrow><mn>4</mn><mo>‚Å¢</mo><msub><mi>r</mi><mn>2</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> and as  <span class="math-container" id="24491397" visual_id="6149995"><math alttext="(1-4r_{2}(x))(1+4r_{2}(x))=1-16r_{2}(x)^{2}\equiv 1\pmod{16}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>-</mo><mrow><mn>4</mn><mo>‚Å¢</mo><msub><mi>r</mi><mn>2</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>+</mo><mrow><mn>4</mn><mo>‚Å¢</mo><msub><mi>r</mi><mn>2</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mn>1</mn><mo>-</mo><mrow><mn>16</mn><mo>‚Å¢</mo><msub><mi>r</mi><mn>2</mn></msub><mo>‚Å¢</mo><msup><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>‚â°</mo><mrow><mn>1</mn><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo movablelimits="false">mod</mo><mn>16</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> we see that <span class="math-container" id="24491398" visual_id="1867913"><math alttext="g_{3}(x)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>3</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> is an inverse of <span class="math-container" id="24491399" visual_id="1"><math alttext="f" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi></semantics></math></span> modulo sixteen or, more precisely, in the ring <span class="math-container" id="24491400" visual_id="47689"><math alttext="R_{4}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>4</mn></msub></semantics></math></span>. Also <span class="math-container" id="24491401" visual_id="6149996"><math alttext="g_{3}\equiv g_{2}\pmod{4}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>3</mn></msub><mo>‚â°</mo><mrow><msub><mi>g</mi><mn>2</mn></msub><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo movablelimits="false">mod</mo><mn>4</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>, so we are still lifting.</p> <p>Next you get a polynomial <span class="math-container" id="24491402" visual_id="147912"><math alttext="g_{4}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mn>4</mn></msub></semantics></math></span> that is congruent to <span class="math-container" id="24491403" visual_id="147911"><math alttext="g_{3}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mn>3</mn></msub></semantics></math></span> modulo <span class="math-container" id="24491404" visual_id="2875"><math alttext="16" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>16</mn></semantics></math></span>, and an inverse of <span class="math-container" id="24491405" visual_id="1"><math alttext="f" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi></semantics></math></span> modulo <span class="math-container" id="24491406" visual_id="409548"><math alttext="16^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>16</mn><mn>2</mn></msup></semantics></math></span>. In your example case <span class="math-container" id="24491407" visual_id="625"><math alttext="q" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi></semantics></math></span> was <span class="math-container" id="24491408" visual_id="3985"><math alttext="32" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>32</mn></semantics></math></span> so you can stop here and reduce the coefficients of <span class="math-container" id="24491409" visual_id="147912"><math alttext="g_{4}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mn>4</mn></msub></semantics></math></span> modulo <span class="math-container" id="24491410" visual_id="3985"><math alttext="32" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>32</mn></semantics></math></span>. If <span class="math-container" id="24491411" visual_id="625"><math alttext="q" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi></semantics></math></span> is a higher power of two you rinse and repeat as the necessity arises.</p> <hr/> <p>In a lifting process we first figure out the least significant bits of all the coefficients of the inverse (i.e. modulo <span class="math-container" id="24491412" visual_id="358"><math alttext="2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn></semantics></math></span>), then in the subsequent rounds of iteration we figure out the next (or a few next) bits, but the process must not disturb the already "frozen" less significant bits. This is a common technique in all <span class="math-container" id="24491413" visual_id="74"><math alttext="p" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi></semantics></math></span>-adic algebra. We work modulo an increasing sequence of powers of a fixed prime <span class="math-container" id="24491414" visual_id="74"><math alttext="p" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi></semantics></math></span>. The technique is actually related to several approximation techniques from the real side. That's because in the <span class="math-container" id="24491415" visual_id="74"><math alttext="p" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi></semantics></math></span>-adic world the least significant (=units) bit is actually the boss term, and the rest of them are more or less just supporting cast of decreasing importance as the exponent goes up.</p> <hr/> <p>I show the above steps for your example (aided by Mathematica in those steps that you can hopefully do using Sage instead). </p> <p>So <span class="math-container" id="24491416" visual_id="1067907"><math alttext="N=11" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>11</mn></mrow></semantics></math></span>, <span class="math-container" id="24491417" visual_id="919432"><math alttext="q=32" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mn>32</mn></mrow></semantics></math></span> and <span class="math-container" id="24491418" visual_id="6149997"><math alttext="f=-x^{10}+x^{9}+x^{6}-x^{4}+x^{2}+x-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>=</mo><mrow><mrow><mrow><mrow><mrow><mo>-</mo><msup><mi>x</mi><mn>10</mn></msup></mrow><mo>+</mo><msup><mi>x</mi><mn>9</mn></msup><mo>+</mo><msup><mi>x</mi><mn>6</mn></msup></mrow><mo>-</mo><msup><mi>x</mi><mn>4</mn></msup></mrow><mo>+</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>x</mi></mrow><mo>-</mo><mn>1</mn></mrow></mrow></semantics></math></span>. First we calculate the inverse modulo <span class="math-container" id="24491419" visual_id="358"><math alttext="2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn></semantics></math></span>. I used Mathematica's command <code>PolynomialExtendedGCD</code> and got the same result you did, namely <span class="math-container" id="24491420" visual_id="6149998"><math alttext="g_{1}=1+x+x^{5}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>=</mo><mrow><mn>1</mn><mo>+</mo><mi>x</mi><mo>+</mo><msup><mi>x</mi><mn>5</mn></msup></mrow></mrow><mo>.</mo></mrow></semantics></math></span> Then I calculate the product (pretending that the coefficients are usual integers) <span class="math-container" id="24491421" visual_id="6149999"><math alttext="fg_{1}=-1+2x^{2}+x^{3}-x^{4}-2x^{5}+2x^{6}+2x^{7}+x^{14}-x^{15}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mi>f</mi><mo>‚Å¢</mo><msub><mi>g</mi><mn>1</mn></msub></mrow><mo>=</mo><mrow><mrow><mrow><mrow><mrow><mo>-</mo><mn>1</mn></mrow><mo>+</mo><mrow><mn>2</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><mo>+</mo><msup><mi>x</mi><mn>3</mn></msup></mrow><mo>-</mo><msup><mi>x</mi><mn>4</mn></msup><mo>-</mo><mrow><mn>2</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>5</mn></msup></mrow></mrow><mo>+</mo><mrow><mn>2</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>6</mn></msup></mrow><mo>+</mo><mrow><mn>2</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>7</mn></msup></mrow><mo>+</mo><msup><mi>x</mi><mn>14</mn></msup></mrow><mo>-</mo><msup><mi>x</mi><mn>15</mn></msup></mrow></mrow><mo>.</mo></mrow></semantics></math></span> We need to reduce that modulo <span class="math-container" id="24491422" visual_id="298007"><math alttext="x^{11}-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>11</mn></msup><mo>-</mo><mn>1</mn></mrow></semantics></math></span>. Doing that gives <span class="math-container" id="24491423" visual_id="6150000"><math alttext="\displaystyle fg_{1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>‚Å¢</mo><msub><mi>g</mi><mn>1</mn></msub></mrow></semantics></math></span> so <span class="math-container" id="24491424" visual_id="6150001"><math alttext="r_{1}(x)=-1+x^{2}+x^{3}-x^{4}-x^{5}+x^{6}+x^{7}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><msub><mi>r</mi><mn>1</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mrow><mrow><mo>-</mo><mn>1</mn></mrow><mo>+</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>x</mi><mn>3</mn></msup></mrow><mo>-</mo><msup><mi>x</mi><mn>4</mn></msup><mo>-</mo><msup><mi>x</mi><mn>5</mn></msup></mrow><mo>+</mo><msup><mi>x</mi><mn>6</mn></msup><mo>+</mo><msup><mi>x</mi><mn>7</mn></msup></mrow></mrow><mo>.</mo></mrow></semantics></math></span> Therefore we can calculate <span class="math-container" id="24491425" visual_id="6150002"><math alttext="g_{2}=g_{1}(1-2r_{1})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>2</mn></msub><mo>=</mo><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>-</mo><mrow><mn>2</mn><mo>‚Å¢</mo><msub><mi>r</mi><mn>1</mn></msub></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> first as a polynomial, then reduced modulo <span class="math-container" id="24491426" visual_id="298007"><math alttext="x^{11}-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>11</mn></msup><mo>-</mo><mn>1</mn></mrow></semantics></math></span>: <span class="math-container" id="24491427" visual_id="6150003"><math alttext="\displaystyle g_{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mn>2</mn></msub></semantics></math></span> As I promised, <span class="math-container" id="24491428" visual_id="13"><math alttext="g_{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mn>2</mn></msub></semantics></math></span> differs from <span class="math-container" id="24491429" visual_id="8"><math alttext="g_{1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mn>1</mn></msub></semantics></math></span> only by a multiple of two. Next we need to calculate <span class="math-container" id="24491430" visual_id="5612145"><math alttext="fg_{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>‚Å¢</mo><msub><mi>g</mi><mn>2</mn></msub></mrow></semantics></math></span>. Again first as polynomial and then modulo <span class="math-container" id="24491431" visual_id="298007"><math alttext="x^{11}-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>11</mn></msup><mo>-</mo><mn>1</mn></mrow></semantics></math></span> (you can probably combine these steps easily): <span class="math-container" id="24491432" visual_id="6150004"><math alttext="fg_{2}\equiv 13+4x+4x^{3}-12x^{4}-16x^{5}+12x^{6}+24x^{7}-4x^{8}-24x^{9}-4x^{1% 0}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mi>f</mi><mo>‚Å¢</mo><msub><mi>g</mi><mn>2</mn></msub></mrow><mo>‚â°</mo><mrow><mrow><mrow><mrow><mn>13</mn><mo>+</mo><mrow><mn>4</mn><mo>‚Å¢</mo><mi>x</mi></mrow><mo>+</mo><mrow><mn>4</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>3</mn></msup></mrow></mrow><mo>-</mo><mrow><mn>12</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>4</mn></msup></mrow><mo>-</mo><mrow><mn>16</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>5</mn></msup></mrow></mrow><mo>+</mo><mrow><mn>12</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>6</mn></msup></mrow><mo>+</mo><mrow><mn>24</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>7</mn></msup></mrow></mrow><mo>-</mo><mrow><mn>4</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>8</mn></msup></mrow><mo>-</mo><mrow><mn>24</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>9</mn></msup></mrow><mo>-</mo><mrow><mn>4</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>10</mn></msup></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span> As promised, <span class="math-container" id="24491433" visual_id="13"><math alttext="g_{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mn>2</mn></msub></semantics></math></span> works as an inverse of <span class="math-container" id="24491434" visual_id="1"><math alttext="f" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi></semantics></math></span> modulo four because this product differs from <span class="math-container" id="24491435" visual_id="342"><math alttext="1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn></semantics></math></span> by multiples of four only. We also read that <span class="math-container" id="24491436" visual_id="6150005"><math alttext="fg_{2}=1+4r_{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>f</mi><mo>‚Å¢</mo><msub><mi>g</mi><mn>2</mn></msub></mrow><mo>=</mo><mrow><mn>1</mn><mo>+</mo><mrow><mn>4</mn><mo>‚Å¢</mo><msub><mi>r</mi><mn>2</mn></msub></mrow></mrow></mrow></semantics></math></span>, where <span class="math-container" id="24491437" visual_id="6150006"><math alttext="r_{2}=3+x+x^{3}-3x^{4}-4x^{5}+3x^{6}+6x^{7}-x^{8}-6x^{9}-x^{10}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><mrow><mrow><mrow><mrow><mn>3</mn><mo>+</mo><mi>x</mi><mo>+</mo><msup><mi>x</mi><mn>3</mn></msup></mrow><mo>-</mo><mrow><mn>3</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>4</mn></msup></mrow><mo>-</mo><mrow><mn>4</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>5</mn></msup></mrow></mrow><mo>+</mo><mrow><mn>3</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>6</mn></msup></mrow><mo>+</mo><mrow><mn>6</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>7</mn></msup></mrow></mrow><mo>-</mo><msup><mi>x</mi><mn>8</mn></msup><mo>-</mo><mrow><mn>6</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>9</mn></msup></mrow><mo>-</mo><msup><mi>x</mi><mn>10</mn></msup></mrow></mrow><mo>.</mo></mrow></semantics></math></span> Next we need to compute <span class="math-container" id="24491438" visual_id="6150007"><math alttext="g_{3}=g_{2}(1-4r_{2})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>3</mn></msub><mo>=</mo><mrow><msub><mi>g</mi><mn>2</mn></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>-</mo><mrow><mn>4</mn><mo>‚Å¢</mo><msub><mi>r</mi><mn>2</mn></msub></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span> modulo <span class="math-container" id="24491439" visual_id="298007"><math alttext="x^{11}-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>11</mn></msup><mo>-</mo><mn>1</mn></mrow></semantics></math></span>: <span class="math-container" id="24491440" visual_id="6150008"><math alttext="g_{3}\equiv-219-439x+54x^{2}+464x^{3}+132x^{4}-273x^{5}-192x^{6}-10x^{7}+36x^{% 8}+210x^{9}+222x^{10}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>g</mi><mn>3</mn></msub><mo>‚â°</mo><mrow><mrow><mrow><mrow><mrow><mo>-</mo><mn>219</mn></mrow><mo>-</mo><mrow><mn>439</mn><mo>‚Å¢</mo><mi>x</mi></mrow></mrow><mo>+</mo><mrow><mn>54</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><mo>+</mo><mrow><mn>464</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>3</mn></msup></mrow><mo>+</mo><mrow><mn>132</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>4</mn></msup></mrow></mrow><mo>-</mo><mrow><mn>273</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>5</mn></msup></mrow><mo>-</mo><mrow><mn>192</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>6</mn></msup></mrow><mo>-</mo><mrow><mn>10</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>7</mn></msup></mrow></mrow><mo>+</mo><mrow><mn>36</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>8</mn></msup></mrow><mo>+</mo><mrow><mn>210</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>9</mn></msup></mrow><mo>+</mo><mrow><mn>222</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>10</mn></msup></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span> At this point we see that modulo <span class="math-container" id="24491441" visual_id="298007"><math alttext="x^{11}-1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>11</mn></msup><mo>-</mo><mn>1</mn></mrow></semantics></math></span> we have <span class="math-container" id="24491442" visual_id="6150009"><math alttext="fg_{3}\equiv 881+624x-1264x^{2}-1440x^{3}+896x^{4}+1712x^{5}-176x^{6}-1184x^{7% }-304x^{8}+112x^{9}+128x^{10}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mi>f</mi><mo>‚Å¢</mo><msub><mi>g</mi><mn>3</mn></msub></mrow><mo>‚â°</mo><mrow><mrow><mrow><mrow><mrow><mn>881</mn><mo>+</mo><mrow><mn>624</mn><mo>‚Å¢</mo><mi>x</mi></mrow></mrow><mo>-</mo><mrow><mn>1264</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><mo>-</mo><mrow><mn>1440</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>3</mn></msup></mrow></mrow><mo>+</mo><mrow><mn>896</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>4</mn></msup></mrow><mo>+</mo><mrow><mn>1712</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>5</mn></msup></mrow></mrow><mo>-</mo><mrow><mn>176</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>6</mn></msup></mrow><mo>-</mo><mrow><mn>1184</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>7</mn></msup></mrow><mo>-</mo><mrow><mn>304</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>8</mn></msup></mrow></mrow><mo>+</mo><mrow><mn>112</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>9</mn></msup></mrow><mo>+</mo><mrow><mn>128</mn><mo>‚Å¢</mo><msup><mi>x</mi><mn>10</mn></msup></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span> As promised the product is <span class="math-container" id="24491443" visual_id="2403046"><math alttext="\equiv 1\pmod{16}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi></mi><mo>‚â°</mo><mrow><mn>1</mn><mspace width="veryverythickmathspace"></mspace><mrow><mo lspace="8.1pt" stretchy="false">(</mo><mrow><mo movablelimits="false">mod</mo><mn>16</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></semantics></math></span>, but not yet modulo <span class="math-container" id="24491444" visual_id="919432"><math alttext="q=32" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mn>32</mn></mrow></semantics></math></span>. However, the numbers are becoming progressively kludgier (my own fault because I chose to work in <span class="math-container" id="24491445" visual_id="6150010"><math alttext="\mathbb{Z}[x]/(x^{11}-1)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>‚Ñ§</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>x</mi><mn>11</mn></msup><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span> instead of modulo <span class="math-container" id="24491446" visual_id="3985"><math alttext="32" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>32</mn></semantics></math></span>). Anyway, you see that my <span class="math-container" id="24491447" visual_id="147911"><math alttext="g_{3}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mn>3</mn></msub></semantics></math></span> differs from your target answer by multiples of sixteen only, so the next round will take you there. Leaving that to you!</p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
<tr><td comment_id="5474342"> It looks like you should actually be able to do all this in <span class="math-container" id="24491448" visual_id="6150011"><math alttext="\mathbb{Z}_{q}[X]/(X^{n}-1)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi>‚Ñ§</mi><mi>q</mi></msub><mo>‚Å¢</mo><mrow><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo></mrow></mrow><mo>/</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>X</mi><mi>n</mi></msup><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>. You do need the ability to reinterpret a sequence of coeffcients from <span class="math-container" id="24491449" visual_id="1452551"><math alttext="\mathbb{Z}_{2^{k}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>‚Ñ§</mi><msup><mn>2</mn><mi>k</mi></msup></msub></semantics></math></span> as elements of <span class="math-container" id="24491450" visual_id="6150012"><math alttext="\mathbb{Z}_{2^{\ell}}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>‚Ñ§</mi><msup><mn>2</mn><mi mathvariant="normal">‚Ñì</mi></msup></msub></semantics></math></span> where <span class="math-container" id="24491451" visual_id="5809048"><math alttext="\ell&gt;k" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">‚Ñì</mi><mo>&gt;</mo><mi>k</mi></mrow></semantics></math></span>. At the level of coefficients such lifting is not unique, but we need it to calculate the error of our current "approximate inverse" <span class="math-container" id="24491452" visual_id="1679807"><math alttext="g_{1},g_{2},..." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>1</mn></msub><mo>,</mo><msub><mi>g</mi><mn>2</mn></msub><mo>,</mo><mi mathvariant="normal">‚Ä¶</mi></mrow></semantics></math></span> The point is that the sequence <span class="math-container" id="24491453" visual_id="260005"><math alttext="(g_{k})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>g</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></semantics></math></span> will stabilize modulo <span class="math-container" id="24491454" visual_id="625"><math alttext="q" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi></semantics></math></span>, and then you can stop. </td></tr><tr><td comment_id="5477183"> I hope its clear that if <span class="math-container" id="24491455" visual_id="1"><math alttext="f" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi></semantics></math></span> has no inverse modulo <span class="math-container" id="24491456" visual_id="358"><math alttext="2" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn></semantics></math></span>, then it won't have an inverse modulo a power of two either. </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
