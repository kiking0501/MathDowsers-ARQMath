<!DOCTYPE html>

<html>
<head>
<title>Find next point in ellipse given the chord length</title>
<link href="https://cdn.sstatic.net/Shared/stacks.css?v=079c5e1603be" rel="stylesheet" type="text/css"/>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG.js" type="text/javascript"> </script>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap-theme.min.css" rel="stylesheet"/>
<style>
        .row {
          display: block;
          margin-left: auto;
          margin-right: auto;
          width:50%;
        }
        tr {
          border:1px solid lightgrey;
        }
        </style>
</head>
<body>
<div>
<div class="row" id="question-title">
<h1> Find next point in ellipse given the chord length </h1>
<hr/>
</div>
<div class="row">
<div class="question">
<div id="question" question_id="395531">
<p>I would like to draw a cloud programmatically. For this reason I need to know where to draw the next circle around the ellipse.</p> <p>Given the chord (circle radius), how can I calculate the next point in the ellipse?</p> <p>Thanks!</p>
</div>
<hr/>
<div id="tags">
<span> geometry </span><span> trigonometry </span><span> conic-sections </span>
</div>
<hr/>
<div id="question-comments">
<table>
<tbody>
<tr><td comment_id="846430"> You mean that the cloud resembles an ellipse? </td></tr><tr><td comment_id="846500"> yep, thinking of basing it on an ellipse. Like [this one](http://www.clker.com/clipart-thought-cloud.html), for instance. </td></tr><tr><td comment_id="846618"> Given the ellipse formula, say <span class="math-container" id="4190704" visual_id="172673"><math alttext="x^{2}/a^{2}+y^{2}/b^{2}=1" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>/</mo><msup><mi>a</mi><mn>2</mn></msup></mrow><mo>+</mo><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>/</mo><msup><mi>b</mi><mn>2</mn></msup></mrow></mrow><mo>=</mo><mn>1</mn></mrow></semantics></math></span>, and the circle radius <span class="math-container" id="4190743" visual_id="180"><math alttext="r" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi></semantics></math></span>, and a starting point <span class="math-container" id="4190723" visual_id="15785"><math alttext="(x_{1},y_{1})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></semantics></math></span> on the ellipse, perhaps you mean that the "next point" should be on the intersection of the ellipse with the circle radius <span class="math-container" id="4190743" visual_id="180"><math alttext="r" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi></semantics></math></span> centered at <span class="math-container" id="4190723" visual_id="15785"><math alttext="(x_{1},y_{1})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></semantics></math></span>. If you solve this and get <span class="math-container" id="4190735" visual_id="38924"><math alttext="(x_{2},y_{2})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></semantics></math></span> for the next center, etc., it will likely turn out that going once around the ellipse you don't end up back at the first circle. That would make the cloud look uneven-- is that a problem? </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div class="answer">
<div answer_id="395679" id="answer">
<p>Suppose the ellipse is centered at <span class="math-container" id="4190710" visual_id="828"><math alttext="(0,0)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></semantics></math></span> with equation <span class="math-container" id="4190711" visual_id="3660104"><math alttext="x^{2}/a^{2}+y^{2}/b^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>/</mo><msup><mi>a</mi><mn>2</mn></msup></mrow><mo>+</mo><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>/</mo><msup><mi>b</mi><mn>2</mn></msup></mrow></mrow></semantics></math></span>, with major and minor axes alligned with the <span class="math-container" id="4190712" visual_id="67"><math alttext="x" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi></semantics></math></span> and <span class="math-container" id="4190713" visual_id="68"><math alttext="y" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi></semantics></math></span> axes. This ellipse can be parametrized by <span class="math-container" id="4190714" visual_id="4695464"><math alttext="(x,y)=(a\cos t,b\sin t)" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mo>=</mo><mrow><mo stretchy="false">(</mo><mrow><mi>a</mi><mo>⁢</mo><mrow><mi>cos</mi><mo>⁡</mo><mi>t</mi></mrow></mrow><mo>,</mo><mrow><mi>b</mi><mo>⁢</mo><mrow><mi>sin</mi><mo>⁡</mo><mi>t</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></semantics></math></span>, and as the parameter <span class="math-container" id="4190715" visual_id="297"><math alttext="t" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi></semantics></math></span> increases, the point moves around the ellipse in a counterclockwise direction. </p> <p>If your first center is at <span class="math-container" id="4190716" visual_id="15785"><math alttext="(x_{1},y_{1})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></semantics></math></span> then first find the <span class="math-container" id="4190717" visual_id="297"><math alttext="t" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi></semantics></math></span> value (call this <span class="math-container" id="4190718" visual_id="7053"><math alttext="t_{1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub></semantics></math></span>) by use of <span class="math-container" id="4190719" visual_id="6629371"><math alttext="\cos t_{1}=x_{1}/a,\ \sin t_{1}=y_{1}/b." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mrow><mi>cos</mi><mo>⁡</mo><msub><mi>t</mi><mn>1</mn></msub></mrow><mo>=</mo><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>/</mo><mi>a</mi></mrow></mrow><mo rspace="7.5pt">,</mo><mrow><mrow><mi>sin</mi><mo>⁡</mo><msub><mi>t</mi><mn>1</mn></msub></mrow><mo>=</mo><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>/</mo><mi>b</mi></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span> Now let <span class="math-container" id="4190720" visual_id="297"><math alttext="t" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi></semantics></math></span> be the parameter value for your "next" circle center, which is to be the first point, going around the ellipse counterclockwise, which is at distance <span class="math-container" id="4190721" visual_id="180"><math alttext="r" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi></semantics></math></span> from <span class="math-container" id="4190722" visual_id="1420892"><math alttext="(x_{1},y_{1})." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><mo>.</mo></mrow></semantics></math></span> Set up the squared distance to <span class="math-container" id="4190723" visual_id="15785"><math alttext="(x_{1},y_{1})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></semantics></math></span> as <span class="math-container" id="4190724" visual_id="6629372"><math alttext="f(t)=a^{2}(\cos t-\cos t_{1})^{2}+b^{2}(\sin t-\sin t_{1})^{2}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msup><mi>a</mi><mn>2</mn></msup><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mrow><mi>cos</mi><mo>⁡</mo><mi>t</mi></mrow><mo>-</mo><mrow><mi>cos</mi><mo>⁡</mo><msub><mi>t</mi><mn>1</mn></msub></mrow></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow><mo>+</mo><mrow><msup><mi>b</mi><mn>2</mn></msup><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mrow><mi>sin</mi><mo>⁡</mo><mi>t</mi></mrow><mo>-</mo><mrow><mi>sin</mi><mo>⁡</mo><msub><mi>t</mi><mn>1</mn></msub></mrow></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow><mo>.</mo></mrow></semantics></math></span> This starts out as <span class="math-container" id="4190725" visual_id="92"><math alttext="0" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn></semantics></math></span> when <span class="math-container" id="4190726" visual_id="23466"><math alttext="t=t_{1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mn>1</mn></msub></mrow></semantics></math></span>, and you can (since it's a program) now increment <span class="math-container" id="4190727" visual_id="297"><math alttext="t" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi></semantics></math></span> and get the least <span class="math-container" id="4190728" visual_id="297"><math alttext="t" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi></semantics></math></span> beyond <span class="math-container" id="4190729" visual_id="7053"><math alttext="t_{1}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub></semantics></math></span> for which <span class="math-container" id="4190730" visual_id="6629373"><math alttext="f(t)=r^{2}." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><msup><mi>r</mi><mn>2</mn></msup></mrow><mo>.</mo></mrow></semantics></math></span> [This will likely involve some sort of bisection approach, once you find a value of <span class="math-container" id="4190731" visual_id="297"><math alttext="t" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi></semantics></math></span> for which <span class="math-container" id="4190732" visual_id="6629374"><math alttext="f(t)&amp;gt;r^{2}" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><mo>&gt;</mo></mrow><msup><mi>r</mi><mn>2</mn></msup></mrow></semantics></math></span>, then back up, etc. (I tried getting an exact expression for this first <span class="math-container" id="4190733" visual_id="297"><math alttext="t" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi></semantics></math></span> value but it was a bit involved, maybe not possible in closed form...)</p> <p>Anyway after the value of <span class="math-container" id="4190734" visual_id="297"><math alttext="t" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi></semantics></math></span> is found as above your "next center" say <span class="math-container" id="4190735" visual_id="38924"><math alttext="(x_{2},y_{2})" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></semantics></math></span> becomes <span class="math-container" id="4190736" visual_id="6629375"><math alttext="(a\cos t,b\sin t)." class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>a</mi><mo>⁢</mo><mrow><mi>cos</mi><mo>⁡</mo><mi>t</mi></mrow></mrow><mo>,</mo><mrow><mi>b</mi><mo>⁢</mo><mrow><mi>sin</mi><mo>⁡</mo><mi>t</mi></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>.</mo></mrow></semantics></math></span></p>
</div>
<hr/>
<div id="answer-comments">
<table>
<tbody>
<tr><td comment_id="846830"> Thanks @coffeemath! My understanding is that I should first find the angle from the center of the ellipse to the point of the chord (_t_), then simply using the ellipse formula to get the location (which is pretty easy). Still not sure how to implement this formula to get the next _t_ though. t1 = ? </td></tr><tr><td comment_id="846920"> Note that the parameter <span class="math-container" id="4190738" visual_id="297"><math alttext="t" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi></semantics></math></span> in the above is not the angle from the center of the ellipse. If you use equally spaced parameter <span class="math-container" id="4190738" visual_id="297"><math alttext="t" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi></semantics></math></span> values, the resulting centers for the circles will not be equally spaced at any fixed distance <span class="math-container" id="4190743" visual_id="180"><math alttext="r" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi></semantics></math></span>. Even if one re-writes the ellipse in polar coordinates, so that say <span class="math-container" id="4190742" visual_id="206"><math alttext="\theta" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi></semantics></math></span> actually is the angle at the center formed by the <span class="math-container" id="4190741" visual_id="67"><math alttext="x" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi></semantics></math></span> axis and a given ellipse point, then evan if equally spaced <span class="math-container" id="4190742" visual_id="206"><math alttext="\theta" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi></semantics></math></span> are chosen, one still doesn't get equally spaced points on the ellipse for the centers of the circles. </td></tr><tr><td comment_id="847287"> Sorry if I am being thick, so you are saying I can't do what I want? Wouldn't I just need a formula to get the intersection of 2 ellipses, one being a circle centered on the perimeter of the big ellipse? </td></tr><tr><td comment_id="847306"> Found the code for interception of 2 ellipses [here](http://www.kevlindev.com/gui/math/intersection/Intersection.js), will give it a go tomorrow. The demo should be [this one](http://www.kevlindev.com/geometry/2D/intersections/intersect_ellipse_ellipse.svg) </td></tr><tr><td comment_id="847348"> You're not being "thick", that idea of solving the two equations for the intersection of the circle centered at a point of the ellipse of radius <span class="math-container" id="4190743" visual_id="180"><math alttext="r" class="ltx_Math" display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi></semantics></math></span> with the given ellipse is exactly what I was doing with a numerical approach. Actually I miswrote that the exact answer might be unfindable, it's only two second degree equations after all. </td></tr>
</tbody>
</table>
</div>
</div>
<hr style="border-top: 3px double #8c8b8b"/>
</div>
<div class="row">
<div id="duplicate">
<table>
<tbody>
</tbody>
</table>
</div>
<hr/>
<div id="related">
<table>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
</body>
</html>
